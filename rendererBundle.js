!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("renderer",[],t):"object"==typeof exports?exports.renderer=t():e.renderer=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var i in o)e.o(o,i)&&!e.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:o[i]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Axes2D:()=>N,Axes3D:()=>B,BarycentricTriangle:()=>I,Box:()=>F,Camera:()=>o,Circle:()=>k,CircleSector:()=>_,Color:()=>A,Cone:()=>T,ConeFrustum:()=>q,ConeSector:()=>R,Cube:()=>G,Cube2:()=>H,Cube3:()=>W,Cube4:()=>D,Cylinder:()=>O,CylinderSector:()=>$,DEFAULT_COLOR1:()=>mt,DEFAULT_COLOR2:()=>Re,Disk:()=>j,DiskSector:()=>Y,Dodecahedron:()=>X,DrawSceneGraph:()=>E,FrameBuffer:()=>S,GAMMA:()=>St,GRS:()=>Ve,Icosahedron:()=>Z,Icosidodecahedron:()=>U,LineClip:()=>Me,LineSegment:()=>g,Matrix:()=>i,Model:()=>r,NearClipModel:()=>ht,NearClipNestedModel:()=>ct,NearClipPosition:()=>ut,NearLine:()=>st,NearPoint:()=>lt,OBJ:()=>ye,Octahedron:()=>K,OrthoNorm:()=>n,PanelXY:()=>te,PanelXZ:()=>oe,PanelYZ:()=>ie,ParametricCurve:()=>re,ParametricSurface:()=>ne,PerspNorm:()=>s,Point:()=>c,PointClip:()=>Pe,Position:()=>l,Primitive:()=>u,Pyramid:()=>le,PyramidFrustum:()=>ae,RastLine:()=>Mt,RastPoint:()=>Pt,Ring:()=>he,RingSector:()=>de,Scene:()=>a,SierpinskiSponge:()=>Q,SierpinskiTriangle:()=>ee,Sphere:()=>ge,SphereSector:()=>ce,SphereSubdivided:()=>ue,Square:()=>fe,SquareGrid:()=>me,SurfaceOfRevolution:()=>se,Tetrahedron:()=>J,Torus:()=>xe,TorusSector:()=>we,TriangularPrism:()=>be,TriangularPyramid:()=>ve,Vector:()=>d,Vertex:()=>h,ViewFrustumModel:()=>pe,Viewport:()=>z,check:()=>f,checkPrimitives:()=>m,clipDebug:()=>Ce,clipModel:()=>Le,clipNestedModel:()=>Se,clipPosition:()=>Ee,debugPosition:()=>We,debugScene:()=>He,doAntiAliasing:()=>Lt,doGamma:()=>Et,doNearClipping:()=>at,format:()=>M,logColorList:()=>Oe,logMessage:()=>De,logPixel:()=>Ze,logPixelMessage:()=>Xe,logPixelsXAA:()=>Ke,logPixelsYAA:()=>Ue,logPrimitive:()=>je,logPrimitiveList:()=>Ye,logVertexList:()=>$e,make:()=>y,model2viewModel:()=>Ae,model2viewPosition:()=>Ne,model2worldModel:()=>et,model2worldNestedModel:()=>ot,model2worldPosition:()=>tt,nearDebug:()=>dt,projectModel:()=>pt,projectNestedModel:()=>yt,projectPosition:()=>Vt,randomColor:()=>V,rastDebug:()=>Ct,rasterizeModel:()=>zt,rasterizeNestedModel:()=>Nt,rasterizePosition:()=>At,render1:()=>xt,render2:()=>Ge,renderFB1:()=>wt,renderFB2:()=>Te,scene1:()=>Be,scene2:()=>Ie,scene3:()=>Fe,scene4:()=>_e,scene5:()=>ke,scene6:()=>qe,setClipDebug:()=>ze,setColor:()=>w,setDebugPosition:()=>Qe,setDebugScene:()=>Je,setDoAntiAliasing:()=>It,setDoGamma:()=>Ft,setDoNearClipping:()=>gt,setNearDebug:()=>ft,setRainbowPrimitiveColors:()=>p,setRandomColor:()=>x,setRandomPrimitiveColor:()=>v,setRandomVertexColor:()=>b,setRastDebug:()=>Bt,view2cameraModel:()=>_t,view2cameraNestedModel:()=>qt,view2cameraPosition:()=>kt,world2viewModel:()=>it,world2viewNestedModel:()=>nt,world2viewPosition:()=>rt});class o{left;right;bottom;top;n;perspective;#e;constructor(e=-1,t=-e,o=-1,r=-o,n=-1,s=!0,l=i.identity()){if("boolean"!=typeof s)throw new Error("Perspective must be a boolean");s?this.projPerspective(e,t,o,r,n,l):this.projOrtho(e,t,o,r,n,l)}projPerspective(e=-1,t=-1*e,o=-1,r=-1*o,n=-1,s=i.identity()){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r||"number"!=typeof n)throw new Error("All parameters must be numerical");if(s instanceof i==0)throw new Error("View Matrix must be a Matrix");this.left=e,this.right=t,this.bottom=o,this.top=r,this.n=n,this.#e=s,this.perspective=!0}projPerspectiveFOVY(e=90,t=1,o=1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("FOVY, aspect, and near must be numerical");this.top=o*Math.tan(Math.PI/180*e/2),this.bottom=-1*this.top,this.right=this.top*t,this.left=-1*this.right,this.n=-1*o,this.#e=i.identity(),this.perspective=!0}projPerspectiveFocalLength(e=-1,t=-e,o=-1,r=-o,n=1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r||"number"!=typeof n)throw new Error("All parameters must be numerical");this.perspective=!0,this.left=e/n,this.right=t/n,this.bottom=o/n,this.top=r/n,this.n=-.1,this.#e=i.identity()}projOrtho(e=-1,t=1,o=-1,r=1,n=-1,s=i.identity()){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r||"number"!=typeof n)throw new Error("All parameters must be numerical");if(s instanceof i==0)throw new Error("View Matrix must be a Matrix");this.left=e,this.right=t,this.bottom=o,this.top=r,this.n=-1*n,this.#e=s,this.perspective=!1}projOrthoFOVY(e=90,t=1,o=-1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("All parameters must be numerical");this.top=Math.tan(Math.PI/180*e/2),this.bottom=-1*this.top,this.right=this.top*t,this.left=-1*this.right,this.n=1,this.#e=i.identity(),this.perspective=!1}changeNear(e){return new o(this.left,this.right,this.bottom,this.top,-e,this.perspective,this.#e)}translate(e,t,r){return new o(this.left,this.right,this.bottom,this.top,this.n,this.perspective,i.translate(-e,-t,-r))}getViewVector(){return new d(this.#e.v4.x,this.#e.v4.y,this.#e.v4.z)}getViewMatrix(){return this.#e}viewLookAt(e,t,o,r,n,s,l,a,h){const u=new d(r-e,n-t,s-o),c=new d(l,a,h),g=u.normalize(),f=c.normalize(),m=g.crossProduct(f),w=m.crossProduct(g),x=i.buildFromColumns(new d(m.x,w.x,-g.x,0),new d(m.y,w.y,-g.y,0),new d(m.z,w.z,-g.z,0),new d(0,0,0,1));this.#e=x.timesMatrix(i.translate(-e,-t,-o))}view2Identity(){this.#e=i.identity()}viewTranslate(e,t,o){this.#e=i.translate(-e,-t,-o).timesMatrix(this.#e)}viewRotate(e,t,o,r){this.#e=i.rotate(-e,t,o,r).timesMatrix(this.#e)}viewRotateX(e){this.#e=i.rotate(-e,1,0,0).timesMatrix(this.#e)}viewRotateY(e){this.#e=i.rotate(-e,0,1,0).timesMatrix(this.#e)}viewRotateZ(e){this.#e=i.rotate(-e,0,0,1).timesMatrix(this.#e)}getNormalizeMatrix(){return this.perspective?s(this.left,this.right,this.bottom,this.top):n(this.left,this.right,this.bottom,this.top)}toString(){const e=180/Math.PI*Math.atan(this.top)+180/Math.PI*Math.atan(-this.bottom),t=(this.right-this.left)/(this.top-this.bottom);let o="";return o+="Camera: \n",o+="  perspective = "+this.perspective+"\n",o+="  left = "+this.left+",   right = "+this.right+"\n  bottom = "+this.bottom+",   top = "+this.top+"\n  near = "+this.n+"\n  (fovy = "+e+M(", aspect ratio = %2.2f)",t)+"Normalization Matrix\n"+this.getNormalizeMatrix().toString()+"\nView Matrix\n  "+this.#e.toString(),o}static main(){console.log("Creating cam1 = new Camera()");const e=new o;console.log("cam1: "),console.log(e.toString()),console.log(""),console.log("cam1.projOrtho(-2, 2, -2, 2, 2): "),e.projOrtho(-2,2,-2,2,2),console.log(e.toString()),console.log(""),console.log("cam1.projPerspFOVY(): "),e.projPerspectiveFOVY(),console.log(e.toString()),console.log(""),console.log("Creating cam2 = new Camera(-4, 4, -4, 4, false)");const t=new o(-4,4,-4,4,4,!1);console.log("cam2: "),console.log(t.toString()),console.log(""),console.log("cam2.projPerspective(-3, 3, -3, 3, 3): "),t.projPerspective(-3,3,-3,3,3),console.log(t.toString()),console.log(""),console.log("cam2.projOrthoFOVY(): "),t.projOrthoFOVY(),console.log(t.toString())}}class i{v1;v2;v3;v4;static#t=!1;constructor(e,t,o,r){if(0==i.#t)throw new Error("NON INSTANTIABLE Class");if(e instanceof d==0||t instanceof d==0||o instanceof d==0||r instanceof d==0)throw new Error("All parameters must be Vectors");this.v1=e,this.v2=t,this.v3=o,this.v4=r,i.#t=!1}static buildFromColumns(e,t,o,r){return i.#t=!0,new i(e,t,o,r)}static buildFromRows(e,t,o,r){if(e instanceof d==0||t instanceof d==0||o instanceof d==0||r instanceof d==0)throw new Error("All parameters must be Vectors");const n=new d(e.x,t.x,o.x,r.x),s=new d(e.y,t.y,o.y,r.y),l=new d(e.z,t.z,o.z,r.z),a=new d(e.w,t.w,o.w,r.w);return i.#t=!0,new i(n,s,l,a)}static identity(){return i.scaleXYZ(1,1,1)}static translate(e,t,o){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("All parameters must be numerical");return i.#t=!0,new i(new d(1,0,0,0),new d(0,1,0,0),new d(0,0,1,0),new d(e,t,o,1))}static scale(e){if("number"!=typeof e)throw new Error("D must be numerical");return i.scaleXYZ(e,e,e)}static scaleXYZ(e,t,o){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("All parameters must be numercial");return i.#t=!0,new i(new d(e,0,0,0),new d(0,t,0,0),new d(0,0,o,0),new d(0,0,0,1))}static rotateX(e){if("number"!=typeof e)throw new Error("Theta must be numerical");return i.#t=!0,i.rotate(e,1,0,0)}static rotateY(e){if("number"!=typeof e)throw new Error("Theta must be numerical");return i.#t=!0,i.rotate(e,0,1,0)}static rotateZ(e){if("number"!=typeof e)throw new Error("Theta must be numerical");return i.#t=!0,i.rotate(e,0,0,1)}static rotate(e,t,o,r){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new Error("All parameters need to be numerical");const n=Math.sqrt(t*t+o*o+r*r),s=t/n,l=o/n,a=r/n,h=Math.cos(Math.PI/180*e),u=Math.sin(Math.PI/180*e);return i.#t=!0,new i(new d(s*s*(1-h)+h,l*s*(1-h)+a*u,a*s*(1-h)-l*u,0),new d(s*l*(1-h)-a*u,l*l*(1-h)+h,a*l*(1-h)+s*u,0),new d(s*a*(1-h)+l*u,l*a*(1-h)-s*u,a*a*(1-h)+h,0),new d(0,0,0,1))}timesScalar(e){if("number"!=typeof e)throw new Error("S must be numerical");return i.#t=!0,new i(this.v1.timesScalar(e),this.v2.timesScalar(e),this.v3.timesScalar(e),this.v4.timesScalar(e))}timesVertex(e){if(e instanceof h==0)throw new Error("V must be a Vertex");const t=this.v1.x*e.x+this.v2.x*e.y+this.v3.x*e.z+this.v4.x*e.w,o=this.v1.y*e.x+this.v2.y*e.y+this.v3.y*e.z+this.v4.y*e.w,i=this.v1.z*e.x+this.v2.z*e.y+this.v3.z*e.z+this.v4.z*e.w,r=this.v1.w*e.x+this.v2.w*e.y+this.v3.w*e.z+this.v4.w*e.w;return new h(t,o,i,r)}timesVector(e){if(e instanceof d==0)throw new Error("V is not a Vector");const t=this.v1.x*e.x+this.v2.x*e.y+this.v3.x*e.z+this.v4.x*e.w,o=this.v1.y*e.x+this.v2.y*e.y+this.v3.y*e.z+this.v4.y*e.w,i=this.v1.z*e.x+this.v2.z*e.y+this.v3.z*e.z+this.v4.z*e.w,r=this.v1.w*e.x+this.v2.w*e.y+this.v3.w*e.z+this.v4.w*e.w;return new d(t,o,i,r)}timesMatrix(e){if(e instanceof i==0)throw new Error("M is not a Matrix");return i.#t=!0,new i(this.timesVector(e.v1),this.timesVector(e.v2),this.timesVector(e.v3),this.timesVector(e.v4))}timesEqualsScalar(e){if("number"!=typeof e)throw new Error("S is not numerical");return this.v1.timesEqualsScalar(e),this.v2.timesEqualsScalar(e),this.v3.timesEqualsScalar(e),this.v4.timesEqualsScalar(e),this}mult(e){if(e instanceof i==0)throw new Error("M is not a Matrix");let t=0,o=0,r=0,n=0;t=e.v1.x,o=e.v1.y,r=e.v1.z,n=e.v1.w;const s=this.v1.x*t+this.v2.x*o+this.v3.x*r+this.v4.x*n,l=this.v1.y*t+this.v2.y*o+this.v3.y*r+this.v4.y*n,a=this.v1.z*t+this.v2.z*o+this.v3.z*r+this.v4.z*n,d=this.v1.w*t+this.v2.w*o+this.v3.w*r+this.v4.w*n;t=e.v2.x,o=e.v2.y,r=e.v2.z,n=e.v2.w;const h=this.v1.x*t+this.v2.x*o+this.v3.x*r+this.v4.x*n,u=this.v1.y*t+this.v2.y*o+this.v3.y*r+this.v4.y*n,c=this.v1.z*t+this.v2.z*o+this.v3.z*r+this.v4.z*n,g=this.v1.w*t+this.v2.w*o+this.v3.w*r+this.v4.w*n;t=e.v3.x,o=e.v3.y,r=e.v3.z,n=e.v3.w;const f=this.v1.x*t+this.v2.x*o+this.v3.x*r+this.v4.x*n,m=this.v1.y*t+this.v2.y*o+this.v3.y*r+this.v4.y*n,w=this.v1.z*t+this.v2.z*o+this.v3.z*r+this.v4.z*n,x=this.v1.w*t+this.v2.w*o+this.v3.w*r+this.v4.w*n;t=e.v4.x,o=e.v4.y,r=e.v4.z,n=e.v4.w;const b=this.v1.x*t+this.v2.x*o+this.v3.x*r+this.v4.x*n,v=this.v1.y*t+this.v2.y*o+this.v3.y*r+this.v4.y*n,p=this.v1.z*t+this.v2.z*o+this.v3.z*r+this.v4.z*n,V=this.v1.w*t+this.v2.w*o+this.v3.w*r+this.v4.w*n;return this.v1.x=s,this.v1.y=l,this.v1.z=a,this.v1.w=d,this.v2.x=h,this.v2.y=u,this.v2.z=c,this.v2.w=g,this.v3.x=f,this.v3.y=m,this.v3.z=w,this.v3.w=x,this.v4.x=b,this.v4.y=v,this.v4.z=p,this.v4.w=V,this}multLeft(e){if(e instanceof i==0)throw new Error("M is not a  Matrix");return this.v1.timesEqualsMatrix(e),this.v2.timesEqualsMatrix(e),this.v3.timesEqualsMatrix(e),this.v4.timesEqualsMatrix(e),this}rot2euler(){const e=this.v1.x,t=this.v2.x,o=this.v3.x,i=this.v1.y,r=this.v1.z,n=this.v2.z,s=this.v3.z;let l,a,d;return 1!=r&&-1!=r?(a=-Math.asin(r),l=Math.atan2(n/Math.cos(a),s/Math.cos(a)),d=Math.atan2(i/Math.cos(a),e/Math.cos(a))):(-1==r?(a=Math.PI/2,l=Math.atan2(t,o)):(a=-Math.PI/2,l=Math.atan2(-t,-o)),d=0),[l,a,d]}eulerize(){const e=this.rot2euler();return i.rotateZ(e[2]*(180/Math.PI)).timesMatrix(i.rotateY(e[1]*(180/Math.PI)).timesMatrix(i.rotateX(e[0]*(180/Math.PI))))}toString(){let e="";return e+=M("[[%3.5f  %3.5f  %3.5f  %3.5f ]\n",this.v1.x,this.v2.x,this.v3.x,this.v4.x),e+=M(" [%3.5f  %3.5f  %3.5f  %3.5f ]\n",this.v1.y,this.v2.y,this.v3.y,this.v4.y),e+=M(" [%3.5f  %3.5f  %3.5f  %3.5f ]\n",this.v1.z,this.v2.z,this.v3.z,this.v4.z),e+=M(" [%3.5f  %3.5f  %3.5f  %3.5f ]]",this.v1.w,this.v2.w,this.v3.w,this.v4.w),e}static main(){console.log("Creating vector v1 = new Vector(1, 2, 3)"),console.log("Creating vector v2 = new Vector(4, 5, 6)"),console.log("Creating vector v3 = new Vector(7, 8, 9)"),console.log("Creating vector v4 = new Vector(10, 11, 12)");const e=new d(1,2,3),t=new d(4,5,6),o=new d(7,8,9),r=new d(10,11,12);console.log(""),console.log("Creating m1 = buildColumns(v1, v2, v3, v4) : ");const n=i.buildFromColumns(e,t,o,r);console.log(n.toString()),console.log(""),console.log("Creating m2 = buildRows(v1, v2, v3, v4): ");const s=i.buildFromRows(e,t,o,r);console.log(s.toString()),console.log(""),console.log("Creating id = identity(): ");const l=i.identity();console.log(l.toString()),console.log(""),console.log("Creating trans = translate(1, 1, 1): ");const a=i.translate(1,1,1);console.log(a.toString()),console.log(""),console.log("Creating sc = scale(2): ");const u=i.scale(2);console.log(u.toString()),console.log(""),console.log("Creating scXYZ = scale(3, 3, 3): ");const c=i.scaleXYZ(3,3,3);console.log(c.toString()),console.log(""),console.log("Creating rotX = rotateX(90): ");const g=i.rotateZ(90);console.log(g.toString()),console.log(""),console.log("Creating rotY = rotateY(90): ");const f=i.rotateY(90);console.log(f.toString()),console.log(""),console.log("Creating rotZ = rotateZ(90): ");const m=i.rotateZ(90);console.log(m.toString()),console.log(""),console.log("Creating rot = rotate(90, 1, 1, 1): ");const w=i.rotate(90,1,1,1);console.log(w.toString()),console.log(""),console.log("Creating timesSC = m1.timesScalar(5): ");const x=n.timesScalar(5);console.log(x.toString()),console.log(""),console.log("Creating timesVert = m1.timesVertex(new Vertex(10, 10, 10)): ");const b=n.timesVertex(new h(10,10,10));console.log(b.toString()),console.log(""),console.log("Creating timesVect = m1.timesVect(v1): ");const v=n.timesVector(e);console.log(v.toString()),console.log(""),console.log("Outputing m1 and m2 to allow for checking of subsequent functions"),console.log(n.toString()),console.log(s.toString()),console.log(""),console.log("Creating timesMat = m1.timesMatrix(m2): ");const p=n.timesMatrix(s);console.log(p.toString()),console.log(""),console.log("m1.timesEqualsScalar(5): "),n.timesEqualsScalar(5),console.log(n.toString()),console.log(""),console.log("m1.mult(m2): "),n.mult(s),console.log(n.toString()),console.log(""),console.log("m2.multLeft(m1): "),s.multLeft(n),console.log(s.toString())}}class r{#o;#i;#r;#n;visible;#s;#l;constructor(e=new Array,t=new Array,o=new Array,n=i.identity(),s=new Array,l="",a=!0){if(0==Array.isArray(e))throw new Error("Vertex list must be array");if(0==Array.isArray(t))throw new Error("Primitive list must be array");if(0==Array.isArray(o))throw new Error("Color List must be array");if(0==Array.isArray(s))throw new Error("Nested Models must be an array");if(n instanceof i==0)throw new Error("Matrix must be a Matrix");if("string"!=typeof l)throw new Error("Name must be a string");if("boolean"!=typeof a)throw new Error("Visible is not a boolean");let d=0;this.#o=new Array;for(let t=0;t<e.length;t+=1){if(e[t]instanceof h==0)throw this.#o.length=d,new Error("Vertex List must contain Vertexes");this.#o.push(e[t]),d+=1}let c=0;this.#i=new Array;for(let e=0;e<t.length;e+=1){if(t[e]instanceof u==0)throw this.#i.length=c,new Error("Primitive List mut contain Primitives");this.#i.push(t[e]),c+=1}let g=0;this.#r=new Array;for(let e=0;e<o.length;e+=1){if(o[e]instanceof A==0)throw this.#r.length=g,new Error("Color List must only contain Colors");this.#r.push(o[e]),g+=1}let f=0;this.#l=new Array;for(let e=0;e<s.length;e+=1){if(s[e]instanceof r==0)throw this.#l.length=f,new Error("Nested Models must only contain Models");this.#l.push(s[e]),f+=1}this.#n=l,this.visible=a,this.#s=n}static buildName(e=""){return new r(new Array,new Array,new Array,void 0,void 0,e)}static buildNameMatrix(e="",t=i.identity()){return new r(new Array,new Array,new Array,t,new Array,e)}static buildRend9Model(e=new Array,t=new Array,o=new Array,n="",s=!0){return new r(e,t,o,i.identity(),new Array,n,s)}getVertexList(){return this.#o}get vertexList(){return this.#o}getPrimitiveList(){return this.#i}get primitiveList(){return this.#i}getColorList(){return this.#r}get colorList(){return this.#r}getName(){return this.#n}get name(){return this.#n}setName(e=""){if("string"!=typeof e)throw new Error("Name must be a string");this.#n=e}set name(e){if("string"!=typeof e)throw new Error("Name must be a string");this.#n=e}getNestedModels(){return this.#l}get nestedModels(){return this.#l}getMatrix(){return this.#s}get matrix(){return this.#s}set matrix(e){if(e instanceof i==0)throw new Error("M must be a matrix");this.#s=e}setMatrix(e){if(e instanceof i==0)throw new Error("M must be a Matrix");this.#s=e}getVertex(e=0){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#o[e]}addVertex(...e){for(let t of e){if(t instanceof h==0)throw new Error("Can only add Vertexes");this.#o.push(t)}}getPrimitive(e=0){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#i[e]}addPrimitive(...e){for(let t of e){if(t instanceof u==0)throw new Error("Can only add primitives");this.#i.push(t)}}getColor(e=0){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#r[e]}addColor(...e){for(let t of e){if(t instanceof A==0)throw new Error("Can only add Colors");this.#r.push(t)}}getNestedModel(e=0){if("number"!=typeof e)throw new Error("index must be a number");return this.nestedModels[e]}addNestedModel(...e){for(const t of e){if(t instanceof r==0)throw new Error("Can only add models to this models nested models list");this.#l.push(t)}}setNestedModel(e,t){if("number"!=typeof e)throw new Error("Index must be a number");if(t instanceof r==0)throw new Error("Model must be a Model");this.#l[e]=t}transform(e){return new r(this.#o,this.#i,this.#r,e,this.#l,this.#n,this.visible)}toString(){let e="";e+="Model: "+this.#n+"\n",e+="This Model's visibility is: "+this.visible+"\n",e+="Model has "+this.#o.length+" vertices.\n",e+="Model has "+this.#r.length+" colors.\n",e+="Model has "+this.#i.length+" primitives.\n",e+="Model has "+this.#l.length+" nested models.\n";let t=0;for(let o of this.#o)e+=t+": "+o.toString()+"\n",++t;t=0;for(let o of this.#r)e+=t+": "+o.toString()+"\n",++t;t=0;for(let o of this.#i)e+=t+": "+o.toString()+"\n",++t;e+=this.#s.toString()+"\n";for(const t of this.#l)e+=t.toString();return e}static main(){console.log("Creating m1 = new Model(): ");const e=new r;console.log(e.toString()),console.log(""),console.log("Creating m2 = buildName('Model 2'): ");const t=r.buildName("Model 2");console.log(t.toString()),console.log(""),console.log("m1.getVertexList(): "),console.log(e.getVertexList()),console.log(""),console.log("m1.vertexList(): "),console.log(e.vertexList),console.log(""),console.log("m1.getPrimitiveList(): "),console.log(e.getPrimitiveList()),console.log(""),console.log("m1.primitiveList(): "),console.log(e.primitiveList),console.log(""),console.log("m1.getColorList(): "),console.log(e.getColorList()),console.log(""),console.log("m1.colorList(): "),console.log(e.colorList),console.log(""),console.log("m1.getName(): "),console.log(e.getName()),console.log(""),console.log("m1.name(): "),console.log(e.name),console.log(""),console.log("m1.setName('Model 1')"),e.setName("Model 1"),console.log(e.toString()),console.log(""),console.log("m1.addVertex(new Vertex(0, 0, 0): "),e.addVertex(new h(0,0,0)),console.log(e.toString()),console.log(""),console.log("m1.addVertex(new Vertex(1, 0, 0), new Vertex(-1, 0, 0), new Vertex(0, 1, 0), new Vertex(0, -1, 0)): "),e.addVertex(new h(1,0,0),new h(-1,0,0),new h(0,1,0),new h(0,-1,0)),console.log(e.toString()),console.log(""),console.log("m1.getVertex(0).toString(): "),console.log(e.getVertex(0).toString()),console.log(""),console.log("m1.getVertex(3).toString(): "),console.log(e.getVertex(3).toString()),console.log(""),console.log("m1.addColor(new Color(0, 0, 0)): "),e.addColor(new A(0,0,0)),console.log(e.toString()),console.log(""),console.log("m1.addColor(Color.blue, Color.red, Color.green, Color.yellow): "),e.addColor(A.blue,A.red,A.green,A.yellow),console.log(e.toString()),console.log(""),console.log("m1.getColor(0): "),console.log(e.getColor(0).toString()),console.log(""),console.log("m1.getColor(3): "),console.log(e.getColor(3).toString()),console.log(""),console.log("m1.addPrimitive(new Point(0, 0)"),e.addPrimitive(new c(0,0)),console.log(e.toString()),console.log(""),console.log("m1.addPrimitive(new ls(1, 3, 1, 3), new ls(1, 4, 1, 4), new ls(2, 3, 2, 3), new ls(2, 4, 2, 4)): "),e.addPrimitive(g.buildVertexColors(1,3,1,3),g.buildVertexColors(1,4,1,4),g.buildVertexColors(2,3,2,3),g.buildVertexColors(2,4,2,4)),console.log(e.toString()),console.log(""),console.log("m1.getPrimitive(0): "),console.log(e.getPrimitive(0).toString()),console.log(""),console.log("m1.getPrimitive(3): "),console.log(e.getPrimitive(3).toString())}}function n(e,t,o,r){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new Error("L, B, R, T must be numerical");let n,s;return n=i.buildFromColumns(new d(1,0,0,0),new d(0,1,0,0),new d(0,0,1,0),new d(-(t+e)/2,-(r+o)/2,0,1)),s=i.buildFromColumns(new d(2/(t-e),0,0,0),new d(0,2/(r-o),0,0),new d(0,0,1,0),new d(0,0,0,1)),s.timesMatrix(n)}function s(e,t,o,r){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new Error("L, R, B, T, and near must be numerical");let n,s;return n=i.buildFromColumns(new d(1,0,0,0),new d(0,1,0,0),new d((t+e)/2,(r+o)/2,1,0),new d(0,0,0,1)),s=i.buildFromColumns(new d(2/(t-e),0,0,0),new d(0,2/(r-o),0,0),new d(0,0,1,0),new d(0,0,0,1)),s.timesMatrix(n)}class l{#a;#s;#n;#d;visible;debug;constructor(e=new r,t=i.identity(),o="",n=new Array,s=!0,a=!1){if(e instanceof r==0)throw new Error("Model has to be a model");if(t instanceof i==0)throw new Error("Matrix has to be a Matrix");if("string"!=typeof o)throw new Error("Name has to be a string");if(!Array.isArray(n))throw new Error("Nested Positions has to be an array");if("boolean"!=typeof s||"boolean"!=typeof a)throw new Error("Visible and Debug must be booleans");let d=0;this.#d=new Array;for(let e=0;e<n.length;e+=1){if(n[e]instanceof l==0)throw this.#d.length=d,new Error("Nested Position must be a Position");this.#d.push(n[e]),d+=1}this.#a=e,this.#s=t,this.#n=o,this.visible=s,this.debug=a}static buildFromModel(e){return new l(e,i.identity(),e.getName())}static buildFromName(e){return new l(new r,i.identity(),e)}static buildFromModelName(e,t){return new l(e,i.identity(),t)}getName(){return this.#n}get name(){return this.#n}getModel(){return this.#a}get model(){return this.#a}setModel(e){if(e instanceof r==0)throw new Error("Model must be a Model");if(null==e)throw new Error("Model cannot be null or undefined");this.#a=e}set model(e){if(e instanceof r==0)throw new Error("Model must be a model");if(null==e)throw new Error("Model cannot be null or undefined");this.#a=e}getMatrix(){return this.#s}get matrix(){return this.#s}setMatrix(e){if(e instanceof i==0)throw new Error("Matrix must be a Matrix");if(null==e)throw new Error("Matrix cannot be null or undefined");return this.#s=e,this.#s}set matrix(e){if(e instanceof i==0)throw new Error("Matrix must be a matrix");if(null==e)throw new Error("Matrix cannot be undefined or null");this.#s=e}getNestedPositions(){return this.#d}get nestedPositions(){return this.#d}matrix2Identity(){return this.#s=i.identity(),this.#s}setNestedPosition(e,t){if("number"!=typeof e)throw new Error("Index must be numerical");if(t instanceof l==0)throw new Error("Position must be a Position");this.#d[e]=t}addNestedPosition(...e){let t=this.#d.length;for(let o of e){if(o instanceof l==0)throw this.#d.length=t,new Error("Can only add Positions");this.#d.push(o),t+=1}}translation(e,t,o){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("dx, dy, and dz must be numerical");this.#s=i.translate(e,t,o)}changeModel(e){return new l(e,this.#s,this.#n,this.#d,this.visible,this.debug)}transform(e){return new l(this.#a,e,this.#n,this.#d,this.visible,this.debug)}toString(){let e="";e+="Position: "+this.#n+"\n",e+="This Position's visibility is: "+this.visible+"\n",e+="This Position's Matrix is\n",e+=this.#s.toString()+"\n",e+="This Position's Model is\n",e+=null==this.#a||null==this.#a?"null\n":this.#a.toString(),e+="This Position has "+this.#d.length+" nested Positions\n";for(let t of this.#d)e+=t.toString();return e}static main(){console.log("Creating p1 = new Position."),console.log("Creating p2 = Position.buildFromModel(new Model())"),console.log("Creating p3 = Position.buildFromName('p2')"),console.log("Creating p4 = Position.buildFromModelName(new Model(), 'p4')");const e=new l,t=l.buildFromModel(new r),o=l.buildFromName("p3"),n=l.buildFromModelName(new r,"p4");console.log(""),console.log("p1: "),console.log(e.toString()),console.log(""),console.log("p2: "),console.log(t.toString()),console.log(""),console.log("p3: "),console.log(o.toString()),console.log(""),console.log("p4: "),console.log(n.toString()),console.log(""),console.log("p1.getName(): "),console.log(e.getName()),console.log(""),console.log("p1.name"),console.log(e.name),console.log(""),console.log("p2.getName(): "),console.log(t.getName()),console.log(""),console.log("p2.name"),console.log(t.name),console.log(""),console.log("p3.getName(): "),console.log(o.getName()),console.log(""),console.log("p3.name"),console.log(o.name),console.log(""),console.log("p4.getName(): "),console.log(n.getName()),console.log(""),console.log("p4.name"),console.log(n.name),console.log(""),console.log("p1.getModel(): "),console.log(e.getModel().toString()),console.log(""),console.log("p1.model"),console.log(e.model.toString()),console.log(""),console.log("p2.getModel(): "),console.log(t.getModel().toString()),console.log(""),console.log("p2.model"),console.log(t.model.toString()),console.log(""),console.log("p3.getModel(): "),console.log(o.getModel().toString()),console.log(""),console.log("p3.model"),console.log(o.model.toString()),console.log(""),console.log("p4.getModel(): "),console.log(n.getModel().toString()),console.log(""),console.log("p4.model"),console.log(n.model.toString()),console.log(""),console.log("p1.model = (new Model()): "),e.model=new r,console.log(e.toString()),console.log(""),console.log("p3.model = (new Model()): "),o.model=new r,console.log(o.toString()),console.log(""),console.log("p1.getMatrix(): "),console.log(e.getMatrix()),console.log(""),console.log("p1.matrix"),console.log(e.matrix),console.log(""),console.log("p2.getMatrix(): "),console.log(t.getMatrix()),console.log(""),console.log("p3.getMatrix(): "),console.log(o.getMatrix()),console.log(""),console.log("p4.getMatrix(): "),console.log(n.getMatrix()),console.log(""),console.log("p1.matrix = (Matrix.translate(1, 1, 1)): "),e.matrix=i.translate(1,1,1),console.log(e.toString()),console.log(""),console.log("p1.matrix2Identity(): "),e.matrix2Identity(),console.log(e.toString()),console.log(""),console.log("p1.getNestedPositions(): "),console.log(e.getNestedPositions()),console.log(""),console.log("p1.addNestedPosition(p2): "),e.addNestedPosition(t),console.log(e.toString()),console.log(""),console.log("p1.addNestedPosition(p3, p4): "),e.addNestedPosition(o,n),console.log(e.toString()),console.log(""),console.log("p1.nestedPosition: "),console.log(e.nestedPositions),console.log(""),console.log("p1.setNestedPosition(0, p4)"),e.setNestedPosition(0,n),console.log(e.toString())}}class a{#h;#u;#n;debug=!1;constructor(e=new o,t=new Array,i="",r=!1){if(e instanceof o==0)throw new Error("Camera must be a camera");if(!Array.isArray(t))throw new Error("Position List must be an array and is type: "+typeof t);if("string"!=typeof i)throw new Error("Name must be a String");if("boolean"!=typeof r)throw new Error("Debug must be a boolean");let n=0;this.#h=new Array;for(let e=0;e<t.length;e+=1){if(t[e]instanceof l==0)throw this.#h.length=n,new Error("Position List can only contain Positions");this.#h.push(t[e]),n+=1}this.#u=e,this.#n=i,this.debug=r}static buildFromName(e){return new a(new o,new Array,e)}static buildFromCamera(e){return new a(e)}static buildFromCameraName(e,t){return new a(e,new Array,t)}getName(){return this.#n}get name(){return this.#n}getCamera(){return this.#u}get camera(){return this.#u}setCamera(e){if(e instanceof o==0)throw new Error("Camera must be a Camera");this.#u=e}set camera(e){if(e instanceof o==0)throw new Error("Camera must be a Camera");this.#u=e}changeCamera(e){return new a(e,this.#h,this.#n,this.debug)}getPositionList(){return this.#h}get positionList(){return this.#h}getPosition(e){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#h[e]}setPosition(e,t){if("number"!=typeof e)throw new Error("Index must be numerical");if(t instanceof l==0)throw new Error("Position must be a Position");this.#h[e]=t}addPosition(...e){for(let t of e){if(t instanceof l==0)throw new Error("Can only add Positions");this.#h.push(t)}}getModelByName(e){if("string"!=typeof e)throw new Error("Name must be a String");for(let t of this.#h)if(e===t.getModel().getName())return t.getModel()}getPositionByModelName(e){if("string"!=typeof e)throw new Error("Name must be a String");for(let t of this.#h)if(e===t.getModel().getName())return t}getPositionByName(e){if("string"!=typeof e)throw new Error("name must be a string");for(let t of this.#h)if(e===t.name)return t}toString(){let e="";e+="Scene: "+this.#n+"\n",e+=this.#u.toString(),e+="This Scene has "+this.#h.length+" positions\n";let t=0;for(let o of this.#h)e+="Position "+t+++"\n",e+=null==o?"missing position \n":o.toString();return e+="\n",e}static main(){const e=new r;e.addColor(A.orange),e.addVertex(new h(-1,0,0),new h(1,0,0)),e.addPrimitive(g.buildVertexColor(0,1,0)),e.setName("Line Model");const t=l.buildFromModelName(e,"Pos 1"),i=new o;console.log("Creating scene1 = new Scene()");const n=new a;console.log("Creating scene2 = Scene.buildFromCamera(cam = new Camera)");const s=a.buildFromCamera(i);console.log("Creating scene3 = Scene.buildFromName('scene 3')");const d=a.buildFromName("Scene 3");console.log("Creating scene4 = Scene.buildFromCameraName(new Camera, 'Scene 4')");const u=a.buildFromCameraName(i,"Scene 4");console.log(""),console.log("Scene1: "),console.log(n.toString()),console.log(""),console.log("scene 2: "),console.log(s.toString()),console.log(""),console.log("Scene 3: "),console.log(d.toString()),console.log(""),console.log("Scene 4: "),console.log(u.toString()),console.log(""),console.log("Scene1.getName(): "),console.log(n.getName()),console.log(""),console.log("scene1.name"),console.log(n.name),console.log(""),console.log("scene2.getCamera()"),console.log(s.getCamera()),console.log(""),console.log("scene2.camera"),console.log(s.camera),console.log(""),console.log("scene3.getPositionList() "),console.log(d.getPositionList()),console.log(""),console.log("scene3.positionList"),console.log(d.positionList),console.log(""),console.log("scene1.camera = cam"),n.camera=i,console.log(n.toString()),console.log(""),console.log("scene2.setPosition(1, pos1)"),s.setPosition(1,t),console.log(s.toString()),console.log(""),console.log("scene3.addPosition(pos1)"),d.addPosition(t),console.log(d.toString()),console.log(""),console.log("scene3.getPosition(0) "),console.log(d.getPosition(0).toString()),console.log(""),console.log("scene4.addPosition(pos1, pos1, pos1)"),u.addPosition(t,t,t),console.log(u.toString()),console.log(""),console.log("scene4.getModelByName(Line Model)"),console.log(u.getModelByName("Line Model")?.toString()),console.log(""),console.log("scene4.getPositionByModelName(Pos 1)"),console.log(u.getPositionByModelName("Pos 1")?.toString()),console.log(""),console.log("scene4.getPositionByModelName(Line Model)"),console.log(u.getPositionByModelName("Line Model")?.toString())}}class d{x;y;z;w;constructor(e,t,o,i=0){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i)throw new Error("All parameters must be numerical.");this.x=e,this.y=t,this.z=o,this.w=i}static buildVertex(e){if(e instanceof h==0)throw new Error("V is not a Vertex");return new d(e.x,e.y,e.z,e.w)}dotProduct(e){if(e instanceof d==0)throw new Error("V is not a Vector");return this.x*e.x+this.y*e.y+this.z*e.z}crossProduct(e){if(e instanceof d==0)throw new Error("V is not a Vector");return new d(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}timesScalar(e){if("number"!=typeof e)throw new Error("S has to be numerical");return new d(this.x*e,this.y*e,this.z*e,this.w*e)}plusVector(e){if(e instanceof d==0)throw new Error("V is not a vector");return new d(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)}minusVector(e){if(e instanceof d==0)throw new Error("V is not a vector");return new d(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)}normalize(){const e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return new d(this.x/e,this.y/e,this.z/e)}plusVertex(e){if(e instanceof h==0)throw new Error("V is not a vertex");return new h(this.x+e.x,this.y+e.y,this.z+e.z)}timesEqualsScalar(e){if("number"!=typeof e)throw new Error("S is not a number");return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}timesEqualsMatrix(e){if(e instanceof i==0)throw new Error("M must be a Matrix");const t=e.v1,o=e.v2,r=e.v3,n=e.v4,s=t.x*this.x+o.x*this.y+r.x*this.z+n.x*this.w,l=t.y*this.x+o.y*this.y+r.y*this.z+n.y*this.w,a=t.z*this.x+o.z*this.y+r.z*this.z+n.z*this.w,d=t.w*this.x+o.w*this.y+r.w*this.z+n.w*this.w;return this.x=s,this.y=l,this.z=a,this.w=d,this}plusEqualsVector(e){if(e instanceof d==0)throw new Error("V is not a vector");return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}minusEqualsVector(e){if(e instanceof d==0)throw new Error("V is not a Vector");return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}normalizeEquals(){const e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=e,this.y/=e,this.z/=e,this}toString(){return M("[x, y, z, w] = [%3.5d, %3.5d, %3.5d, %3.5d]",this.x,this.y,this.z,this.w)}static main(){console.log("Creating new Vector v1 = new Vector(1, 1, 1)");const e=new d(1,1,1);console.log("Creating Vector v2 from buildVertex(vertex1 = new Vertex(2, 2, 2))");const t=new h(2,2,2),o=d.buildVertex(t);console.log(""),console.log("Creating dotProdV = v1.dotProduct(v2): ");const i=e.dotProduct(o);console.log(i),console.log(""),console.log("Creating crossProdV = v1.crossProduct(v2): ");const r=e.crossProduct(o);console.log(r.toString()),console.log(""),console.log("Creating timesNum = v1.timesScalar(5): ");const n=e.timesScalar(5);console.log(n.toString()),console.log(""),console.log("Creating plusVect = v1.plusVector(v2): ");const s=e.plusVector(o);console.log(s.toString()),console.log(""),console.log("Creating minusVect = v1.minusVector(v2): ");const l=e.minusVector(o);console.log(l.toString()),console.log(""),console.log("Creating v1Norm = v1.normalize(): ");const a=e.normalize();console.log(a.toString()),console.log(""),console.log("Creating plusVert = v1.plusVertex(vertex1): ");const u=e.plusVertex(t);console.log(u.toString()),console.log(""),console.log("v1.timesEqualsScalar(2): "),e.timesEqualsScalar(2),console.log(e.toString()),console.log(""),console.log("v1.plusEqualsVector(v2): "),e.plusEqualsVector(o),console.log(e.toString()),console.log(""),console.log("v1.minusEqualsVector(v2): "),e.minusEqualsVector(o),console.log(e.toString()),console.log(""),console.log("v1.normalizeEquals(): "),e.normalizeEquals(),console.log(e.toString())}}class h{#c;#g;#f;#m;constructor(e,t,o,i=1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i)throw new Error("All parameters must be numerical");this.#c=e,this.#g=t,this.#f=o,this.#m=i}getX(){return this.#c}get x(){return this.#c}getY(){return this.#g}get y(){return this.#g}getZ(){return this.#f}get z(){return this.#f}getW(){return this.#m}get w(){return this.#m}toString(){return M("(x, y, z, w) = (%3.5d, %3.5d, %3.5d, %3.5d)",this.#c,this.#g,this.#f,this.#m)}static main(){console.log("Creating vertex v1 = 1, 1, 1, 1");const e=new h(1,1,1);console.log("Checking functions of v1"),console.log(""),console.log("v1.x: "),console.log(e.x),console.log("v1.getX(): "),console.log(e.getX()),console.log(""),console.log("v1.y: "),console.log(e.y),console.log("v1.getY(): "),console.log(e.getY()),console.log(""),console.log("v1.z: "),console.log(e.z),console.log("v1.getZ(): "),console.log(e.getZ()),console.log(""),console.log("v1.w: "),console.log(e.w),console.log("v1.getW(): "),console.log(e.getW()),console.log(""),console.log("v1: "),console.log(e),console.log("v1.toString(): "),console.log(e.toString())}}class u{#w;#x;constructor(e=new Array,t=new Array){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("Vertex and Color index lists must be Array types");for(let t=0;t<e.length;t+=1)if("number"!=typeof e[t]&&null!=typeof e[t])throw new Error("All Vertex indexes must be numerical");for(let e=0;e<t.length;e+=1)if("number"!=typeof t[e]&&null!=typeof t[e])throw new Error("All Color indexes must be numerical");this.#w=e,this.#x=t}static buildIndices(...e){let t=new u;for(let o of e){if("number"!=typeof o)throw new Error("indice "+o+" must be numerical");t.addIndices(o,o)}return t}addIndex(...e){for(let t of e)this.addIndices(t,t)}addIndices(e=0,t=0){if("number"!=typeof e||"number"!=typeof t)throw new Error("Vertex and Color indexes must be numerical");this.#w[this.#w.length]=e,this.#x[this.#x.length]=t}setColorIndices(...e){if(this.#x.length!=e.length)throw new Error("Wront number of color indexes");const t=this.#x.length;for(let o=0;o<e.length;o+=1){if("number"!=typeof e[o])throw this.#x.length=t,new Error("Color index "+o+" is not numerical");this.#x.push(e[o])}this.#x.splice(t,this.#x.length)}setColorIndex(e=0){if("number"!=typeof e)throw new Error("Color index is not numerical");for(let t=0;t<this.#x.length;t+=1)this.#x[t]=e}getVertexIndexList(){return this.#w}get vIndexList(){return this.#w}getColorIndexList(){return this.#x}get cIndexList(){return this.#x}}class c extends u{radius=0;constructor(e=0,t=e){super([e],[t])}toString(){return"Point: (["+this.getVertexIndexList()[0]+"], ["+this.getColorIndexList()[0]+"]) radius = "+this.radius}}class g extends u{constructor(e=new Array(2),t=new Array(2)){if(0==Array.isArray(e)||0==Array.isArray(t))throw new Error("Vertex Index List and Color Index List must be an array. ");if(2!=e.length||2!=t.length)throw new Error("Need 2 points to make a line segment");super(e,t)}static buildVertex(e=0,t=1){return new g(new Array(e,t),new Array(e,t))}static buildVertexColor(e=0,t=1,o=0){return new g(new Array(e,t),new Array(o,o))}static buildVertexColors(e=0,t=1,o=0,i=1){return new g(new Array(e,t),new Array(o,i))}toString(){return"LineSegment: (["+this.getVertexIndexList()[0]+", "+this.getVertexIndexList()[1]+"], ["+this.getColorIndexList()[0]+", "+this.getColorIndexList()[1]+"])"}}function f(e){if(e instanceof r==0)throw new Error("Model is not a Model");let t=!1;0==e.getVertexList().length&&0!=e.getPrimitiveList().length&&(console.log("***WARNING: This model does not have any vertices."),t=!0),0!=e.getVertexList().length&&0==e.getPrimitiveList().length&&(console.log("***WARNING: This model does not have any primitives"),t=!0),0!=e.getVertexList().length&&0==e.getColorList().length&&(console.log("***WARNING: This model does not have any colors."),t=!0),t&&console.log(e.toString())}function m(e){if(e instanceof r==0)throw new Error("Model must be a Model");const t=e.getVertexList().length;let o=!0;for(let i of e.getPrimitiveList())for(let e=0;e<i.getVertexIndexList().length;++e)e>=t&&(console.log("This Primitve has invalid Vertex index: "+e),console.log(i),o=!1);const i=e.getColorList().length;for(let t of e.getPrimitiveList())for(let e=0;e<t.getColorIndexList().length;++e)e>=i&&(console.log("This Primitve has invalid Color index: "+e),console.log(t),o=!1);return o}function w(e,t){if(e instanceof r==0)throw new Error("Model must be a Model");if(t instanceof A==0)throw new Error("Color must be a Color");if(0==e.getColorList().length)for(let o=0;o<e.getVertexList().length;o+=1)e.addColor(t);else for(let o=0;o<e.getColorList().length;o+=1)e.getColorList()[o]=t;for(const o of e.nestedModels)w(o,t)}function x(e){w(e,V())}function b(e){if(e instanceof r==0)throw new Error("Model must be a Model");e.getColorList().length=0;for(let t=0;t<e.getVertexList().length;t+=1)e.addColor(V());for(let t of e.getPrimitiveList())for(let e=0;e<t.getVertexIndexList().length;e+=1)t.getColorIndexList()[e]=t.getVertexIndexList()[e];for(const t of e.nestedModels)b(t)}function v(e){if(e instanceof r==0)throw new Error("Model must be a model");e.getColorList().length=0;let t=0;for(let o of e.getPrimitiveList()){e.addColor(V());for(let e=0;e<o.getColorIndexList().length;e+=1)o.getColorIndexList()[e]=t;++t}for(const t of e.nestedModels)v(t)}function p(e){if(e instanceof r==0)throw new Error("Model must be a Model");e.getColorList().length=0;let t=0;for(let o of e.getPrimitiveList())for(let i=0;i<o.getColorIndexList().length;++i)e.addColor(V()),o.getColorIndexList()[i]=t,++t;for(const t of e.nestedModels)p(t)}function V(){let e=255*Math.random(),t=255*Math.random(),o=255*Math.random();return new A(e,t,o)}function y(e,t=0){if(e instanceof r==0)throw new Error("Model must be a model");if("number"!=typeof t)throw new Error("Point Size must be a number");let o=new Array;for(let t=0;t<e.getVertexList().length;t+=1)o[t]=e.vertexList[t];let i=new Array;for(let t=0;t<e.getColorList().length;t+=1)i[t]=e.colorList[t];let n=new r(o,new Array,i,void 0,void 0,"PointCloud: "+e.getName(),e.visible),s=new Array(e.getVertexList().length),l=new Array(e.getVertexList().length);for(let t of e.getPrimitiveList())for(let e=0;e<t.getVertexIndexList().length;e+=1)s[t.getVertexIndexList()[e]]=!0,l[t.getVertexIndexList()[e]]=t.getColorIndexList()[e];for(let e=0;e<s.length;e+=1)s[e]&&n.addPrimitive(new c(e,l[e]));for(let e of n.getPrimitiveList())e.radius=t;for(const o of e.nestedModels)n.addNestedModel(y(o,t));return n}function M(e,...t){if("string"!=typeof e)throw new Error("Str must be a string");let o="",i=0;for(let r=0;r<e.length;r+=1)if("%"!=e.charAt(r))o+=e.charAt(r);else{let n="";for(;"d"!=e.charAt(++r)&&"f"!=e.charAt(r)&&"s"!=e.charAt(r);)n+=e.charAt(r);n+=e.charAt(r),o+=P(n,t[i++])}return o}function P(e,t){let o="";for(let i=0;i<e.length;i+=1){const r=e.charAt(i);if("d"==r){if("number"!=typeof t)throw new Error("Value must be numerical but got type "+typeof t);return Math.trunc(t).toString()}if("f"==r){if("number"!=typeof t)throw new Error("Value must be numerical but got type "+typeof t);return t.toString()}if("s"==r){if("string"!=typeof t)throw new Error("Value must be string but got type "+typeof t);return t}{let r="0";for(;"."!=e.charAt(i)&&"d"!=e.charAt(i)&&"f"!=e.charAt(i);)r+=e.charAt(i++);if("."==e.charAt(i)){o+=C(r,t,!0);let n=i;for(i+=1;"d"!=e.charAt(i)&&"f"!=e.charAt(i);)n+=1,i+=1;o+=L(e.substring(i,n),t),i+=1}else o+=C(r,t,!1)}}if(t<0&&"-"!=o.charAt(0)){if(o.includes("-")){let e=o.indexOf("-"),t=o.substring(0,e),i=o.substring(e+1,o.length);o=t+"0"+i}o="-"+o.substring(1,o.length)}return o}function C(e,t,o){let i="";o&&(t=Math.trunc(t));let r=Number(e),n=t.toString();if(n.length<r){for(let e=0;e<r-n.length;e+=1)i+="0";i+=n}else n.length-1>=r?i=n.substring(0,r):i+=n;return i}function L(e,t){if(0==e.length)return".";let o=Number(e),i=t.toString(),r="";if(i.includes(".")){if(r=i.substring(i.indexOf(".")+1),r.length>o)r=r.substring(0,o);else if(r.length<o)for(;r.length<o;)r+="0"}else for(;o-- >0;)r+="0";return"."+r}class E{static drawCameraDetails=!0;static drawMatrix=!0;static drawMatrixDetails=!0;static drawVertexList=!1;static visitedNodes=[];static visitedNodeNames=[];static nodeNumber;static sceneToDot(e){let t="strict digraph {\n";t+='graph [ordering="out"];\n',t+='graph [fontname="helvetica"];\n',t+='node  [fontname="helvetica"];\n',t+='edge  [fontname="helvetica"];\n',t+=`scene [label="Scene: ${e.name}"];\n`;let o="Camera";t+=o+" ",this.drawCameraDetails?t+=`[label="${e.camera}"];\n`:t+='[label="Camera"];\n',t+=`scene -> ${o};\n`;let i="positionList";t+=i+" ",t+='[label="List<Position>"];\n',t+=`scene -> ${i};\n`,this.visitedNodes=[],this.visitedNodeNames=[],this.nodeNumber=-1;for(let o=0;o<e.positionList.length;++o){++this.nodeNumber;let r="_p"+this.nodeNumber,n=e.getPosition(o);this.visitedNodes.push(n),this.visitedNodeNames.push(r),t+=r+" ",t+=`[label="Position: ${n.name} "];\n`,t+=`${i} -> ${r};\n`,t+=this.positionToDot(n,r)}return t+="}\n",t}static positionToDot(e,t){let o="";if(this.drawMatrix||this.drawMatrixDetails){let i=t+"_Matrix";o+=i+" ",this.drawMatrixDetails?o+=`[label="Matrix: ${e.getMatrix()}"];\n`:o+='[label="Matrix"];\n',o+=`${t} -> ${i};\n`}let i=e.getModel();if(this.visitedNodes.includes(i)){let e=this.visitedNodes.indexOf(i);o+=`${t} -> ${this.visitedNodeNames[e]};\n`}else{++this.nodeNumber;let e="_m"+this.nodeNumber;this.visitedNodes.push(i),this.visitedNodeNames.push(e),o+=e+" ",o+=`[label="Model: ${i.name}"];\n`,o+=`${t} -> ${e};\n`,o+=this.modelToDot(i,e)}if(0===!e.nestedPositions.length){let i=t+"_List ";o+=i+" ",o+='[label="Array<Position>"];\n',o+=`${t} -> ${i};\n`;for(let t=0;t<e.nestedPositions.length;++t){let r=e.getNestedPosition(t);if(this.visitedNodes.includes(r)){let e=this.visitedNodes.indexOf(r);o+=`${i} -> ${this.visitedNodeNames[e]} ;\n`}else{++this.nodeNumber;let e="_p"+this.nodeNumber;this.visitedNodes.push(r),this.visitedNodeNames.push(e),o+=e+" ",o+=`[label="Position: ${r.name}"];\n`,o+=`${i} -> ${e};\n`,o+=this.positionToDot(r,e)}}}return o}static modelToDot(e,t){let o="";if(this.drawMatrix||this.drawMatrixDetails){let i=t+"_Matrix";o+=i+" ",this.drawMatrixDetails?o+=`[label="Matrix:\n${e.getMatrix()}"];\n`:o+='[label="Matrix"];\n',o+=`${t} -> ${i};\n`}if(this.drawVertexList){let i=t+"_vertexList";o+=i+" ",o+='[label="Array<Vertex>"];\n',o+=`${t} -> ${i};\n`;let r=0,n=i;for(let i of e.vertexList){let e=t+"_v"+r;o+=e+" ",o+=`[label="Vertex: ${i}"];\n`,o+=`${n} -> ${e};\n`,n=e,++r}let s=t+"_colorList";o+=s+" ",o+='[label="Array<Color>"];\n',o+=`${t} -> ${s};\n`;let l=0,a=s;for(let i of e.colorList){let e=t+"_c"+l;o+=e+" ",o+=`[label="${i}"];\n`,o+=`${a} -> ${e};\n`,a=e,++l}let d=t+"_primitiveList";o+=d+" ",o+='[label="Array<Primitive>"];\n',o+=`${t} -> ${d};\n`;let h=0,u=d;for(let i of e.primitiveList){let e=t+"_p"+h;o+=e+" ",o+=`[label="${i}"];\n`,o+=`${u} -> ${e};\n`,u=e,h++}}if(0!==e.nestedModels.length){let i=t+"_List ";o+=i+" ",o+='[label="Array<Model>"];\n',o+=`${t} -> ${i};\n`;for(let t=0;t<e.nestedModels.length;++t){let r=e.getNestedModel(t);if(this.visitedNodes.includes(r)){let e=this.visitedNodes.indexOf(r);o+=`${i} -> ${this.visitedNodeNames[e]};\n`}else{++this.nodeNumber;let e="_m"+this.nodeNumber;this.visitedNodes.push(r),this.visitedNodeNames.push(e),o+=e+" ",o+=`[label="Model: ${r.name}"];\n`,o+=`${i} -> ${e};\n`,o+=this.modelToDot(r,e)}}}return o}}class S{#b;#v;#p;#V;#y;constructor(e,t,o=A.Black){if("number"!=typeof e||"number"!=typeof t)throw new Error("Width and Height must be numerical");o instanceof A==0&&(o=A.Black),this.#b=Math.round(e),this.#v=Math.round(t),this.#p=o,this.#y=new Uint8ClampedArray(this.#b*this.#v*4),this.#V=z.buildParent(this)}static buildFB(e){if(e instanceof S==0)throw new Error("Source is not instance of FrameBuffer");const t=new S(e.getWidthFB(),e.getHeightFB(),e.getBackgroundColorFB());for(let o=0;o<e.getWidthFB();o+=1)for(let i=0;i<e.getHeightFB();i+=1)t.setPixelFB(o,i,e.getPixelFB(o,i));return t}static buildVP(e){if(e instanceof z==0)throw new Error("Source is not instance of Viewport");const t=new S(e.getWidthVP(),e.getHeightVP(),e.getBackgroundColorVP());for(let o=0;o<e.getWidthVP();o+=1)for(let i=0;i<e.getHeightVP();i+=1)t.setPixelFB(o,i,e.getPixelVP(o,i));return t}static async buildFile(e){if("string"!=typeof e)throw new Error("Filename must be a string");try{return document,await S.#M(e)}catch(e){}}static async#M(e){const t=await fetch(e,{method:"GET"}),o=await t.arrayBuffer();return S.interpretData(new Uint8Array(o))}static interpretData(e){let t=0;const o=e[t++],i=e[t++];if("P6"!=String.fromCharCode(o,i))throw new Error("Missing the magic P6");for(;e[t]<48||e[t]>57;)t+=1;let r="";for(;e[t]>=48&&e[t]<=57;)r+=String.fromCharCode(e[t++]);t++;let n="";for(;e[t]>=48&&e[t]<=57;)n+=String.fromCharCode(e[t++]);const s=new S(+r,+n);for(;e[t]<48||e[t]>57;)t+=1;let l="";for(;e[t]>=48&&e[t]<=57;)l+=String.fromCharCode(e[t++]);for(;e[t]<=32;)t+=1;let a=0;for(;t<e.length;t+=3){let o=e[t+0],i=e[t+1],r=e[t+2];const n=255;o<0&&(o+=256),i<0&&(i+=256),r<0&&(r+=256),s.pixelBuffer[a+0]=o,s.pixelBuffer[a+1]=i,s.pixelBuffer[a+2]=r,s.pixelBuffer[a+3]=n,a+=4}return s}getWidthFB(){return this.#b}get width(){return this.#b}getHeightFB(){return this.#v}get height(){return this.#v}getBackgroundColorFB(){return this.#p}get bgColorFB(){return this.#p}setBackgroundColorFB(e){if(e instanceof A==0)throw new Error("Color must be instance of Color");this.#p=e}set bgColorFB(e){if(e instanceof A==0)throw new Error("Color must be instance of Color");this.#p=e}getViewport(){return this.#V}get vp(){return this.#V}get pixelBuffer(){return this.#y}getPixelBuffer(){return this.#y}setViewportDefault(){this.setViewport(this.getWidthFB(),this.getHeightFB())}setViewport(e,t,o=0,i=0,r=this.#p){if("number"!=typeof o||"number"!=typeof i||"number"!=typeof e||"number"!=typeof t)throw new Error("All Parameters must be Numerical");this.#V.setViewport(e,t,o,i,r)}clearFBDefault(){this.clearFB(this.getBackgroundColorFB())}clearFB(e=this.#p){if(e instanceof A==0)throw new Error("Color must be a Color");const t=e.rgb;for(let e=0;e<this.#y.length;e+=4)this.#y[e+0]=t[0],this.#y[e+1]=t[1],this.#y[e+2]=t[2],this.#y[e+3]=t[3]}getPixelFB(e,t){if("number"!=typeof e||"number"!=typeof t)throw new Error("x and y must be numerical");if(e=Math.round(e),(t=Math.round(t))*this.getWidthFB()+e>=this.#y.length)throw new Error("FrameBuffer: Bad pixel coordinate ("+e+", "+t+") [w= "+this.getWidthFB()+", h= "+this.getHeightFB()+"]");const o=4*this.width*t+4*e,i=this.#y[o+0],r=this.#y[o+1],n=this.#y[o+2],s=this.#y[o+3];return new A(i,r,n,s)}setPixelFB(e,t,o=A.Black){if("number"!=typeof e||"number"!=typeof t)throw new Error("X and Y must be Numerical");if(o instanceof A==0)throw new Error("Color must be of type Color");e=Math.round(e),t=Math.round(t);const i=4*this.getWidthFB()*t+4*e;if(i>=this.#y.length)throw new Error("FrameBuffer: Bad pixel coordinate ("+e+", "+t+") [w= "+this.getWidthFB()+", h= "+this.getHeightFB()+"]");const r=o.rgb;this.#y[i+0]=r[0],this.#y[i+1]=r[1],this.#y[i+2]=r[2],this.#y[i+3]=r[3]}convertRed2FB(){const e=S.buildFB(this);for(let t=0;t<this.getWidthFB();t+=1)for(let o=0;o<this.getHeightFB();o+=1){const i=this.getPixelFB(t,o),r=new A(i.getRed(),0,0);e.setPixelFB(t,o,r)}return e}convertGreen2FB(){const e=S.buildFB(this);for(let t=0;t<this.getWidthFB();t+=1)for(let o=0;o<this.getHeightFB();o+=1){const i=this.getPixelFB(t,o),r=new A(0,i.getGreen(),0);e.setPixelFB(t,o,r)}return e}convertBlue2FB(){const e=S.buildFB(this);for(let t=0;t<this.getWidthFB();t+=1)for(let o=0;o<this.getHeightFB();o+=1){const i=this.getPixelFB(t,o),r=new A(0,0,i.getBlue());e.setPixelFB(t,o,r)}return e}toString(){let e="FrameBuffer [w="+this.width+", h="+this.height+"]\n";for(let t=0;t<this.width;++t)e+=" r   g   b |";e+="\n";for(let t=0;t<this.height;++t){for(let o=0;o<this.width;o+=1){const i=this.#y[t*this.width+o],r=this.#y[t*this.width+o],n=this.#y[t*this.width+o],s=this.#y[t*this.width+o],l=new A(i,r,n,s);e+=M("%3d ",l.getRed()),e+=M("%3d ",l.getGreen()),e+=M("%3d|",l.getBlue())}e+="\n"}return e}static main(){}}class z{#P;#C;#L;#E;#S;#z;constructor(e,t,o,i=0,r=0,n=A.Black){if("number"!=typeof i||"number"!=typeof r||"number"!=typeof e||"number"!=typeof t)throw new Error("upperLeftX, upperLeftY, width, height must be numerical");if(o instanceof S==0)throw new Error("Parent is required and must be a FrameBuffer");n instanceof A==0&&(n=A.Black),this.#S=n,this.#z=o,this.setViewport(e,t,i,r,this.#S)}static buildParent(e){if(e instanceof S==0)throw new Error("Parent is required and must be a FrameBuffer");return new z(e.getWidthFB(),e.getHeightFB(),e,0,0,e.getBackgroundColorFB())}static buildFB(e,t,o=0,i=0){if("number"!=typeof o||"number"!=typeof i)throw new Error("UpperLeftX and UpperleftY must be numerical.");if(e instanceof S==0)throw new Error("Source must be of type FrameBuffer");if(t instanceof S==0)throw new Error("Parent is required and must be a framebuffer");const r=new z(e.getWidthFB(),e.getHeightFB(),t,o,i,e.getBackgroundColorFB());for(let t=0;t<e.getWidthFB();t+=1)for(let o=0;o<e.getHeightFB();o+=1)r.setPixelVP(t,o,e.getPixelFB(t,o));return r}static buildVP(e,t,o=0,i=0){if("number"!=typeof o||"number"!=typeof i)throw new Error("UpperLeftX and UpperleftY must be numerical.");if(e instanceof z==0)throw new Error("Source must be of type FrameBuffer");if(t instanceof S==0)throw new Error("Parent is required and must be a framebuffer");const r=new z(e.getWidthVP(),e.getHeightVP(),t,o,i,e.getBackgroundColorVP());for(let t=0;t<e.getWidthVP();t+=1)for(let o=0;o<e.getHeightVP();o+=1)r.setPixelVP(t,o,e.getPixelVP(t,o));return r}setViewport(e,t,o=0,i=0,r){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i)throw new Error("All parameters must be numerical.");if(r instanceof A==0)throw new Error("Background Color must be a Color");o=Math.round(o),i=Math.round(i),e=Math.round(e),t=Math.round(t),this.#P=o,this.#C=i,this.#L=this.#P+e,this.#E=this.#C+t,this.#S=r,this.clearVP()}getFrameBuffer(){return this.#z}framebuffer=()=>this.#z;get parent(){return this.#z}getWidthVP(){return this.#L-this.#P}get width(){return this.#L-this.#P}getHeightVP(){return this.#E-this.#C}get height(){return this.#E-this.#C}getBackgroundColorVP(){return this.#S}get bgColorVP(){return this.#S}get vp_ul_x(){return this.#P}get vp_ul_y(){return this.#C}get vp_lr_x(){return this.#L}get vp_lr_y(){return this.#E}setBackgroundColorVP(e){if(e instanceof A==0)throw new Error("Color is not of type Color");this.#S=e}set bgColorVP(e){if(e instanceof A==0)throw new Error("Color must be an intance of Color");this.#S=e}clearVPDefault(){this.clearVP(this.getBackgroundColorVP())}clearVP(e=this.#S){if(e instanceof A==0)throw new Error("Color is not of type Color");const t=e.rgb;for(let e=0;e<this.height;e+=1){let o=this.#C*(4*this.parent.width)+e*this.parent.width*4;for(let e=4*this.#P;e<4*(this.width+this.#P);e+=4){const i=o+e;this.parent.pixelBuffer[i+0]=t[0],this.parent.pixelBuffer[i+1]=t[1],this.parent.pixelBuffer[i+2]=t[2],this.parent.pixelBuffer[i+3]=t[3]}}}getPixelVP(e,t){if("number"!=typeof e||"number"!=typeof t)throw new Error("X and Y must be numerical");return e=Math.round(e),t=Math.round(t),this.#z.getPixelFB(this.#P+e,this.#C+t)}setPixelVP(e,t,o=A.black){if("number"!=typeof e||"number"!=typeof t)throw new Error("X and Y must be numerical");if(o instanceof A==0)throw new Error("Color must be a Color");e=Math.round(e),t=Math.round(t),this.#z.setPixelFB(this.#P+e,this.#C+t,o)}convertVP2FB(){return S.buildVP(this)}dumpVP2File(e){if("string"!=typeof e)throw new Error("Filename must be a String")}toString(){let e="Viewport [w="+this.width+", h="+this.height+"]\n";for(let t=0;t<this.width;++t)e+=" r   g   b |";e+="\n";for(let t=0;t<this.height;++t){for(let o=0;o<this.width;++o){const i=this.getPixelVP(o,t),r=A.buildColor(i);e+=M("%3d ",r.getRed()),e+=M("%3d ",r.getGreen()),e+=M("%3d|",r.getBlue())}e+="\n"}return e}static main(){const e=new S(10,10);console.log("creating vp1 = new VP(3, 3, fb = new FrameBuffer(10, 10), 4, 4, color.orange)");const t=new z(3,3,e,4,4,A.orange);console.log("creating vp2 = VP.buildParent()");const o=z.buildParent(e);console.log("creating vp3 = vP.buildFB");const i=z.buildFB(new S(5,5),e,2,2);console.log("creating vp4 = vp.buildVP");const r=z.buildVP(t,e,0,0);console.log(""),console.log("vp1.getFramebuffer()"),console.log(t.getFrameBuffer().toString()),console.log(""),console.log("vp2.framebuffer()"),console.log(o.framebuffer().toString()),console.log(""),console.log("vp3.parent"),console.log(i.parent.toString()),console.log(""),console.log("vp1.getWidthVP()"),console.log(t.getWidthVP()),console.log(""),console.log("vp1.getHeightVP()"),console.log(t.getHeightVP()),console.log(""),console.log("vp4.width"),console.log(r.width),console.log(""),console.log("vp4.height"),console.log(r.height),console.log(""),console.log("vp2.getBackGroundColorVP()"),console.log(o.getBackgroundColorVP().toString()),console.log(""),console.log("vp3.bgColorVP"),console.log(i.bgColorVP.toString()),console.log(""),console.log("vp3.setBackGroundColorVP(Color.Green"),i.setBackgroundColorVP(A.Green),console.log(i.toString()),console.log(""),console.log("vp3.clearVPDefault()"),i.clearVPDefault(),console.log(i.toString()),console.log(""),console.log("vp2.setPixelVP(1, 1, Color.PINK)"),o.setPixelVP(1,1,A.Pink),console.log(o.toString()),console.log(""),console.log("vp2.getPixelVP(1, 1"),console.log(o.getPixelVP(1,1).toString())}}class A{#A=new Uint8ClampedArray(4);static GAMMA=1/2.2;static black=new A;static BLACK=new A;static Black=new A;static white=new A(255,255,255);static WHITE=new A(255,255,255);static White=new A(255,255,255);static red=new A(255,0,0);static RED=new A(255,0,0);static Red=new A(255,0,0);static green=new A(0,255,0);static GREEN=new A(0,255,0);static Green=new A(0,255,0);static blue=new A(0,0,255);static BLUE=new A(0,0,255);static Blue=new A(0,0,255);static orange=new A(255,127,0);static ORANGE=new A(255,127,0);static Orange=new A(255,127,0);static yellow=new A(255,255,0);static YELLOW=new A(255,255,0);static Yellow=new A(255,255,0);static pink=new A(255,192,203);static PINK=new A(255,192,203);static Pink=new A(255,192,203);static cyan=new A(0,255,255);static CYAN=new A(0,255,255);static Cyan=new A(0,255,255);static magenta=new A(255,0,255);static MAGENTA=new A(255,0,255);static Magenta=new A(255,0,255);static gray=new A(192,192,192);static GRAY=new A(192,192,192);static Gray=new A(192,192,192);constructor(e=0,t=0,o=0,i=255){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i)throw new Error("All parameters must be numeric");this.#A[0]=e,this.#A[1]=t,this.#A[2]=o,this.#A[3]=i}static buildColor(e){if(e instanceof A==0)throw new Error("color is not of type Color");return new A(e.#A[0],e.#A[1],e.#A[2],e.#A[3])}static buildRGBA(e){if(e instanceof Uint8ClampedArray==0)throw new Error("RGBA needs to be a uint8clamped array");return new A(e[0],e[1],e[2],e[3])}static buildAlpha(e,t){if(e instanceof A==0)throw new Error("Color is not of type Color");if("number"!=typeof t)throw new Error("Alpha is not numerical");return new A(e.#A[0],e.#A[1],e.#A[2],t)}static blendColor(e,t){return A.blendColorWeight(e,t,e.getAlpha()/(e.getAlpha()+t.getAlpha()))}static blendColorWeight(e,t,o=.5){if(e instanceof A==0||t instanceof A==0)throw new Error("C1 and C2 are not of type color");if("number"!=typeof o)throw new Error("c1Weight is not numerical");if(!(o>=0&&o<=1))throw new Error("c1Weight has to be in the range 0 to 1 inclusive");const i=o*e.getRed()+(1-o)*t.getRed(),r=o*e.getGreen()+(1-o)*t.getGreen(),n=o*e.getBlue()+(1-o)*t.getBlue();return new A(i,r,n,255)}darker(e=.1){return this.#N(1-e)}lighter(e=.1){return this.#N(1+e)}brighter(e=.1){return this.#N(1+e)}#N(e){return new A(this.#A[0]*e,this.#A[1]*e,this.#A[2]*e,this.#A[3])}getRed(){return this.#A[0]}getGreen(){return this.#A[1]}getBlue(){return this.#A[2]}getAlpha(){return this.#A[3]}setAlpha(e){if("number"!=typeof e)throw new Error("a is not numerical");if(e<0||e>255)throw new Error("a is supposed to be between 0 and 255 inclusive");this.#A[3]=Math.round(e)}getRGBComponents(){return this.#A}get rgb(){return this.#A}toString(){return M("(r, g, b): (%3d, %3d, %3d)",this.#A[0],this.#A[1],this.#A[2])}static main(){}static applyGamma(e){if(e instanceof A==0)throw new Error("Color is not of type Color");const t=255*Math.pow(e.getRed()/255,A.GAMMA),o=255*Math.pow(e.getGreen()/255,A.GAMMA),i=255*Math.pow(e.getBlue()/255,A.GAMMA);return new A(t,o,i)}static hexToRgba(e){return e.match(/^#[A-Fa-f0-9]{6}/)?new Array([parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16),255]):new Array([0,0,0,255])}static RgbToHex(e){if(e instanceof A==0)throw new Error("Color is not of type Color");return"#"+A.intToHex(e[0])+A.intToHex(e[1])+A.intToHex(e[2])}static intToHex(e){return e<10?"0"+e.toString(16):e.toString(16)}}class N extends r{constructor(e=-1,t=1,o=-1,i=1,r=5,n=5,s=A.white,l=A.white,a=0){super(void 0,void 0,void 0,void 0,void 0,M("Axes 2D(%.2f,%.2f,%.2f,%.2f)",e,t,o,i)),this.addColor(s,l),this.addVertex(new h(e,0,a),new h(t,0,a)),this.addPrimitive(g.buildVertexColor(0,1,0)),this.addVertex(new h(0,o,a),new h(0,i,a)),this.addPrimitive(g.buildVertexColor(2,3,1));let d=4,u=(t-e)/r,c=(i-o)/50;for(let o=e;o<=t;o+=u)this.addVertex(new h(o,c/2,a),new h(o,-c/2,a)),this.addPrimitive(g.buildVertexColor(d+0,d+1,0)),d+=2;c=(i-o)/n,u=(t-e)/50;for(let e=o;e<=i;e+=c)this.addVertex(new h(u/2,e,a),new h(-u/2,e,a)),this.addPrimitive(g.buildVertexColor(d+0,d+1,1)),d+=2}}class B extends r{constructor(e=-1,t=1,o=-1,i=1,r=-1,n=1,s=A.white,l=s,a=s){super(void 0,void 0,void 0,void 0,void 0,M("Axes 3D(%.2f,%.2f,%.2f,%.2f%.2f,%.2f)",e,t,o,i,r,n)),this.addVertex(new h(e,0,0),new h(t,0,0),new h(0,o,0),new h(0,i,0),new h(0,0,r),new h(0,0,n)),this.addPrimitive(g.buildVertexColor(0,1,0),g.buildVertexColor(2,3,1),g.buildVertexColor(4,5,2)),this.addColor(s,l,a)}}class I extends r{#B;#I;constructor(e,t=0){if(super(),e<0)throw new Error("n must be greater than or equal to 0");this.#B=t,this.#I=e;let o=t*Math.PI/180,i=2*Math.PI/3;this.addVertex(new h(Math.cos(o),Math.sin(o),0),new h(Math.cos(o+i),Math.sin(o+i),0),new h(Math.cos(o+2*i),Math.sin(o+2*i),0)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0)),e>0&&this.barycentric(0,1,2,e)}barycentric(e,t,o,i){const r=this.vertexList[e],n=this.vertexList[t],s=this.vertexList[o],l=this.vertexList.length;if(i>0){this.addVertex(new h((r.x+n.x+s.x)/3,(r.y+n.y+s.y)/3,(r.z+n.z+s.z)/3)),this.addVertex(new h((r.x+n.x)/2,(r.y+n.y)/2,(r.z+n.z)/2)),this.addVertex(new h((n.x+s.x)/2,(n.y+s.y)/2,(n.z+s.z)/2)),this.addVertex(new h((s.x+r.x)/2,(s.y+r.y)/2,(s.z+r.z)/2));const a=l,d=l+1,u=l+2,c=l+3;this.addPrimitive(g.buildVertex(e,a),g.buildVertex(t,a),g.buildVertex(o,a),g.buildVertex(d,a),g.buildVertex(u,a),g.buildVertex(c,a)),this.barycentric(e,d,a,i-1),this.barycentric(e,c,a,i-1),this.barycentric(t,d,a,i-1),this.barycentric(t,u,a,i-1),this.barycentric(o,u,a,i-1),this.barycentric(o,c,a,i-1)}}getHorizCount(){return this.#I}getVertCount(){return Math.round(this.#B)}remake(e,t){return new I(e,t)}}class F extends r{constructor(e=1,t=1,o=1){super(void 0,void 0,void 0,void 0,void 0,M("Box(%.2f,%.2f,%.2f)",e,t,o)),this.addVertex(new h(0,0,0),new h(0+e,0,0),new h(0+e,0,0+o),new h(0,0,0+o),new h(0,0+t,0),new h(0+e,0+t,0),new h(0+e,0+t,0+o),new h(0,0+t,0+o)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0),g.buildVertex(4,5),g.buildVertex(5,6),g.buildVertex(6,7),g.buildVertex(7,4),g.buildVertex(0,4),g.buildVertex(1,5),g.buildVertex(2,6),g.buildVertex(3,7))}}class _ extends r{#F;#_;#k;#I;constructor(e=1,t=0,o=Math.PI,i=8,r=M("CircleSector(%.2f,%.2f,%.2f,%d)",e,t,o,i)){if(super(void 0,void 0,void 0,void 0,void 0,r),i<4)throw new Error("n must be greater than 3");t%=2*Math.PI,o%=2*Math.PI,t<0&&(t=2*Math.PI+t),o<0&&(o=2*Math.PI+o),o<=t&&(o+=2*Math.PI),this.#F=e,this.#_=t,this.#k=o,this.#I=i;const n=(o-t)/(i-1);for(let o=0;o<i;++o){const i=Math.cos(t+o*n),r=Math.sin(t+o*n);this.addVertex(new h(e*i,e*r,0))}for(let e=0;e<i-1;++e)this.addPrimitive(g.buildVertex(e,e+1))}getHorizCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=e;return e==this.#I&&(o=t),new _(this.#F,this.#_,this.#k,o)}}class k extends _{constructor(e=1,t=16){super(e,0,360,16,M("Circle(%f.2,%d)",e,t))}}class q extends r{#q;#R;#T;#I;#G;constructor(e=1,t=.5,o=.5,i=7,r=16){if(super(void 0,void 0,void 0,void 0,void 0,M("Cone Frustum(%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r)),i<2)throw new Error("n must be greater than 1");if(r<3)throw new Error("k must be greater than 2");this.#q=e,this.#R=o,this.#T=t,this.#I=i,this.#G=r;const n=t/(i-1),s=2*Math.PI/r,l=new Array(i);for(let e=0;e<l.length;e+=1)l[e]=new Array(r);let a=0;for(let d=0;d<r;++d){const r=Math.cos(d*s),u=Math.sin(d*s);for(let s=0;s<i;++s){const c=s/(i-1)*e+(1-s/(i-1))*o;this.addVertex(new h(c*r,t-s*n,c*u)),l[s][d]=a,++a}}this.addVertex(new h(0,t,0));const d=a;++a,this.addVertex(new h(0,0,0));const u=a;++a;for(let e=0;e<i;++e){for(let t=0;t<r-1;++t)this.addPrimitive(g.buildVertex(l[e][t],l[e][t+1]));this.addPrimitive(g.buildVertex(l[e][r-1],l[e][0]))}for(let e=0;e<r;++e)this.addPrimitive(g.buildVertex(d,l[0][e])),this.addPrimitive(g.buildVertex(l[0][e],l[i-1][e])),this.addPrimitive(g.buildVertex(l[i-1][e],u))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new q(this.#q,this.#T,this.#R,e,t)}}class R extends r{#F;#T;#H;#_;#k;#I;#G;constructor(e=1,t=1,o=1,i=Math.PI/2,r=3*Math.PI/2,n=16,s=8,l=M("Cone Sector(%.2f,%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r,n,s)){if(super(void 0,void 0,void 0,void 0,void 0,l),n<2)throw new Error("n must be greater than 1");if(s<4)throw new Error("k must be greater than 3");if(t<o)throw new Error("h must be greater than or equal to t");i%=2*Math.PI,r%=2*Math.PI,i<0&&(i=2*Math.PI+i),r<0&&(r=2*Math.PI+r),r<=i&&(r+=2*Math.PI),this.#F=e,this.#T=t,this.#H=o,this.#_=i,this.#k=r,this.#I=n,this.#G=s;const a=o/(n-1),d=(r-i)/(s-1),u=new Array(n);for(let e=0;e<u.length;e+=1)u[e]=new Array(s);let c=0;for(let o=0;o<s;++o){const r=Math.cos(i+o*d),s=Math.sin(i+o*d);for(let i=0;i<n;++i){const n=e*(1-i*a/t);this.addVertex(new h(n*r,i*a,n*s)),u[i][o]=c++}}this.addVertex(new h(0,0,0));const f=c;++c;for(let e=0;e<n;++e)for(let t=0;t<s-1;++t)this.addPrimitive(g.buildVertex(u[e][t],u[e][t+1]));for(let e=0;e<s;++e){this.addPrimitive(g.buildVertex(f,u[0][e]));for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(u[t][e],u[t+1][e]))}}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new R(this.#F,this.#T,this.#H,this.#_,this.#k,e,t)}}class T extends R{constructor(e=1,t=1,o=15,i=6){super(e,t,t,0,360,o,i,M("Cone(%.2f,%.2f,%d,%d)",e,t,o,i))}}class G extends r{constructor(e="Cube"){super(void 0,void 0,void 0,void 0,void 0,e),this.addVertex(new h(-1,-1,-1),new h(1,-1,-1),new h(1,-1,1),new h(-1,-1,1),new h(-1,1,-1),new h(1,1,-1),new h(1,1,1),new h(-1,1,1)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0),g.buildVertex(4,5),g.buildVertex(5,6),g.buildVertex(6,7),g.buildVertex(7,4),g.buildVertex(0,4),g.buildVertex(1,5),g.buildVertex(2,6),g.buildVertex(3,7))}}class H extends r{constructor(e=1,t=1,o=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Cube2(%d,%d,%d)",e,t,o)),e<0)throw new Error("xGrid must be greater than or equal to 0");if(t<0)throw new Error("yGrid must be greater than or equal to 0");if(o<0)throw new Error("zGrid must be greater than or equal to 0");const i=2/(1+e),r=2/(1+t),n=2/(1+o);let s=-1;for(let l=0;l<=e+1;++l){const e=this.vertexList.length;let l=1;for(let e=0;e<=t;++e)this.addVertex(new h(s,l,1)),l-=r;let a=1;for(let e=0;e<=o;++e)this.addVertex(new h(s,-1,a)),a-=n;l=-1;for(let e=0;e<=t;++e)this.addVertex(new h(s,l,-1)),l+=r;a=-1;for(let e=0;e<=o+1;++e)this.addVertex(new h(s,1,a)),a+=n;const d=this.vertexList.length;for(let t=e;t<d-1;++t)this.addPrimitive(g.buildVertex(t,t+1));s+=i}let l=-1;for(let s=0;s<=t+1;++s){const t=this.vertexList.length;let s=1;for(let t=0;t<=e;++t)this.addVertex(new h(s,l,1)),s-=i;let a=1;for(let e=0;e<=o;++e)this.addVertex(new h(-1,l,a)),a-=n;s=-1;for(let t=0;t<=e;++t)this.addVertex(new h(s,l,-1)),s+=i;a=-1;for(let e=0;e<=o+1;++e)this.addVertex(new h(1,l,a)),a+=n;const d=this.vertexList.length;for(let e=t;e<d-1;++e)this.addPrimitive(g.buildVertex(e,e+1));l+=r}let a=-1;for(let s=0;s<=o+1;++s){const o=this.vertexList.length;let s=1;for(let t=0;t<=e;++t)this.addVertex(new h(s,1,a)),s-=i;let l=1;for(let e=0;e<=t;++e)this.addVertex(new h(-1,l,a)),l-=r;s=-1;for(let t=0;t<=e;++t)this.addVertex(new h(s,-1,a)),s+=i;l=-1;for(let e=0;e<=t+1;++e)this.addVertex(new h(1,l,a)),l+=r;const d=this.vertexList.length;for(let e=o;e<d-1;++e)this.addPrimitive(g.buildVertex(e,e+1));a+=n}}}class W extends G{constructor(e=1,t=1,o=1){if(super(M("Cube3(%d,%d,%d)",e,t,o)),e<1)throw new Error("xCount must be greater than or equal to 1");if(t<1)throw new Error("yCount must be greater than or equal to 1");if(o<1)throw new Error("zCount must be greater than or equal to 1");let i=8;const r=2/e,n=2/t,s=2/o;this.addVertex(new h(0,0,1),new h(0,0,-1),new h(0,1,0),new h(0,-1,0),new h(1,0,0),new h(-1,0,0));const l=i,a=i+1,d=i+2,u=i+3,c=i+4,f=i+5;i+=6;let m=-1;for(let t=0;t<=e;++t)this.addVertex(new h(m,1,1),new h(m,-1,1),new h(m,1,-1),new h(m,-1,-1)),this.addPrimitive(g.buildVertex(i+0,l),g.buildVertex(i+1,l)),this.addPrimitive(g.buildVertex(i+2,a),g.buildVertex(i+3,a)),this.addPrimitive(g.buildVertex(i+0,d),g.buildVertex(i+2,d)),this.addPrimitive(g.buildVertex(i+1,u),g.buildVertex(i+3,u)),m+=r,i+=4;let w=-1;for(let e=0;e<=t;++e)this.addVertex(new h(1,w,1),new h(-1,w,1),new h(1,w,-1),new h(-1,w,-1)),this.addPrimitive(g.buildVertex(i+0,l),g.buildVertex(i+1,l)),this.addPrimitive(g.buildVertex(i+2,a),g.buildVertex(i+3,a)),this.addPrimitive(g.buildVertex(i+0,c),g.buildVertex(i+2,c)),this.addPrimitive(g.buildVertex(i+1,f),g.buildVertex(i+3,f)),w+=n,i+=4;let x=-1;for(let e=0;e<=o;++e)this.addVertex(new h(1,1,x),new h(-1,1,x),new h(1,-1,x),new h(-1,-1,x)),this.addPrimitive(g.buildVertex(i+0,d),g.buildVertex(i+1,d)),this.addPrimitive(g.buildVertex(i+2,u),g.buildVertex(i+3,u)),this.addPrimitive(g.buildVertex(i+0,c),g.buildVertex(i+2,c)),this.addPrimitive(g.buildVertex(i+1,f),g.buildVertex(i+3,f)),x+=s,i+=4}}class D extends r{constructor(e=2,t=1,o=2){if(super(void 0,void 0,void 0,void 0,void 0,M("Cube4(%d,%d,%d)",e,t,o)),e<1)throw new Error("xCount must be greater than or equal to 1");if(t<0)throw new Error("yGrid must be greater than or equal to 0");if(o<1)throw new Error("zCount must be greater than or equal to 1");const i=2/e,r=2/(1+t),n=2/o,s=new Array(2+t);for(let t=0;t<s.length;t+=1)s[t]=new Array(2*e+2*o);for(let l=0;l<2+t;++l){for(let t=0;t<e;++t)s[l][t]=new h(t*i-1,l*r-1,-1);for(let t=0;t<o;++t)s[l][e+t]=new h(1,l*r-1,t*n-1);for(let t=0;t<e;++t)s[l][e+o+t]=new h(1-t*i,l*r-1,1);for(let t=0;t<o;++t)s[l][2*e+o+t]=new h(-1,l*r-1,1-t*n)}for(let i=0;i<2+t;++i)for(let t=0;t<2*e+2*o;++t)this.addVertex(s[i][t]);this.addVertex(new h(0,-1,0),new h(0,1,0));const l=(2+t)*(2*e+2*o),a=l+1;for(let i=0;i<2*e+2*o;++i)this.addPrimitive(g.buildVertex(l,i),g.buildVertex(a,(t+1)*(2*e+2*o)+i));for(let i=0;i<2+t;++i){for(let t=0;t<2*e+2*o-1;++t)this.addPrimitive(g.buildVertex(i*(2*e+2*o)+t,i*(2*e+2*o)+t+1));this.addPrimitive(g.buildVertex((1+i)*(2*e+2*o)-1,i*(2*e+2*o)))}for(let i=0;i<2*e+2*o;++i)for(let r=0;r<2+t-1;++r)this.addPrimitive(g.buildVertex(r*(2*e+2*o)+i,(r+1)*(2*e+2*o)+i))}}class $ extends r{#F;#T;#_;#k;#I;#G;constructor(e=1,t=1,o=Math.PI/2,i=3*Math.PI/2,r=15,n=8,s=M("Cylinder Sector(%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r,n)){if(super(void 0,void 0,void 0,void 0,void 0,s),r<2)throw new Error("n must be greater than 1");if(n<4)throw new Error("k must be greater than 3");o%=2*Math.PI,i%=2*Math.PI,o<0&&(o=2*Math.PI+o),i<0&&(i=2*Math.PI+i),i<=o&&(i+=2*Math.PI),this.#F=e,this.#T=t,this.#_=o,this.#k=i,this.#I=r,this.#G=n;const l=2*t/(r-1),a=(i-o)/(n-1),d=new Array(r);for(let e=0;e<d.length;e+=1)d[e]=new Array(n);for(let i=0;i<n;++i){const n=Math.cos(o+i*a),s=Math.sin(o+i*a);for(let o=0;o<r;++o)d[o][i]=new h(e*n,t-o*l,-e*s)}const u=new h(0,t,0),c=new h(0,-t,0);for(let e=0;e<r;++e)for(let t=0;t<n;++t)this.addVertex(d[e][t]);this.addVertex(u,c);const f=r*n,m=r*n+1;for(let e=0;e<r;++e)for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(e*n+t,e*n+(t+1)));for(let e=0;e<n;++e){this.addPrimitive(g.buildVertex(f,0*n+e));for(let t=0;t<r-1;++t)this.addPrimitive(g.buildVertex(t*n+e,(t+1)*n+e));this.addPrimitive(g.buildVertex((r-1)*n+e,m))}}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new $(this.#F,this.#T,this.#_,this.#k,e,t)}}class O extends ${constructor(e=1,t=1,o=15,i=16){super(e,t,0,2*Math.PI,o,i,M("Cylinder(%.2f,%.2f,%d,%d)",e,t,o,i))}}class Y extends r{#F;#_;#k;#I;#G;constructor(e=1,t=0,o=Math.PI,i=6,r=8,n=M("Disk Sector(%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r)){if(super(void 0,void 0,void 0,void 0,void 0,n),i<1)throw new Error("n must be greater than 0");if(r<4)throw new Error("k must be greater than 3");t%=2*Math.PI,o%=2*Math.PI,t<0&&(t=2*Math.PI+t),o<0&&(o=2*Math.PI+o),o<=t&&(o+=2*Math.PI),this.#F=e,this.#_=t,this.#k=o,this.#I=i,this.#G=r;const s=e/i,l=(o-t)/(r-1),a=new Array(i);for(let e=0;e<a.length;e+=1)a[e]=new Array(r);for(let e=0;e<r;++e){const o=Math.cos(t+e*l),r=Math.sin(t+e*l);for(let t=0;t<i;++t){const i=(t+1)*s;a[t][e]=new h(i*o,i*r,0)}}const d=new h(0,0,0);for(let e=0;e<i;++e)for(let t=0;t<r;++t)this.addVertex(a[e][t]);this.addVertex(d);const u=i*r;for(let e=0;e<r;++e){this.addPrimitive(g.buildVertex(u,0*r+e));for(let t=0;t<i-1;++t)this.addPrimitive(g.buildVertex(t*r+e,(t+1)*r+e))}for(let e=0;e<i;++e)for(let t=0;t<r-1;++t)this.addPrimitive(g.buildVertex(e*r+t,e*r+(t+1)))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new Y(this.#F,this.#_,this.#k,e,t)}}class j extends Y{constructor(e=1,t=6,o=12){super(e,0,2*Math.PI,t,o,M("Disk(%.2f,%d,%d)",e,t,o))}}class X extends r{constructor(){super(void 0,void 0,void 0,void 0,void 0,"Dodecahedron");const e=1/((1+Math.sqrt(5))/2),t=e*e;this.addVertex(new h(-e,-e,-e),new h(-e,-e,e),new h(-e,e,-e),new h(-e,e,e),new h(e,-e,-e),new h(e,-e,e),new h(e,e,-e),new h(e,e,e)),this.addVertex(new h(0,-t,-1),new h(0,-t,1),new h(0,t,-1),new h(0,t,1)),this.addVertex(new h(-t,-1,0),new h(-t,1,0),new h(t,-1,0),new h(t,1,0)),this.addVertex(new h(-1,0,-t),new h(1,0,-t),new h(-1,0,t),new h(1,0,t)),this.addPrimitive(g.buildVertex(3,11),g.buildVertex(11,7),g.buildVertex(7,15),g.buildVertex(15,13),g.buildVertex(13,3)),this.addPrimitive(g.buildVertex(7,19),g.buildVertex(19,17),g.buildVertex(17,6),g.buildVertex(6,15)),this.addPrimitive(g.buildVertex(17,4),g.buildVertex(4,8),g.buildVertex(8,10),g.buildVertex(10,6)),this.addPrimitive(g.buildVertex(8,0),g.buildVertex(0,16),g.buildVertex(16,2),g.buildVertex(2,10)),this.addPrimitive(g.buildVertex(0,12),g.buildVertex(12,1),g.buildVertex(1,18),g.buildVertex(18,16)),this.addPrimitive(g.buildVertex(2,13)),this.addPrimitive(g.buildVertex(18,3)),this.addPrimitive(g.buildVertex(1,9),g.buildVertex(9,11)),this.addPrimitive(g.buildVertex(4,14),g.buildVertex(14,12)),this.addPrimitive(g.buildVertex(9,5),g.buildVertex(5,19)),this.addPrimitive(g.buildVertex(5,14))}}class Z extends r{constructor(){super(void 0,void 0,void 0,void 0,void 0,"Icosahedron");const e=1/((1+Math.sqrt(5))/2);this.addVertex(new h(-e,1,0),new h(e,1,0),new h(-e,-1,0),new h(e,-1,0),new h(0,-e,1),new h(0,e,1),new h(0,-e,-1),new h(0,e,-1),new h(1,0,-e),new h(1,0,e),new h(-1,0,-e),new h(-1,0,e)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(0,5),g.buildVertex(0,7),g.buildVertex(0,11),g.buildVertex(0,10),g.buildVertex(1,5),g.buildVertex(1,7),g.buildVertex(1,9),g.buildVertex(1,8),g.buildVertex(5,11),g.buildVertex(5,9),g.buildVertex(5,4),g.buildVertex(7,10),g.buildVertex(7,8),g.buildVertex(7,6),g.buildVertex(11,10),g.buildVertex(11,4),g.buildVertex(11,2),g.buildVertex(9,8),g.buildVertex(9,4),g.buildVertex(9,3),g.buildVertex(10,6),g.buildVertex(10,2),g.buildVertex(8,6),g.buildVertex(8,3),g.buildVertex(4,2),g.buildVertex(4,3),g.buildVertex(6,2),g.buildVertex(6,3),g.buildVertex(2,3))}}class U extends r{constructor(){super(void 0,void 0,void 0,void 0,void 0,"Icosidodecahedron");const e=(1+Math.sqrt(5))/2-1;this.addVertex(new h(0,0,1.051462),new h(e,0,.8506508),new h(.2763932,.5527864,.8506508),new h(-e,0,.8506508),new h(-.2763932,-.5527864,.8506508),new h(1,0,.3249197),new h(.7236068,-.5527864,.5257311),new h(-.1708204,.8944272,.5257311),new h(.4472136,.8944272,.3249197),new h(-1,0,.3249197),new h(-.7236068,.5527864,.5257311),new h(.1708204,-.8944272,.5257311),new h(-.4472136,-.8944272,.3249197),new h(1,0,-.3249197),new h(.8944272,.5527864,0),new h(.5527864,-.8944272,0),new h(-.5527864,.8944272,0),new h(.4472136,.8944272,-.3249197),new h(-1,0,-.3249197),new h(-.8944272,-.5527864,0),new h(-.4472136,-.8944272,-.3249197),new h(e,0,-.8506508),new h(.7236068,-.5527864,-.5257311),new h(.1708204,-.8944272,-.5257311),new h(-.7236068,.5527864,-.5257311),new h(-.1708204,.8944272,-.5257311),new h(.2763932,.5527864,-.8506508),new h(-e,0,-.8506508),new h(-.2763932,-.5527864,-.8506508),new h(0,0,-1.051462)),this.addPrimitive(g.buildVertex(0,2),g.buildVertex(2,7),g.buildVertex(7,10),g.buildVertex(10,3),g.buildVertex(3,0),g.buildVertex(0,4),g.buildVertex(4,11),g.buildVertex(11,6),g.buildVertex(6,1),g.buildVertex(1,0),g.buildVertex(1,5),g.buildVertex(5,14),g.buildVertex(14,8),g.buildVertex(8,2),g.buildVertex(2,1),g.buildVertex(3,9),g.buildVertex(9,19),g.buildVertex(19,12),g.buildVertex(12,4),g.buildVertex(4,3),g.buildVertex(5,6),g.buildVertex(6,15),g.buildVertex(15,22),g.buildVertex(22,13),g.buildVertex(13,5),g.buildVertex(7,8),g.buildVertex(8,17),g.buildVertex(17,25),g.buildVertex(25,16),g.buildVertex(16,7),g.buildVertex(9,10),g.buildVertex(10,16),g.buildVertex(16,24),g.buildVertex(24,18),g.buildVertex(18,9),g.buildVertex(11,12),g.buildVertex(12,20),g.buildVertex(20,23),g.buildVertex(23,15),g.buildVertex(15,11),g.buildVertex(13,21),g.buildVertex(21,26),g.buildVertex(26,17),g.buildVertex(17,14),g.buildVertex(14,13),g.buildVertex(18,27),g.buildVertex(27,28),g.buildVertex(28,20),g.buildVertex(20,19),g.buildVertex(19,18),g.buildVertex(21,22),g.buildVertex(22,23),g.buildVertex(23,28),g.buildVertex(28,29),g.buildVertex(29,21),g.buildVertex(24,25),g.buildVertex(25,26),g.buildVertex(26,29),g.buildVertex(29,27),g.buildVertex(27,24))}}class K extends r{#W;#D;#$;constructor(e,t=e,o=0,i=0,r=0,n=0){if(super(void 0,void 0,void 0,void 0,void 0,M("Octahedron(%d,%d,%d,%d,%d,%d)",e,t,o,i,r,n)),e<0)throw new Error("n1 must be greater than or equal to 0");if(t<0)throw new Error("n1 must be greater than or equal to 0");if(o<0)throw new Error("n2 must be greater than or equal to 0");if(i<0)throw new Error("n2 must be greater than or equal to 0");if(r<0)throw new Error("n3 must be greater than or equal to 0");if(n<0)throw new Error("n3 must be greater than or equal to 0");this.#W=e,this.#D=o,this.#$=r;const s=new h(1,0,0),l=new h(0,0,-1),a=new h(-1,0,0),d=new h(0,0,1),u=new h(0,1,0),c=new h(0,-1,0);this.addVertex(s,l,a,d,u,c),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0)),this.addPrimitive(g.buildVertex(0,4),g.buildVertex(1,4),g.buildVertex(2,4),g.buildVertex(3,4)),this.addPrimitive(g.buildVertex(0,5),g.buildVertex(1,5),g.buildVertex(2,5),g.buildVertex(3,5)),this.#O(e,4,s,l,a,d),this.#O(t,5,s,l,a,d),this.#O(o,0,d,u,l,c),this.#O(r,1,s,u,a,c),this.#O(i,2,l,u,d,c),this.#O(n,3,a,u,s,c)}#O(e,t,o,i,r,n){for(let r=0;r<e;++r){const n=(r+1)/(e+1),s=(1-n)*o.x+n*i.x,l=(1-n)*o.y+n*i.y,a=(1-n)*o.z+n*i.z,d=new h(s,l,a),u=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,u))}for(let o=0;o<e;++o){const n=(o+1)/(e+1),s=(1-n)*i.x+n*r.x,l=(1-n)*i.y+n*r.y,a=(1-n)*i.z+n*r.z,d=new h(s,l,a),u=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,u))}for(let o=0;o<e;++o){const i=(o+1)/(e+1),s=(1-i)*r.x+i*n.x,l=(1-i)*r.y+i*n.y,a=(1-i)*r.z+i*n.z,d=new h(s,l,a),u=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,u))}for(let i=0;i<e;++i){const r=(i+1)/(e+1),s=(1-r)*n.x+r*o.x,l=(1-r)*n.y+r*o.y,a=(1-r)*n.z+r*o.z,d=new h(s,l,a),u=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,u))}}getHorizCount(){return this.#W}getVertCount(){return this.#D}remake(e,t){return new K(e,e,t,t,this.#$,this.#$)}}class J extends r{#W;#D;#Y;constructor(e=1,t=1,o=1,i=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Tetrahedron(%d,%d,%d,%d)",e,t,o,i)),e<0)throw new Error("m0 must be greater than or equal to 0");if(t<0)throw new Error("m1 must be greater than or equal to 0");if(o<0)throw new Error("m2 must be greater than or equal to 0");if(i<0)throw new Error("m3 must be greater than or equal to 0");this.#W=e,this.#D=t,this.#Y=!1;const r=new h(1,1,1),n=new h(-1,1,-1),s=new h(1,-1,-1),l=new h(-1,-1,1);this.addVertex(r,n,s,l),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(2,3),g.buildVertex(0,2),g.buildVertex(0,3),g.buildVertex(1,2),g.buildVertex(1,3)),this.#j(e,0,n,s,l),this.#j(t,1,r,s,l),this.#j(o,2,r,n,l),this.#j(i,3,r,n,s)}#j(e,t,o,i,r){this.#O(e,t,o,i),this.#O(e,t,i,r),this.#O(e,t,r,o)}#O(e,t,o,i){for(let r=0;r<e;++r){const n=(r+1)/(e+1),s=(1-n)*o.x+n*i.x,l=(1-n)*o.y+n*i.y,a=(1-n)*o.z+n*i.z,d=new h(s,l,a),u=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,u))}}getHorizCount(){return this.#W}getVertCount(){return this.#D}remake(e,t){return new J(e,t,t,e)}}class Q extends r{#I;constructor(e=5){if(super(void 0,void 0,void 0,void 0,void 0,void 0,void 0,M("Sierpinski_Sponge(%d)",e)),e<0)throw new Error("N must be greater than 0");this.#I=e,0==e?(this.addVertex(new h(1,1,1),new h(-1,1,-1),new h(1,-1,-1),new h(-1,-1,1)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(2,3),g.buildVertex(0,2),g.buildVertex(0,3),g.buildVertex(1,2),g.buildVertex(1,3))):this.addNestedModel(this.#X(e-1,1,1,1),this.#X(e-1,-1,1,-1),this.#X(e-1,1,-1,-1),this.#X(e-1,-1,-1,1))}#X(e,t,o,n){const s=r.buildNameMatrix("Sierpinski Sponge: level "+e+"("+t+", "+o+", "+n+",",i.translate(.5*t,.5*o,.5*n).timesMatrix(i.scale(.5)));return 0==e?(s.addVertex(new h(1,1,1),new h(-1,1,-1),new h(1,-1,-1),new h(-1,-1,1)),s.addPrimitive(g.buildVertex(0,1),g.buildVertex(2,3),g.buildVertex(0,2),g.buildVertex(0,3),g.buildVertex(1,2),g.buildVertex(1,3))):s.addNestedModel(this.#X(e-1,1,1,1),this.#X(e-1,-1,1,-1),this.#X(e-1,1,-1,-1),this.#X(e-1,-1,-1,1)),s}getHorzCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=t;return e!=this.#I&&(o=e),new Q(o)}}class ee extends r{#I;constructor(e=7){if(super(void 0,void 0,void 0,void 0,void 0,void 0,void 0,M("Sierpinski_Triangle(%d)",e)),e<0)throw new Error("N must be greater than 0");this.#I=e,0==e?(this.addVertex(new h(1,0,0),new h(-.5,.866,0),new h(-.5,-.866,0)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0))):this.addNestedModel(this.#Z(e-1,.5,0),this.#Z(e-1,-.25,.433),this.#Z(e-1,-.25,-.433))}#Z(e,t,o){const n=r.buildNameMatrix("Sierpinski Triangle: level "+e+"("+t+", "+o+")",i.translate(t,o,0).timesMatrix(i.scale(.5)));return 0==e?(n.addVertex(new h(1,0,0),new h(-.5,.866,0),new h(-.5,-.866,0)),n.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0))):n.addNestedModel(this.#Z(e-1,.5,0),this.#Z(e-1,-.25,.433),this.#Z(e-1,-.25,-.433)),n}getHorzCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=t;return e!=this.#I&&(o=e),new ee(o)}}class te extends r{constructor(e=-1,t=1,o=-1,i=1,r=0){super(void 0,void 0,void 0,void 0,void 0,"PanelXY");const n=new Array(t-e+1);for(let e=0;e<n.length;e+=1)n[e]=new Array(i-o+1);let s=0;for(let l=e;l<=t;++l)for(let t=o;t<=i;++t)this.addVertex(new h(l,t,r)),n[l-e][t-o]=s,++s;for(let r=0;r<=t-e;++r)for(let e=0;e<i-o;++e)this.addPrimitive(g.buildVertex(n[r][e],n[r][e+1]));for(let r=0;r<=i-o;++r)for(let o=0;o<t-e;++o)this.addPrimitive(g.buildVertex(n[o][r],n[o+1][r]))}}class oe extends r{constructor(e=-1,t=1,o=-1,i=1,r=0){super(void 0,void 0,void 0,void 0,void 0,"PanelXZ");const n=new Array(t-e+1);for(let e=0;e<n.length;e+=1)n[e]=new Array(i-o+1);let s=0;for(let l=e;l<=t;++l)for(let t=o;t<=i;++t)this.addVertex(new h(l,r,t)),n[l-e][t-o]=s,++s;for(let r=0;r<=t-e;++r)for(let e=0;e<i-o;++e)this.addPrimitive(g.buildVertex(n[r][e],n[r][e+1]));for(let r=0;r<=i-o;++r)for(let o=0;o<t-e;++o)this.addPrimitive(g.buildVertex(n[o][r],n[o+1][r]))}}class ie extends r{constructor(e=-1,t=1,o=-1,i=1,r=0){super(void 0,void 0,void 0,void 0,void 0,"PanelYZ");const n=new Array(t-e+1);for(let e=0;e<n.length;e+=1)n[e]=new Array(i-o+1);let s=0;for(let l=e;l<=t;++l)for(let t=o;t<=i;++t)this.addVertex(new h(r,l,t)),n[l-e][t-o]=s,++s;for(let r=0;r<=t-e;++r)for(let e=0;e<i-o;++e)this.addPrimitive(g.buildVertex(n[r][e],n[r][e+1]));for(let r=0;r<=i-o;++r)for(let o=0;o<t-e;++o)this.addPrimitive(g.buildVertex(n[o][r],n[o+1][r]))}}class re extends r{static x(e){return.5*Math.sin(e)+Math.sin(2*e)}static y(e){return.5*Math.cos(e)+Math.cos(2*e)}static z(e){return-.5*Math.sin(3*e)}#U;#K;#I;#J;#Q;#ee;constructor(e=re.x,t=re.y,o=re.z,i=0,r=2*Math.PI,n=60){if("number"!=typeof i||"number"!=typeof r||"number"!=typeof n)throw new Error("T1, T2, and N must be numerical");if("function"!=typeof e||"function"!=typeof t||"function"!=typeof o)throw new Error("Xfunc, yFunc, and zFunc must be functions and take 1 parameter");super(void 0,void 0,void 0,void 0,void 0,M("Parametric Curve(%d)",n)),this.#U=i,this.#K=r,this.#I=n,this.#J=e,this.#Q=t,this.#ee=o;const s=(r-i)/n;for(let r=0;r<=n;r+=1)this.addVertex(new h(e(i+r*s),t(i+r*s),o(i+r*s)));for(let e=0;e<n;e+=1)this.addPrimitive(g.buildVertex(e,e+1))}getHorizCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=t;return this.#I!=e&&(o=e),new re(this.#J,this.#Q,this.#ee,this.#U,this.#K,o)}}class ne extends r{static x(e,t){return Math.sin(Math.PI*e)*Math.sin(Math.PI*t)}static y(e,t){return Math.sin(Math.PI*e)*Math.sin(Math.PI*t)}static z(e,t){return Math.sin(Math.PI*e)*Math.sin(Math.PI*t)}#te;#oe;#U;#K;#I;#G;#J;#Q;#ee;constructor(e=ne.x,t=ne.y,o=ne.z,i=-1,r=1,n=-1,s=1,l=49,a=49){if("function"!=typeof e||"function"!=typeof t||"function"!=typeof o)throw new Error("xfunc, yfunc, zfunc are supposed to be functions");if("number"!=typeof i||"number"!=typeof r||"number"!=typeof n||"number"!=typeof s||"number"!=typeof l||"number"!=typeof a)throw new Error("S1, S2, T1, T2, N and K must be numerical");if(super(void 0,void 0,void 0,void 0,void 0,M("Parametric Surface(%d,%d)",l,a)),l<2)throw new Error("n must be greater than 1");if(a<2)throw new Error("k must be greater than 1");this.#J=e,this.#Q=t,this.#ee=o,this.#te=i,this.#oe=r,this.#U=n,this.#K=s,this.#I=l,this.#G=a;const d=(r-i)/(l-1),u=(s-n)/(a-1),c=new Array(l);for(let e=0;e<c.length;e+=1)c[e]=new Array(a);for(let r=0;r<l;++r)for(let s=0;s<a;++s)c[r][s]=new h(e(i+r*d,n+s*u),t(i+r*d,n+s*u),o(i+r*d,n+s*u));for(let e=0;e<l;++e)for(let t=0;t<a;++t)this.addVertex(c[e][t]);for(let e=0;e<l;++e)for(let t=0;t<a-1;++t)this.addPrimitive(g.buildVertex(e*a+t,e*a+(t+1)));for(let e=0;e<a;++e)for(let t=0;t<l-1;++t)this.addPrimitive(g.buildVertex(t*a+e,(t+1)*a+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new ne(this.#J,this.#Q,this.#ee,this.#te,this.#oe,this.#U,this.#K,e,t)}}class se extends ne{static x(e,t){return.5*(1+Math.cos(Math.PI*e))*Math.cos(t)}static y(e,t){return.5*(1+Math.cos(Math.PI*e))*Math.sin(t)}static z(e,t){return.5*(1+Math.cos(Math.PI*e))}constructor(e=se.x,t=se.y,o=se.z,i=-1,r=1,n=0,s=2*Math.PI,l=49,a=49){super(e,t,o,i,r,n,s,l,a),this.name=M("SurfaceOfRevolution(%d,%d)",l,a)}}class le extends r{#ie;#T;#I;#G;constructor(e=2,t=1,o=15,i=4,r=!1){if(super(void 0,void 0,void 0,void 0,void 0,M("Pyramid(%.2f,%.2f,%d,%d)",e,t,o,i)),o<1)throw new Error("n must be greater than 0");if(i<1)throw new Error("k must be greater than 0");this.#ie=e,this.#T=t,this.#I=o,this.#G=i,this.addVertex(new h(0,t,0));let n=1;const s=2*(e/=2)/i;for(let t=0;t<i+1;++t){const o=t*s;r?this.addVertex(new h(-e+o,0,-e),new h(-e+o,0,e)):this.addVertex(new h(-e+o,0,-e),new h(e-o,0,e)),this.addPrimitive(g.buildVertex(0,n+0),g.buildVertex(n+0,n+1),g.buildVertex(n+1,0)),n+=2}for(let t=1;t<i;++t){const o=t*s;r?this.addVertex(new h(e,0,-e+o),new h(-e,0,-e+o)):this.addVertex(new h(e,0,-e+o),new h(-e,0,e-o)),this.addPrimitive(g.buildVertex(0,n+0),g.buildVertex(n+0,n+1),g.buildVertex(n+1,0)),n+=2}const l=t/o,a=e/o;for(let i=0;i<o;++i)t=i*l,this.addVertex(new h(e,t,e),new h(e,t,-e),new h(-e,t,-e),new h(-e,t,e)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),e-=a,n+=4}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new le(this.#ie,this.#T,e,t)}}class ae extends r{#te;#oe;#T;#I;#G;constructor(e=2,t=1,o=.5,i=7,r=4){if(super(void 0,void 0,void 0,void 0,void 0,M("Pyramid Frustum(%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r)),i<0)throw new Error("n must be greater than or equal to 0");if(r<1)throw new Error("k must be greater than 0");this.#te=e,this.#oe=t,this.#T=o,this.#I=i,this.#G=r;let n=0;const s=2*(e/=2)/r,l=2*(t/=2)/r;for(let i=0;i<=r;++i){const r=i*s,a=i*l;this.addVertex(new h(-t+a,o,-t),new h(-e+r,0,-e),new h(-e+r,0,e),new h(-t+a,o,t)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),n+=4}for(let i=0;i<=r;++i){const r=i*s,a=i*l;this.addVertex(new h(t,o,-t+a),new h(e,0,-e+r),new h(-e,0,-e+r),new h(-t,o,-t+a)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),n+=4}const a=o/(i+1),d=(e-t)/(i+1);let u=e;for(let e=0;e<=i;++e)o=e*a,this.addVertex(new h(u,o,u),new h(u,o,-u),new h(-u,o,-u),new h(-u,o,u)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),u-=d,n+=4}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new ae(this.#te,this.#oe,this.#T,e,t)}}class de extends r{#q;#R;#_;#k;#I;#G;constructor(e=1,t=.33,o=0,i=Math.PI,r=5,n=7){if(super(void 0,void 0,void 0,void 0,void 0,M("Ring Sector(%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r,n)),r<2)throw new Error("n must be greater than 1");if(n<4)throw new Error("k must be greater than 3");o%=2*Math.PI,i%=2*Math.PI,o<0&&(o=2*Math.PI+o),i<0&&(i=2*Math.PI+i),i<=o&&(i+=2*Math.PI),this.#q=e,this.#R=t,this.#_=o,this.#k=i,this.#I=r,this.#G=n;const s=(e-t)/(r-1),l=(i-o)/(n-1),a=new Array(r);for(let e=0;e<a.length;e+=1)a[e]=new Array(n);for(let e=0;e<n;++e){const i=Math.cos(o+e*l),n=Math.sin(o+e*l);for(let o=0;o<r;++o){const r=t+o*s;a[o][e]=new h(r*i,r*n,0)}}for(let e=0;e<r;++e)for(let t=0;t<n;++t)this.addVertex(a[e][t]);for(let e=0;e<r;++e)for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(e*n+t,e*n+(t+1)));for(let e=0;e<n;++e)for(let t=0;t<r-1;++t)this.addPrimitive(g.buildVertex(t*n+e,(t+1)*n+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new de(this.#q,this.#R,this.#_,this.#k,e,t)}}class he extends de{constructor(e=1,t=.33,o=4,i=12){super(e,t,0,2*Math.PI,o,i),this.name=M("Ring(%.2f,%.2f,%d,%d)",e,t,o,i)}}class ue extends r{constructor(e=4,t=!1,o=!1){if(super(void 0,void 0,void 0,void 0,void 0,M("Sphere Subdivided(%d)",e)),e<0)throw new Error("n must be greater than or equal to 0");const i=1/Math.sqrt(3),r=new h(i,i,i),n=new h(-i,i,-i),s=new h(i,-i,-i),l=new h(-i,-i,i);this.#re(e,r,n,s,o),this.#re(e,n,l,s,o),this.#re(e,s,l,r,o),t||this.#re(e,l,n,r,o)}#re(e,t,o,i,r){if(!(e>=0))throw new Error;if(0==e){const e=this.vertexList.length;this.addVertex(t,o,i),this.addPrimitive(g.buildVertex(e+0,e+1),g.buildVertex(e+1,e+2),g.buildVertex(e+2,e+0))}else{const n=new h(.5*(t.x+o.x),.5*(t.y+o.y),.5*(t.z+o.z)),s=new h(.5*(o.x+i.x),.5*(o.y+i.y),.5*(o.z+i.z)),l=new h(.5*(i.x+t.x),.5*(i.y+t.y),.5*(i.z+t.z)),a=Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z),d=Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z),u=Math.sqrt(l.x*l.x+l.y*l.y+l.z*l.z),c=new h(n.x/a,n.y/a,n.z/a),g=new h(s.x/d,s.y/d,s.z/d),f=new h(l.x/u,l.y/u,l.z/u);this.#re(e-1,t,c,f,r),this.#re(e-1,f,g,i,r),this.#re(e-1,c,o,g,r),r||this.#re(e-1,c,g,f,r)}}}class ce extends r{#F;#_;#k;#ne;#se;#I;#G;constructor(e=1,t=Math.PI/2,o=3*Math.PI/2,i=0,r=Math.PI,n=17,s=8){if(super(void 0,void 0,void 0,void 0,void 0,M("Sphere Sector(%.2f,%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r,n,s)),n<3)throw new Error("n must be greater than 2");if(s<4)throw new Error("k must be greater than 3");t%=2*Math.PI,o%=2*Math.PI,t<0&&(t=2*Math.PI+t),o<0&&(o=2*Math.PI+o),o<=t&&(o+=2*Math.PI),this.#F=e,this.#_=t,this.#k=o,this.#ne=i,this.#se=r,this.#I=n,this.#G=s;const l=(r-i)/(n-1),a=(o-t)/(s-1),d=new Array(n);for(let e=0;e<d.length;e+=1)d[e]=new Array(s);for(let o=0;o<s;++o){const r=Math.cos(t+o*a),s=Math.sin(t+o*a);for(let t=0;t<n;++t){const n=Math.cos(i+t*l),a=Math.sin(i+t*l);d[t][o]=new h(e*a*r,e*n,-e*a*s)}}for(let e=0;e<n;++e)for(let t=0;t<s;++t)this.addVertex(d[e][t]);for(let e=0;e<n;++e)for(let t=0;t<s-1;++t)this.addPrimitive(g.buildVertex(e*s+t,e*s+(t+1)));for(let e=0;e<s;++e)for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(t*s+e,(t+1)*s+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new ce(this.#F,this.#_,this.#k,this.#ne,this.#se,e,t)}}class ge extends ce{constructor(e=1,t=15,o=16){super(e,0,2*Math.PI,0,2*Math.PI,t,o),this.name=M("Sphere(%.2f,%d,%d)",e,t,o)}}class fe extends r{constructor(e=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Square(%.2f)",e)),e<=0)throw new Error("r must be greater than 0");this.addVertex(new h(-e,-e,0),new h(-e,e,0),new h(e,e,0),new h(e,-e,0)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0))}}class me extends r{#F;#I;#G;constructor(e=1,t=1,o=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Square Grid(%.2f,%d,%d)",e,t,o)),t<0)throw new Error("n must be greater than or equal to 0");if(o<0)throw new Error("k must be greater than or equal to 0");if(e<=0)throw new Error("r must be greater than 0");this.#F=e,this.#I=t,this.#G=o;const i=2*e/(1+o),r=2*e/(1+t),n=new Array(t+2);for(let e=0;e<n.length;e+=1)n[e]=new Array(o+2);for(let s=0;s<=t+1;++s)for(let t=0;t<=o+1;++t)n[s][t]=new h(e-t*i,s*r-e,0);for(let e=0;e<t+2;++e)for(let t=0;t<o+2;++t)this.addVertex(n[e][t]);for(let e=0;e<t+2;++e)for(let t=0;t<o+1;++t)this.addPrimitive(g.buildVertex(e*(o+2)+t,e*(o+2)+(t+1)));for(let e=0;e<o+2;++e)for(let i=0;i<t+1;++i)this.addPrimitive(g.buildVertex(i*(o+2)+e,(i+1)*(o+2)+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new me(this.#F,e,t)}}class we extends r{#q;#R;#_;#k;#ne;#se;#I;#G;constructor(e=.75,t=.25,o=Math.PI/2,i=3*Math.PI/2,r=Math.PI,n=2*Math.PI,s=6,l=8){if(super(void 0,void 0,void 0,void 0,void 0,M("Torus Sector(%.2f,%.2f,%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,i,r,n,s,l)),s<4)throw new Error("n must be greater than 3");if(l<4)throw new Error("k must be greater than 3");this.#q=e,this.#R=t,this.#_=o,this.#k=i,this.#ne=r,this.#se=n,this.#I=s,this.#G=l;const a=(n-r)/(s-1),d=(i-o)/(l-1),u=new Array(s);for(let e=0;e<u.length;e+=1)u[e]=new Array(l);for(let i=0;i<l;++i){const n=Math.cos(o+i*d),l=Math.sin(o+i*d);for(let o=0;o<s;++o){const s=Math.cos(r+o*a),d=Math.sin(r+o*a);u[o][i]=new h((e+t*d)*n,t*s,-(e+t*d)*l)}}for(let e=0;e<s;++e)for(let t=0;t<l;++t)this.addVertex(u[e][t]);for(let e=0;e<l;++e)for(let t=0;t<s-1;++t)this.addPrimitive(g.buildVertex(t*l+e,(t+1)*l+e));for(let e=0;e<s;++e)for(let t=0;t<l-1;++t)this.addPrimitive(g.buildVertex(e*l+t,e*l+(t+1)))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new we(this.#q,this.#R,this.#_,this.#k,this.#ne,this.#se,e,t)}}class xe extends we{constructor(e=.75,t=.25,o=12,i=16){super(e,t,0,2*Math.PI,0,2*Math.PI,o,i),this.name=M("Torus(%.2f,%.2f,%d,%d)",e,t,o,i)}}class be extends r{constructor(e=.5,t=.6,o=e*Math.tan(Math.atan(Math.sqrt(2))),i=3,r=!0){if(super(void 0,void 0,void 0,void 0,void 0,M("Triangular Prism(%.2f,%.2f,%.2f,%d)",e,t,t,i)),i<0)throw new Error("n must be greater than or equal to 0");const n=Math.sqrt(3);let s,l,a,d,u,c,f,m;s=new h(e,t,0),l=new h(-e/2,t,.5*e*n),a=new h(-e/2,t,.5*-e*n),r?(d=new h(e,-t,0),u=new h(-e/2,-t,.5*e*n),c=new h(-e/2,-t,.5*-e*n)):(d=new h(e,0,0),u=new h(-e/2,0,.5*e*n),c=new h(-e/2,0,.5*-e*n)),f=new h(0,t+o,0),m=new h(0,r?-t-o:0,0),this.addVertex(s,l,a,d,u,c,f,m);let w=8;if(this.addPrimitive(g.buildVertex(6,0),g.buildVertex(6,1),g.buildVertex(6,2)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0)),this.addPrimitive(g.buildVertex(0,3),g.buildVertex(1,4),g.buildVertex(2,5)),this.addPrimitive(g.buildVertex(3,4),g.buildVertex(4,5),g.buildVertex(5,3)),this.addPrimitive(g.buildVertex(7,3),g.buildVertex(7,4),g.buildVertex(7,5)),i>0){let o=2*t/(i+1);r||(o=t/(i+1));for(let s=0;s<i;++s){let i=(s+1)*o-t;r||(i=(s+1)*o),this.addVertex(new h(e,i,0),new h(-e/2,i,.5*e*n),new h(-e/2,i,.5*-e*n)),this.addPrimitive(g.buildVertex(w+0,w+1),g.buildVertex(w+1,w+2),g.buildVertex(w+2,w+0)),w+=3}}}}class ve extends r{#F;#T;#I;#G;constructor(e=Math.sqrt(3)/Math.sqrt(2)/Math.sqrt(3),t=Math.sqrt(3)/Math.sqrt(2)*(Math.sqrt(2)/Math.sqrt(3)),o=1,i=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Triangular_Pyramid(%.2f,%.2f,%d,%d)",e,t,o,i)),o<1)throw new Error("n must be greater than 0");if(i<1)throw new Error("k must be greater than 0");this.#F=e,this.#T=t,this.#I=o,this.#G=i;const r=new h(0,t,0),n=new h(0,0,0);this.addVertex(r,n);let s=2;const l=Math.sqrt(3),a=new h(e,0,0),d=new h(-e/2,0,.5*e*l),u=new h(-e/2,0,.5*-e*l);for(let e=0;e<i;++e){const t=e*(1/i);this.addVertex(new h((1-t)*a.x+t*d.x,(1-t)*a.y+t*d.y,(1-t)*a.z+t*d.z)),this.addVertex(new h((1-t)*d.x+t*u.x,(1-t)*d.y+t*u.y,(1-t)*d.z+t*u.z)),this.addVertex(new h((1-t)*u.x+t*a.x,(1-t)*u.y+t*a.y,(1-t)*u.z+t*a.z)),this.addPrimitive(g.buildVertex(0,s+0),g.buildVertex(s+0,1)),this.addPrimitive(g.buildVertex(0,s+1),g.buildVertex(s+1,1)),this.addPrimitive(g.buildVertex(0,s+2),g.buildVertex(s+2,1)),s+=3}for(let e=0;e<o;++e){const t=e*(1/o);this.addVertex(new h((1-t)*a.x+t*r.x,(1-t)*a.y+t*r.y,(1-t)*a.z+t*r.z)),this.addVertex(new h((1-t)*d.x+t*r.x,(1-t)*d.y+t*r.y,(1-t)*d.z+t*r.z)),this.addVertex(new h((1-t)*u.x+t*r.x,(1-t)*u.y+t*r.y,(1-t)*u.z+t*r.z)),this.addPrimitive(g.buildVertex(s+0,s+1),g.buildVertex(s+1,s+2),g.buildVertex(s+2,s+0)),s+=3}}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new ve(this.#F,this.#T,e,t)}}class pe extends r{constructor(e=-.25,t=.25,o=-.25,i=.25,r=.25,n=1){super(void 0,void 0,void 0,void 0,void 0,"View Frustum Model"),this.addVertex(new h(e,i,-r),new h(t,i,-r),new h(t,o,-r),new h(e,o,-r),new h(e/r*n,i/r*n,-n),new h(t/r*n,i/r*n,-n),new h(t/r*n,o/r*n,-n),new h(e/r*n,o/r*n,-n)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0)),this.addPrimitive(g.buildVertex(4,5),g.buildVertex(5,6),g.buildVertex(6,7),g.buildVertex(7,4)),this.addPrimitive(g.buildVertex(0,4),g.buildVertex(1,5),g.buildVertex(2,6),g.buildVertex(3,7))}static BuildViewFrustumModel(e,t,o,i){return new pe(-o*Math.tan(Math.PI/180*e/2)*t,o*Math.tan(Math.PI/180*e/2)*t,-o*Math.tan(Math.PI/180*e/2),o*Math.tan(Math.PI/180*e/2),o,i)}}async function Ve(e){if("string"!=typeof e)throw new Error("Filename must be a string and include the path");const t=new r(void 0,void 0,void 0,void 0,void 0,"GRS Model: "+e.substring(e.lastIndexOf("/")+1,e.length));let o,i=new XMLHttpRequest;if(i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(o=i.responseText)},i.open("GET",e,!1),i.send(),null==o)throw new Error("Unable to access file");{let e=o.split("\n"),i=0;for(;!e[i].startsWith("*");)i++;i++;let r=e[i].split(/ +/);parseFloat(r[0]),parseFloat(r[1]),parseFloat(r[2]),parseFloat(r[3]),i++;const n=parseInt(e[i]);i++;let s=-1;for(let o=0;o<n;o++){let o=parseInt(e[i]);i++;let r=e[i].split(/ +/),n=parseFloat(r[1]),l=parseFloat(r[2]);t.addVertex(new h(n,l,0)),s++,i++;for(let a=1;a<o;a++)r=e[i].split(/ +/),n=parseFloat(r[1]),l=parseFloat(r[2]),t.addVertex(new h(n,l,0)),s++,t.addPrimitive(g.buildVertex(s-1,s)),i++}}return t}async function ye(e){if("string"!=typeof e)throw new Error("Filename must be a string including the path");const t=new r(void 0,void 0,void 0,void 0,void 0,"OBJ Model: "+e.substring(e.lastIndexOf("/")+1,e.length));let o,i=new XMLHttpRequest;if(i.onreadystatechange=function(){4==this.readyState&&200==this.status&&(o=i.responseText)},i.open("GET",e,!1),i.send(),null==o)throw new Error("Unable to read the file");{let e=o.split("\n");for(let o of e)if(!(o.startsWith("#")||o.startsWith("vt")||o.startsWith("vn")||o.startsWith("s")||o.startsWith("g")||o.startsWith("o")||o.startsWith("usemtl")||o.startsWith("mtllib")))if(o.startsWith("v")){let e=o.split(/ +/g);t.addVertex(new h(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])))}else if(o.startsWith("f")){let e=o.split(/ +/);e.shift();let i=[];for(let t=0;t<3;t++){let o=e.shift().split("/");i[t]=parseInt(o[0])-1}for(t.addPrimitive(g.buildVertex(i[0],i[1]),g.buildVertex(i[1],i[2]));0!=e.length;){i[1]=i[2];let o=e.shift().split("/");i[2]=parseInt(o[0])-1,t.addPrimitive(g.buildVertex(i[1],i[2]))}t.addPrimitive(g.buildVertex(i[2],i[0]))}}return t}function Me(e,t){const o=t.vIndexList[0],i=t.vIndexList[1],r=e.vertexList[o],n=e.vertexList[i],s=r.x,l=r.y,a=n.x,d=n.y;return Math.abs(s)>1||Math.abs(l)>1||Math.abs(a)>1||Math.abs(d)>1?s>1&&a>1||s<-1&&a<-1||l>1&&d>1||l<-1&&d<-1?void(Ce&&De("-- Trivial delete.")):Me(e,function(e,t){const o=t.vIndexList[0],i=t.vIndexList[1],r=e.vertexList[o],n=e.vertexList[i],s=r.x,l=r.y,a=n.x,d=n.y;let u,c,f,m,w,x,b,v,p,V="";s>1?(V="x = +1",u=0,c=s,f=l,m=a,w=d,x=(1-c)/(m-c),b=1,v=(1-x)*f+x*w):a>1?(V="x = +1",u=1,c=a,f=d,m=s,w=l,x=(1-c)/(m-c),b=1,v=(1-x)*f+x*w):s<-1?(V="x = -1",u=0,c=s,f=l,m=a,w=d,x=(-1-c)/(m-c),b=-1,v=(1-x)*f+x*w):a<-1?(V="x = -1",u=1,m=s,w=l,c=a,f=d,x=(-1-c)/(m-c),b=-1,v=(1-x)*f+x*w):l>1?(V="y = +1",u=0,c=s,f=l,m=a,w=d,x=(1-f)/(w-f),b=(1-x)*c+x*m,v=1):d>1?(V="y = +1",u=1,m=s,w=l,c=a,f=d,x=(1-f)/(w-f),b=(1-x)*c+x*m,v=1):l<-1?(V="y = -1",u=0,c=s,f=l,m=a,w=d,x=(-1-f)/(w-f),b=(1-x)*c+x*m,v=-1):(V="y = -1",u=1,m=s,w=l,c=a,f=d,x=(-1-f)/(w-f),b=(1-x)*c+x*m,v=-1);let y=new h(b,v,0);p=e.vertexList.length,e.addVertex(y);let P,C=t.cIndexList[1-u],L=t.cIndexList[u],E=e.colorList[C].getRGBComponents(),S=e.colorList[L].getRGBComponents(),z=x,N=(1-z)*S[0]+z*E[0],B=(1-z)*S[1]+z*E[1],I=(1-z)*S[2]+z*E[2],F=new A(N,B,I),_=e.colorList.length;if(e.addColor(F),Ce){let e="";e=0==u?"v0":"v1",De(M("-- Clip off %s at %s",e,V)),De(M("-- t = %.25f",x)),De(M("-- <x_i, y_i> = <%.24f, %.24f>",m,w)),De(M("-- <x_o, y_o> = <%.24f, %.24f>",c,f)),De(M("-- <x_c, y_c> = <%.24f, %.24f>",b,v)),De(M("-- <r_i, g_i, b_i> = <%.15f,  %.15f,  %.15f>",E[0],E[1],E[2])),De(M("-- <r_o, g_o, b_o> = <%.15f,  %.15f,  %.15f>",S[0],S[1],S[2])),De(M("-- <r_c, g_c, b_c> = <%.15f,  %.15f,  %.15f>",N,B,I))}return P=1==u?g.buildVertexColors(o,p,C,_):g.buildVertexColors(p,i,_,C),P}(e,t)):(Ce&&De("-- Trivial accept."),t)}function Pe(e,t){let o;const i=t.vIndexList[0],r=e.vertexList[i],n=r.x,s=r.y;return Math.abs(n)>1||Math.abs(s)>1||(o=t),o}var Ce=!1;function Le(e){const t=Array.from(e.colorList),o=new r(e.vertexList,e.primitiveList,t,e.matrix,e.nestedModels,e.name,e.visible),i=new Array;for(const e of o.primitiveList){let t;je("5. Clipping",o,e),t=e instanceof g?Me(o,e):Pe(o,e),null!=t?(i.push(t),je("5. Clipped (accept)",o,t)):je("5. Clipped (reject)",o,e)}return new r(o.vertexList,i,o.colorList,o.matrix,o.nestedModels,o.name,o.visible)}function Ee(e){De("==== 6. Render position: "+e.name+" ====");const t=l.buildFromModelName(e.model,e.name);e.model.visible?t.model=Se(e.model):De("====== 6. Hidden model: "+e.model.name+" ======");for(const o of e.nestedPositions)t.addNestedPosition(Ee(o));return De("==== 6. End position: "+e.name+" ===="),t}function Se(e){De("==== 6. Clip Model: "+e.name+" ====");const t=Le(e);$e("6. clipped  ",t),Oe("6. Clipped  ",t),Ye("6. Clipped  ",t);const o=new Array;for(const t of e.nestedModels)o.push(Se(t));return De("==== 6. End Model: "+t.name+" ===="),new r(t.vertexList,t.primitiveList,t.colorList,t.matrix,o,t.name,t.visible)}function ze(e){Ce=e}function Ae(e,t){const o=e.model,i=o.vertexList.map((e=>t.timesVertex(e)));return new r(i,o.primitiveList,o.colorList,o.matrix,o.nestedModels,e.name+"::"+o.name,o.visible)}function Ne(){}let Be,Ie,Fe,_e,ke,qe,Re=A.white;function Te(e,t){if(t instanceof S==0)throw new Error("FB must be a framebuffer");Ge(e,t.vp)}function Ge(e,t){Je(e.debug),De("\n= Begin Rendering of Scene (Pipeline 2): "+e.name+" ="),De("- Current Camera:\n"+e.camera),Be=a.buildFromCameraName(e.camera,e.name),De("== 1. Begin model-to-world transformation of Scene ====");for(const t of e.positionList)Qe(t.debug),t.visible?Be.addPosition(tt(t,i.identity())):De("==== 1. Hidden Position: "+t.name+" ====");De("== 1. End model-to-world transformation of Scene ===="),Ie=a.buildFromCameraName(e.camera,e.name),De("== 2. Begin world-to-view transformation of Scene ====");for(const t of Be.positionList)Ie.addPosition(rt(t,e.camera));De("== 2. End world-to-view transformation of Scene ===="),Fe=a.buildFromCameraName(e.camera,e.name),De("== 3. Begin view-to-camera transformation of Scene ====");for(const t of Ie.positionList)Fe.addPosition(kt(t,e.camera));De("== 3. End view-to-camera transformation of SCene ===="),_e=a.buildFromCameraName(e.camera,e.name),De("== 4. Begin newar-plane clipping of Scene ====");for(const t of Fe.positionList)_e.addPosition(ut(t,e.camera));De("== 4. End near plane clipping of Scene ===="),ke=a.buildFromCameraName(e.camera,e.name),De("== 5. Begin projection transformation of Scene ====");for(const t of _e.positionList)ke.addPosition(Vt(t,e.camera));De("== 5. End projection transformation of Scene ===="),qe=a.buildFromCameraName(e.camera,e.name),De("== 6. Begin primitive clipping of Scene ====");for(const e of ke.positionList)qe.addPosition(Ee(e));De("== 6. End primitive clipping of Scene ===="),De("== 7. Begin primitive rasterization of Scene ====");for(const e of qe.positionList)At(e,t);De("== 7. End primitive rasterization of Scene ===="),De("= End Rendering of Scene (Pipeline 2) =")}let He=!1,We=!1;function De(e){(He||We)&&console.log(e)}function $e(e,t){if(He||We){let o=0;for(const i of t.vertexList)console.log(e+": vIndex = "+o+", "+i.toString()+"\n"),o+=1}}function Oe(e,t){if(He||We){let o=0;for(const i of t.colorList)console.log(e+": cIndex = "+o+", "+i.toString()+"\n"),o+=1}}function Ye(e,t){if(He||We)if(0==t.primitiveList.length)console.log(e+": []\n");else for(const o of t.primitiveList)console.log(e+": "+o.toString()+"\n")}function je(e,t,o){if(He||We){console.log(e+": "+o.toString()+"/n");for(const e of o.vIndexList){const o=t.vertexList[e];console.log("   vIndex = "+e+", "+o.toString()+"\n")}for(const e of o.cIndexList){const o=t.colorList[e];console.log("   cIndex = "+e+", "+o.toString()+"\n")}}}function Xe(e,t,o,i,r,n,s,l,a){if(He||We){let d=a.width,h=a.height,u=a.vp_ul_x,c=a.vp_ul_y,g=a.getFrameBuffer(),f=g.width,m=g.height;console.log(M("fb_[w=%d,h=%d] vp_[x=%4d, y=%4d, w=%d,h=%d]  (x_pp=%9.4f, y_pp=%9.4f)  (x_vp=%4d, y_vp=%4d)  r=%.4f g=%.4f b=%.4f",f,m,u,c,d,h,t,o,i,r,n,s,l)),console.log(e)}}function Ze(e,t,o,i,r,n,s,l){Xe("",e,t,o,i,r,n,s,l)}function Ue(e,t,o,i,r,n,s,l,a,d,h,u){if(He||We){const c=u.width,g=u.height,f=u.vp_ul_x,m=u.vp_ul_y,w=u.getFrameBuffer(),x=w.width,b=w.height;console.log(M("fb_[w=%d,h=%d] vp_[x=%4d, y=%4d, w=%d,h=%d]  (x_pp=%4d, y_pp=%9.4f)  x_vp=%4d {y_low=%4d r=%.4f g=%.4f b=%.4f} {y_hi =%4d r=%.4f g=%.4f b=%.4f}\n",x,b,f,m,c,g,e,t,o,i,n,s,l,r,a,d,h))}}function Ke(e,t,o,i,r,n,s,l,a,d,h,u){if(He||We){const c=u.width,g=u.height,f=u.vp_ul_x,m=u.vp_ul_y,w=u.getFrameBuffer(),x=w.width,b=w.height;console.log(M("fb_[w=%d,h=%d] vp_[x=%4d, y=%4d, w=%d,h=%d]  (x_pp=%9.4f, y_pp=%4d)  y_vp=%4d {x_low=%4d r=%.4f g=%.4f b=%.4f} {x_hi =%4d r=%.4f g=%.4f b=%.4f}\n",x,b,f,m,c,g,e,t,r,o,n,s,l,i,a,d,h))}}function Je(e){He=e}function Qe(e){We=e}function et(e,t){const o=new Array;for(const i of e.vertexList)o.push(t.timesVertex(i));return new r(o,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function tt(e,t){De("==== 1. Render position: "+e.name+" ===="),De("---- Transformation matrix: \n"+e.matrix.toString());const o=t.timesMatrix(e.matrix);let i=l.buildFromModelName(e.model,e.name);e.model.visible?i.model=ot(e.model,o):(De("====== 1. Hidden model: "+e.model.name+" ======"),i=l.buildFromModelName(e.model,e.name));for(const t of e.nestedPositions)if(t.visible){const e=tt(t,o);i.addNestedPosition(e)}else De("==== 1. Hidden position: "+t.name+" ====");return De("==== 1. End position: "+e.name+" ===="),i}function ot(e,t){if(De("====== 1. Modeltoworld transformation of: "+e.name+" ======"),f(e),0==e.colorList.length&&0!=e.vertexList.length){for(let t=0;t<e.vertexList.length;++t)e.addColor(Re);console.log("***WARNING: Added default color to model: "+e.name+".")}$e("0. Model    ",e);const o=t.timesMatrix(e.matrix),n=et(e,o);$e("1. World    ",n);const s=new Array;for(const t of e.nestedModels)t.visible?s.push(ot(t,o)):De("====== 1. Hidden model: "+t.name+" ======");return De("====== 1. End Model: "+n.name+" ======"),new r(n.vertexList,n.primitiveList,n.colorList,i.identity(),s,n.name,n.visible)}function it(e,t){const o=t.getViewMatrix(),i=new Array;for(const t of e.vertexList)i.push(o.timesVertex(t));return new r(i,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function rt(e,t){De("==== 2. Render position: "+e.name+" ====");const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=nt(e.model,t):De("====== 2. Hidden model: "+e.model.name+" ======");for(const i of e.nestedPositions)o.addNestedPosition(rt(i,t));return De("==== 2. End position: "+e.name+" ===="),o}function nt(e,t){De("==== 2. World-to-View transformation of: "+e.name+" ====");const o=it(e,t);$e("2. View    ",o);const i=new Array;for(const o of e.nestedModels)i.push(nt(o,t));return De("==== 2. End Model: "+o.name+" ===="),new r(o.vertexList,o.primitiveList,o.colorList,o.matrix,i,o.name,o.visible)}function st(e,t,o){const i=o.n,r=t.vIndexList[0],n=t.vIndexList[1],s=e.vertexList[r],l=e.vertexList[n],a=s.z,d=l.z;return a<=i&&d<=i?(dt&&De("-- Near_Clip: Trivial accept."),t):a>i&&d>i?void(dt&&De("-- Near_Clip: Trivial delete")):function(e,t,o){const i=t.vIndexList[0],r=e.vertexList[i],n=r.x,s=r.y,l=r.z,a=t.cIndexList[0],d=e.colorList[a].getRGBComponents(),u=t.vIndexList[1],c=e.vertexList[u],f=c.x,m=c.y,w=c.z,x=t.cIndexList[1],b=e.colorList[x].getRGBComponents(),v=(o-w)/(l-w),p=(1-v)*f+v*n,V=(1-v)*m+v*s,y=o;let P=v;const C=(1-P)*b[0]+P*d[0],L=(1-P)*b[1]+P*d[1],E=(1-P)*b[2]+P*d[2],S=new h(p,V,y),z=e.vertexList.length;e.vertexList.push(S);const N=new A(C,L,E),B=e.colorList.length;let I,F;return e.colorList.push(N),I=l>o?0:1,dt&&(De(M("-- Clip off %s at z=%.3f",0==I?"v0":"v1",o)),De(M("-- t = %.25f",v)),De(M("-- <x0, y0, z0> = <%.8f, %.8f, %.8f",n,s,l)),De(M("-- <x1, y1, z1> = <%.8f, %.8f, %.8f",f,m,w)),De(M("-- <x,  y,  z>  = <%.8f, %.8f, %.8f",p,V,y)),De(M("-- <r0, g0, b0> = <%.8f, %.8f, %.8f>",d[0],d[1],d[2])),De(M("-- <r1, g1, b1> = <%.8f, %.8f, %.8f>",b[0],b[1],b[2])),De(M("-- <r,  g,  b>  = <%.8f, %.8f, %.8f>",C,L,E))),F=0==I?g.buildVertexColors(z,u,B,x):g.buildVertexColors(i,z,a,B),F}(e,t,i)}function lt(e,t,o){let i;const r=t.vIndexList[0];return e.vertexList[r].z<=o.n&&(i=t),i}var at=!0,dt=!1;function ht(e,t){if(!at)return e;const o=Array.from(e.colorList),i=new r(e.vertexList,e.primitiveList,o,e.matrix,e.nestedModels,e.name,e.visible),n=new Array;for(const e of i.primitiveList){let o;je("3. Near_Clipping",i,e),o=e instanceof g?st(i,e,t):lt(i,e,t),null!=o?(n.push(o),je("3. Near_Clipped (accept)",i,o)):je("3. Near_Clipped (reject)",i,e)}return new r(i.vertexList,n,i.colorList,i.matrix,i.nestedModels,i.name,i.visible)}function ut(e,t){De("==== 4. Render position: "+e.name+" ====");const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=ct(e.model,t):De("====== 4. Hidden Model: "+e.model.name+" ======");for(const i of e.nestedPositions)o.addNestedPosition(ut(i,t));return De("==== 4. End position: "+e.name+" ===="),o}function ct(e,t){De("==== 4. Near Clip model: "+e.name+" ====");const o=ht(e,t);$e("4. Near Clipped  ",o),Oe("4. Near Clipped  ",o),Ye("4. Near Clipped  ",o);const i=new Array;for(const o of e.nestedModels)i.push(ct(o,t));return De("==== 4. End Model: "+o.name+" ===="),new r(o.vertexList,o.primitiveList,o.colorList,o.matrix,i,o.name,o.visible)}function gt(e){at=e}function ft(e){dt=e}var mt=A.white;function wt(e,t){if(t instanceof S==0)throw new Error("FB must be a framebuffer");xt(e,t.vp)}function xt(e,t){if(e instanceof a==0)throw new Error("Scene must be a scene data type");if(t instanceof z==0)throw new Error("VP must be a Viewport data type");Je(e.debug),De("/n== Begin Renderering of Scene (Pipeline1): "+e.name+" ==");for(const o of e.positionList)Qe(o.debug),o.visible?bt(e,o,i.identity(),t):De("==== Hidden Position: "+o.name);De("== End Rendering of Scene (Pipeline 1) == ")}function bt(e,t,o,i){null!=t.getModel()&&null!=t.getModel()?De("==== Render Position: "+t.getName()+" ===="):De("==== Render Position (no model) ===="),De("---- Transformation matrix:\n"+t.getMatrix());const r=o.timesMatrix(t.getMatrix());null!=t.getModel()&&null!=t.getModel()&&t.getModel().visible?vt(e,t.getModel(),r,i):null!=t.getModel()&&null!=t.getModel()?De("===== Hidden model: "+t.getModel().getName()+"======"):De("====== Missing model ======");for(const o of t.nestedPositions)o.visible?bt(e,o,r,i):De("====== Hidden Position"+t.getName()+" =====");De("==== End position: "+t.name+" ====")}function vt(e,t,o,i){if(De("====== Render Model: "+t.name+" ======"),f(t),0==t.colorList.length&&0!=t.vertexList.length){for(let e=0;e<t.vertexList.length;++e)t.addColor(mt);console.log("***WARNING: Added default color to model: "+t.name+".")}$e("0. Model        ",t);const r=o.timesMatrix(t.matrix),n=et(t,r);$e("1. World        ",n);const s=it(n,e.camera);$e("2. View         ",s);const l=_t(s,e.camera);$e("3. Camera       ",l),Oe("3. Camera       ",l),Ye("3. Camera       ",l);const a=ht(l,e.camera);$e("4. Near_Clipped",a),Oe("4. Near_Clipped",a),Ye("4. Near_Clipped",a);const d=pt(a,e.camera);$e("5. Projected   ",d);const h=Le(d);$e("6. Clipped     ",h),Oe("6. Clipped     ",h),Ye("6. Clipped     ",h),zt(h,i);for(const o of t.nestedModels)o.visible?vt(e,o,r,i):De("====== Hidden model: "+o.name+" ======");De("====== End Model: "+t.name+" ======")}function pt(e,t){const o=new Array;for(let i=0;i<e.vertexList.length;i+=1){const r=e.vertexList[i];t.perspective?o[i]=new h(r.x/-r.z,r.y/-r.z,-1):o[i]=new h(r.x,r.y,0)}return new r(o,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function Vt(e,t){De("==== 5. Render position: "+e.name+" ====");const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=yt(e.model,t):De("====== 5. Hidden model: "+e.model.name+" ======");for(const i of e.nestedPositions)o.addNestedPosition(Vt(i,t));return De("==== 5. End position: "+e.name+" ===="),o}function yt(e,t){De("==== 5. Project model: "+e.name+" ====");const o=pt(e,t);$e("5. Projected",o);const i=new Array;for(const o of e.nestedModels)i.push(yt(o,t));return De("==== 5. End Model: "+o.name+" ===="),new r(o.vertexList,o.primitiveList,o.colorList,o.matrix,i,o.name,o.visible)}function Mt(e,t,o){const i=o.bgColorVP,r=o.width,n=o.height,s=t.vIndexList[0],l=t.vIndexList[1],a=e.vertexList[s],d=e.vertexList[l],h=t.cIndexList[0],u=t.cIndexList[1],c=e.colorList[h].getRGBComponents(),g=e.colorList[u].getRGBComponents();let f=c[0]/255,m=c[1]/255,w=c[2]/255,x=g[0]/255,b=g[1]/255,v=g[2]/255,p=.5+r/2.001*(a.x+1),V=.5+r/2.001*(d.x+1),y=.5+n/2.001*(a.y+1),P=.5+n/2.001*(d.y+1);if(Ct&&(De(M("(x0_pp, y0_pp) = (%9.4f, %9.4f)",p,y)),De(M("(x1_pp, y1_pp) = (%9.4f, %9.4f)",V,P))),p=Math.round(p),V=Math.round(V),y=Math.round(y),P=Math.round(P),p==V&&y==P){const e=Math.trunc(Math.trunc(p)-1),t=Math.trunc(n-Math.trunc(y));return Ct&&Ze(p,y,e,t,f,m,w,o),void o.setPixelVP(e,t,new A(255*f,255*m,255*w,255))}let C=!1;if(Math.abs(P-y)>Math.abs(V-p)){let e=p;p=y,y=e;let t=V;V=P,P=t,C=!0}if(V<p){let e=p;p=V,V=e;let t=y;y=P,P=t;let o=f,i=m,r=w;f=x,m=b,w=v,x=o,b=i,v=r}const L=V-p,E=(P-y)/L,S=(x-f)/L,z=(b-m)/L,N=(v-w)/L;Ct&&(De("Slope m    = "+E+(C?" (transposed, so 1/m = "+1/E+")":"")),De("Slope mRed = "+S),De("Slope mGrn = "+z),De("Slope mBlu = "+N),De(M("(x0_vp, y0_vp) = (%9.4f, %9.4f)",p-1,n-y)),De(M("(x1_vp, y1_vp) = (%9.4f, %9.4f)",V-1,n-P)));let B=y;for(let e=Math.trunc(p);e<Math.trunc(V);e+=1,B+=E){let t=Math.abs(f+S*(e-p)),s=Math.abs(m+z*(e-p)),l=Math.abs(w+N*(e-p));if(Lt){let a=Math.trunc(B),d=Math.trunc(a+1);C||B!=n||(d=n),C&&B==r&&(d=r);const h=B-a;let u=(1-h)*t+h*i.getRed(),c=(1-h)*s+h*i.getGreen(),g=(1-h)*l+h*i.getBlue(),f=h*t+(1-h)*i.getRed(),m=h*s+(1-h)*i.getGreen(),w=h*l+(1-h)*i.getBlue();if(Et&&(u=Math.pow(u,A.GAMMA),c=Math.pow(c,A.GAMMA),g=Math.pow(g,A.GAMMA),f=Math.pow(f,A.GAMMA),m=Math.pow(m,A.GAMMA),w=Math.pow(w,A.GAMMA)),C){const t=Math.trunc(a-1),i=Math.trunc(d-1),r=Math.trunc(n-e);Ct&&Ke(B,e,t,i,r,u,c,g,f,m,w,o),o.setPixelVP(t,r,new A(255*u,255*c,255*g)),o.setPixelVP(i,r,new A(255*f,255*m,255*w))}else{const t=Math.trunc(e-1),i=Math.trunc(n-a),r=Math.trunc(n-d);Ct&&Ue(e,B,t,i,r,u,c,g,f,m,w,o),o.setPixelVP(t,i,new A(255*u,255*c,255*g)),o.setPixelVP(t,r,new A(255*f,255*m,255*w))}}else if(Et&&(t=Math.pow(t,A.GAMMA),s=Math.pow(s,A.GAMMA),l=Math.pow(l,A.GAMMA)),C){const i=Math.trunc(Math.trunc(Math.round(B))-1),r=Math.trunc(n-e);Ct&&Ze(B,e,i,r,t,s,l,o),o.setPixelVP(i,r,new A(255*t,255*s,255*l))}else{const i=Math.trunc(e-1),r=Math.trunc(n-Math.trunc(Math.round(B)));Ct&&Ze(e,B,i,r,t,s,l,o),o.setPixelVP(i,r,new A(255*t,255*s,255*l))}}if(C){const e=Math.trunc(Math.trunc(P)-1),t=Math.trunc(n-Math.trunc(V));Ct&&Ze(P,V,e,t,x,b,v,o),o.setPixelVP(e,t,new A(255*x,255*b,255*v))}else{const e=Math.trunc(Math.trunc(V)-1),t=Math.trunc(n-Math.trunc(P));Ct&&Ze(V,P,e,t,x,b,v,o),o.setPixelVP(e,t,new A(255*x,255*b,255*v))}}function Pt(e,t,o){const i=o.width,r=o.height,n=t.vIndexList[0],s=e.vertexList[n],l=t.cIndexList[0],a=e.colorList[l].rgb;let d=a[0],h=a[1],u=a[2];if(Et){let t=A.applyGamma(e.colorList[l]).getRGBComponents();d=t[0],h=t[1],u=t[2]}let c=.5+i/2.001*(s.x+1),g=.5+r/2.001*(s.y+1);Ct&&De(M("(x_pp, y_pp) = (%9.4f, %9.4f)",c,g)),c=Math.round(c),g=Math.round(g);const f=t.radius;for(let e=Math.trunc(g)-f;e<=Math.trunc(g)+f;++e)for(let t=Math.trunc(c)-f;t<=Math.trunc(c)+f;++t){if(Ct){let n;n=t>0&&t<=i&&e>0&&e<=r?"":" : Clipped",Xe(n,c,g,t-1,r-e,d,h,u,o)}t>0&&t<=i&&e>0&&e<=r&&o.setPixelVP(t-1,r-e,new A(d,h,u))}}var Ct=!1,Lt=!1,Et=!0,St=2.2;function zt(e,t){for(const o of e.primitiveList)je("6. Rasterize",e,o),o instanceof g?Mt(e,o,t):o instanceof c?Pt(e,o,t):console.log("Incorrect Primitive: "+o)}function At(e,t){De("==== 7. Render Position: "+e.name+" ===="),e.model.visible?Nt(e.model,t):De("====== 7. Hidden model: "+e.model.name+" ======");for(const o of e.nestedPositions)At(o,t);De("==== 7. End position: "+e.name+" ====")}function Nt(e,t){De("==== 7. Rasterize model: "+e.name+" ===="),zt(e,t);for(const o of e.nestedModels)Nt(o,t);De("==== 7. End Model: "+e.name+" ====")}function Bt(e){Ct=e}function It(e){Lt=e}function Ft(e){Et=e}function _t(e,t){const o=t.getNormalizeMatrix(),i=new Array;for(const t of e.vertexList)i.push(o.timesVertex(t));return new r(i,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function kt(e,t){De("==== 3. Render Position: "+e.name);const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=qt(e.model,t):De("====== 3. Hidden model: "+e.model.name+" ======");for(const i of e.nestedPositions)o.addNestedPosition(kt(i,t));return De("==== 3. End position: "+e.name+" ===="),o}function qt(e,t){De("==== 3. View-to-Camera transformation of: "+e.name+" ====");const o=_t(e,t);$e("3. Camera    ",o),Oe("3. Camera    ",o),Ye("3. Camera    ",o);const i=new Array;for(const o of e.nestedModels)i.push(qt(o,t));return De("==== 3. End Model: "+o.name+" ===="),new r(o.vertexList,o.primitiveList,o.colorList,o.matrix,i,o.name,o.visible)}return t})()));