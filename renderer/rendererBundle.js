!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("renderer",[],t):"object"==typeof exports?exports.renderer=t():e.renderer=t()}(self,(()=>(()=>{"use strict";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{Axes2D:()=>A,Axes3D:()=>B,BarycentricTriangle:()=>F,Box:()=>I,Camera:()=>o,Circle:()=>_,CircleSector:()=>N,Color:()=>z,Cone:()=>R,ConeFrustum:()=>k,ConeSector:()=>q,Cube:()=>T,Cube2:()=>G,Cube3:()=>H,Cube4:()=>W,Cylinder:()=>Y,CylinderSector:()=>O,DEFAULT_COLOR1:()=>ft,DEFAULT_COLOR2:()=>qe,Disk:()=>j,DiskSector:()=>D,Dodecahedron:()=>X,FrameBuffer:()=>E,GAMMA:()=>Et,GRS:()=>pe,Icosahedron:()=>Z,Icosidodecahedron:()=>U,LineClip:()=>ye,LineSegment:()=>g,Matrix:()=>r,Model:()=>i,NearClipModel:()=>dt,NearClipNestedModel:()=>ct,NearClipPosition:()=>ht,NearLine:()=>nt,NearPoint:()=>st,OBJ:()=>Ve,Octahedron:()=>K,OrthoNorm:()=>n,PanelXY:()=>ee,PanelXZ:()=>te,PanelYZ:()=>oe,ParametricCurve:()=>re,ParametricSurface:()=>ie,PerspNorm:()=>s,Point:()=>u,PointClip:()=>Me,Position:()=>l,Primitive:()=>c,Pyramid:()=>se,PyramidFrustum:()=>le,RastLine:()=>yt,RastPoint:()=>Mt,Ring:()=>de,RingSector:()=>ae,Scene:()=>a,SierpinskiSponge:()=>Q,SierpinskiTriangle:()=>$,Sphere:()=>ue,SphereSector:()=>ce,SphereSubdivided:()=>he,Square:()=>ge,SquareGrid:()=>fe,SurfaceOfRevolution:()=>ne,Tetrahedron:()=>J,Torus:()=>we,TorusSector:()=>me,TriangularPrism:()=>xe,TriangularPyramid:()=>be,Vector:()=>d,Vertex:()=>h,ViewFrustumModel:()=>ve,Viewport:()=>S,check:()=>f,checkPrimitives:()=>m,clipDebug:()=>Pe,clipModel:()=>Ce,clipNestedModel:()=>Ee,clipPosition:()=>Le,debugPosition:()=>He,debugScene:()=>Ge,doAntiAliasing:()=>Ct,doGamma:()=>Lt,doNearClipping:()=>lt,format:()=>M,logColorList:()=>Ye,logMessage:()=>We,logPixel:()=>Ze,logPixelMessage:()=>Xe,logPixelsXAA:()=>Ke,logPixelsYAA:()=>Ue,logPrimitive:()=>je,logPrimitiveList:()=>De,logVertexList:()=>Oe,make:()=>y,model2viewModel:()=>ze,model2viewPosition:()=>Ae,model2worldModel:()=>$e,model2worldNestedModel:()=>tt,model2worldPosition:()=>et,nearDebug:()=>at,projectModel:()=>vt,projectNestedModel:()=>Vt,projectPosition:()=>pt,randomColor:()=>V,rastDebug:()=>Pt,rasterizeModel:()=>St,rasterizeNestedModel:()=>At,rasterizePosition:()=>zt,render1:()=>wt,render2:()=>Te,renderFB1:()=>mt,renderFB2:()=>Re,scene1:()=>Be,scene2:()=>Fe,scene3:()=>Ie,scene4:()=>Ne,scene5:()=>_e,scene6:()=>ke,setClipDebug:()=>Se,setColor:()=>w,setDebugPosition:()=>Qe,setDebugScene:()=>Je,setDoAntiAliasing:()=>Ft,setDoGamma:()=>It,setDoNearClipping:()=>ut,setNearDebug:()=>gt,setRainbowPrimitiveColors:()=>p,setRandomColor:()=>x,setRandomPrimitiveColor:()=>v,setRandomVertexColor:()=>b,setRastDebug:()=>Bt,view2cameraModel:()=>Nt,view2cameraNestedModel:()=>kt,view2cameraPosition:()=>_t,world2viewModel:()=>ot,world2viewNestedModel:()=>it,world2viewPosition:()=>rt});class o{left;right;bottom;top;n;perspective;#e;constructor(e=-1,t=-e,o=-1,i=-o,n=1,s=!0,l=r.identity()){if("boolean"!=typeof s)throw new Error("Perspective must be a boolean");s?this.projPerspective(e,t,o,i,n,l):this.projOrtho(e,t,o,i,n,l)}projPerspective(e=-1,t=-1*e,o=-1,i=-1*o,n=1,s=r.identity()){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i||"number"!=typeof n)throw new Error("All parameters must be numerical");if(s instanceof r==0)throw new Error("View Matrix must be a Matrix");this.left=e,this.right=t,this.bottom=o,this.top=i,this.n=-1*n,this.#e=s,this.perspective=!0}projPerspectiveFOVY(e=90,t=1,o=1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("FOVY, aspect, and near must be numerical");this.top=o*Math.tan(Math.PI/180*e/2),this.bottom=-1*this.top,this.right=this.top*t,this.left=-1*this.right,this.n=-1*o,this.#e=r.identity(),this.perspective=!0}projPerspectiveFocalLength(e=-1,t=-e,o=-1,i=-o,n=1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i||"number"!=typeof n)throw new Error("All parameters must be numerical");this.perspective=!0,this.left=e/n,this.right=t/n,this.bottom=o/n,this.top=i/n,this.n=-.1,this.#e=r.identity()}projOrtho(e=-1,t=1,o=-1,i=1,n=-1,s=r.identity()){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i||"number"!=typeof n)throw new Error("All parameters must be numerical");if(s instanceof r==0)throw new Error("View Matrix must be a Matrix");this.left=e,this.right=t,this.bottom=o,this.top=i,this.n=-1*n,this.#e=s,this.perspective=!1}projOrthoFOVY(e=90,t=1,o=-1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("All parameters must be numerical");this.top=Math.tan(Math.PI/180*e/2),this.bottom=-1*this.top,this.right=this.top*t,this.left=-1*this.right,this.n=1,this.#e=r.identity(),this.perspective=!1}changeNear(e){return new o(this.left,this.right,this.bottom,this.top,-e,this.perspective,this.#e)}translate(e,t,i){return new o(this.left,this.right,this.bottom,this.top,this.n,this.perspective,r.translate(-e,-t,-i))}getViewVector(){return new d(this.#e.v4.x,this.#e.v4.y,this.#e.v4.z)}getViewMatrix(){return this.#e}viewLookAt(e,t,o,i,n,s,l,a,h){const c=new d(i-e,n-t,s-o),u=new d(l,a,h),g=c.normalize(),f=u.normalize(),m=g.crossProduct(f),w=m.crossProduct(g),x=r.buildFromColumns(new d(m.x,w.x,-g.x,0),new d(m.y,w.y,-g.y,0),new d(m.z,w.z,-g.z,0),new d(0,0,0,1));this.#e=x.timesMatrix(r.translate(-e,-t,-o))}view2Identity(){this.#e=r.identity()}viewTranslate(e,t,o){this.#e=r.translate(-e,-t,-o).timesMatrix(this.#e)}viewRotate(e,t,o,i){this.#e=r.rotate(-e,t,o,i).timesMatrix(this.#e)}viewRotateX(e){this.viewMatrix=r.rotate(-e,1,0,0).timesMatrix(this.#e)}viewRotateY(e){this.#e=r.rotate(-e,0,1,0).timesMatrix(this.#e)}viewRotateZ(e){this.#e=r.rotate(-e,0,0,1).timesMatrix(this.#e)}getNormalizeMatrix(){return this.perspective?s(this.left,this.right,this.bottom,this.top):n(this.left,this.right,this.bottom,this.top)}toString(){const e=180/Math.PI*Math.atan(this.top)+180/Math.PI*Math.atan(-this.bottom),t=(this.right-this.left)/(this.top-this.bottom);let o="";return o+="Camera: \n",o+="  perspective = "+this.perspective+"\n",o+="  left = "+this.left+",   right = "+this.right+"\n  bottom = "+this.bottom+",   top = "+this.top+"\n  near = "+-1*this.n+"\n  (fovy = "+e+M(", aspect ratio = %.2f)",t)+"Normalization Matrix\n"+this.getNormalizeMatrix().toString()+"\nView Matrix\n  "+this.#e.toString(),o}static main(){console.log("Creating cam1 = new Camera()");const e=new o;console.log("cam1: "),console.log(e.toString()),console.log(""),console.log("cam1.projOrtho(-2, 2, -2, 2, 2): "),e.projOrtho(-2,2,-2,2,2),console.log(e.toString()),console.log(""),console.log("cam1.projPerspFOVY(): "),e.projPerspectiveFOVY(),console.log(e.toString()),console.log(""),console.log("Creating cam2 = new Camera(-4, 4, -4, 4, false)");const t=new o(-4,4,-4,4,4,!1);console.log("cam2: "),console.log(t.toString()),console.log(""),console.log("cam2.projPerspective(-3, 3, -3, 3, 3): "),t.projPerspective(-3,3,-3,3,3),console.log(t.toString()),console.log(""),console.log("cam2.projOrthoFOVY(): "),t.projOrthoFOVY(),console.log(t.toString())}}class r{v1;v2;v3;v4;static#t=!1;constructor(e,t,o,i){if(0==r.#t)throw new Error("NON INSTANTIABLE Class");if(e instanceof d==0||t instanceof d==0||o instanceof d==0||i instanceof d==0)throw new Error("All parameters must be Vectors");this.v1=e,this.v2=t,this.v3=o,this.v4=i,r.#t=!1}static buildFromColumns(e,t,o,i){return r.#t=!0,new r(e,t,o,i)}static buildFromRows(e,t,o,i){if(e instanceof d==0||t instanceof d==0||o instanceof d==0||i instanceof d==0)throw new Error("All parameters must be Vectors");const n=new d(e.x,t.x,o.x,i.x),s=new d(e.y,t.y,o.y,i.y),l=new d(e.z,t.z,o.z,i.z),a=new d(e.w,t.w,o.w,i.w);return r.#t=!0,new r(n,s,l,a)}static identity(){return r.scaleXYZ(1,1,1)}static translate(e,t,o){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("All parameters must be numerical");return r.#t=!0,new r(new d(1,0,0,0),new d(0,1,0,0),new d(0,0,1,0),new d(e,t,o,1))}static scale(e){if("number"!=typeof e)throw new Error("D must be numerical");return r.scaleXYZ(e,e,e)}static scaleXYZ(e,t,o){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("All parameters must be numercial");return r.#t=!0,new r(new d(e,0,0,0),new d(0,t,0,0),new d(0,0,o,0),new d(0,0,0,1))}static rotateX(e){if("number"!=typeof e)throw new Error("Theta must be numerical");return r.#t=!0,r.rotate(e,1,0,0)}static rotateY(e){if("number"!=typeof e)throw new Error("Theta must be numerical");return r.#t=!0,r.rotate(e,0,1,0)}static rotateZ(e){if("number"!=typeof e)throw new Error("Theta must be numerical");return r.#t=!0,r.rotate(e,0,0,1)}static rotate(e,t,o,i){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i)throw new Error("All parameters need to be numerical");const n=Math.sqrt(t*t+o*o+i*i),s=t/n,l=o/n,a=i/n,h=Math.cos(Math.PI/180*e),c=Math.sin(Math.PI/180*e);return r.#t=!0,new r(new d(s*s*(1-h)+h,l*s*(1-h)+a*c,a*s*(1-h)-l*c,0),new d(s*l*(1-h)-a*c,l*l*(1-h)+h,a*l*(1-h)+s*c,0),new d(s*a*(1-h)+l*c,l*a*(1-h)-s*c,a*a*(1-h)+h,0),new d(0,0,0,1))}timesScalar(e){if("number"!=typeof e)throw new Error("S must be numerical");return r.#t=!0,new r(this.v1.timesScalar(e),this.v2.timesScalar(e),this.v3.timesScalar(e),this.v4.timesScalar(e))}timesVertex(e){if(e instanceof h==0)throw new Error("V must be a Vertex");const t=this.v1.x*e.x+this.v2.x*e.y+this.v3.x*e.z+this.v4.x*e.w,o=this.v1.y*e.x+this.v2.y*e.y+this.v3.y*e.z+this.v4.y*e.w,r=this.v1.z*e.x+this.v2.z*e.y+this.v3.z*e.z+this.v4.z*e.w,i=this.v1.w*e.x+this.v2.w*e.y+this.v3.w*e.z+this.v4.w*e.w;return new h(t,o,r,i)}timesVector(e){if(e instanceof d==0)throw new Error("V is not a Vector");const t=this.v1.x*e.x+this.v2.x*e.y+this.v3.x*e.z+this.v4.x*e.w,o=this.v1.y*e.x+this.v2.y*e.y+this.v3.y*e.z+this.v4.y*e.w,r=this.v1.z*e.x+this.v2.z*e.y+this.v3.z*e.z+this.v4.z*e.w,i=this.v1.w*e.x+this.v2.w*e.y+this.v3.w*e.z+this.v4.w*e.w;return new d(t,o,r,i)}timesMatrix(e){if(e instanceof r==0)throw new Error("M is not a Matrix");return r.#t=!0,new r(this.timesVector(e.v1),this.timesVector(e.v2),this.timesVector(e.v3),this.timesVector(e.v4))}timesEqualsScalar(e){if("number"!=typeof e)throw new Error("S is not numerical");return this.v1.timesEqualsScalar(e),this.v2.timesEqualsScalar(e),this.v3.timesEqualsScalar(e),this.v4.timesEqualsScalar(e),this}mult(e){if(e instanceof r==0)throw new Error("M is not a Matrix");let t=0,o=0,i=0,n=0;t=e.v1.x,o=e.v1.y,i=e.v1.z,n=e.v1.w;const s=this.v1.x*t+this.v2.x*o+this.v3.x*i+this.v4.x*n,l=this.v1.y*t+this.v2.y*o+this.v3.y*i+this.v4.y*n,a=this.v1.z*t+this.v2.z*o+this.v3.z*i+this.v4.z*n,d=this.v1.w*t+this.v2.w*o+this.v3.w*i+this.v4.w*n;t=e.v2.x,o=e.v2.y,i=e.v2.z,n=e.v2.w;const h=this.v1.x*t+this.v2.x*o+this.v3.x*i+this.v4.x*n,c=this.v1.y*t+this.v2.y*o+this.v3.y*i+this.v4.y*n,u=this.v1.z*t+this.v2.z*o+this.v3.z*i+this.v4.z*n,g=this.v1.w*t+this.v2.w*o+this.v3.w*i+this.v4.w*n;t=e.v3.x,o=e.v3.y,i=e.v3.z,n=e.v3.w;const f=this.v1.x*t+this.v2.x*o+this.v3.x*i+this.v4.x*n,m=this.v1.y*t+this.v2.y*o+this.v3.y*i+this.v4.y*n,w=this.v1.z*t+this.v2.z*o+this.v3.z*i+this.v4.z*n,x=this.v1.w*t+this.v2.w*o+this.v3.w*i+this.v4.w*n;t=e.v4.x,o=e.v4.y,i=e.v4.z,n=e.v4.w;const b=this.v1.x*t+this.v2.x*o+this.v3.x*i+this.v4.x*n,v=this.v1.y*t+this.v2.y*o+this.v3.y*i+this.v4.y*n,p=this.v1.z*t+this.v2.z*o+this.v3.z*i+this.v4.z*n,V=this.v1.w*t+this.v2.w*o+this.v3.w*i+this.v4.w*n;return this.v1.x=s,this.v1.y=l,this.v1.z=a,this.v1.w=d,this.v2.x=h,this.v2.y=c,this.v2.z=u,this.v2.w=g,this.v3.x=f,this.v3.y=m,this.v3.z=w,this.v3.w=x,this.v4.x=b,this.v4.y=v,this.v4.z=p,this.v4.w=V,this}multLeft(e){if(e instanceof r==0)throw new Error("M is not a  Matrix");return this.v1.timesEqualsMatrix(e),this.v2.timesEqualsMatrix(e),this.v3.timesEqualsMatrix(e),this.v4.timesEqualsMatrix(e),this}rot2euler(){const e=this.v1.x,t=this.v2.x,o=this.v3.x,r=this.v1.y,i=this.v1.z,n=this.v2.z,s=this.v3.z;let l,a,d;return 1!=i&&-1!=i?(a=-Math.asin(i),l=Math.atan2(n/Math.cos(a),s/Math.cos(a)),d=Math.atan2(r/Math.cos(a),e/Math.cos(a))):(-1==i?(a=Math.PI/2,l=Math.atan2(t,o)):(a=-Math.PI/2,l=Math.atan2(-t,-o)),d=0),[l,a,d]}eulerize(){const e=this.rot2euler();return r.rotateZ(e[2]*(180/Math.PI)).timesMatrix(r.rotateY(e[1]*(180/Math.PI)).timesMatrix(r.rotateX(e[0]*(180/Math.PI))))}toString(){let e="";return e+=M("[[%3.5f  %3.5f  %3.5f  %3.5f ]\n",this.v1.x,this.v2.x,this.v3.x,this.v4.x),e+=M(" [%3.5f  %3.5f  %3.5f  %3.5f ]\n",this.v1.y,this.v2.y,this.v3.y,this.v4.y),e+=M(" [%3.5f  %3.5f  %3.5f  %3.5f ]\n",this.v1.z,this.v2.z,this.v3.z,this.v4.z),e+=M(" [%3.5f  %3.5f  %3.5f  %3.5f ]]",this.v1.w,this.v2.w,this.v3.w,this.v4.w),e}static main(){console.log("Creating vector v1 = new Vector(1, 2, 3)"),console.log("Creating vector v2 = new Vector(4, 5, 6)"),console.log("Creating vector v3 = new Vector(7, 8, 9)"),console.log("Creating vector v4 = new Vector(10, 11, 12)");const e=new d(1,2,3),t=new d(4,5,6),o=new d(7,8,9),i=new d(10,11,12);console.log(""),console.log("Creating m1 = buildColumns(v1, v2, v3, v4) : ");const n=r.buildFromColumns(e,t,o,i);console.log(n.toString()),console.log(""),console.log("Creating m2 = buildRows(v1, v2, v3, v4): ");const s=r.buildFromRows(e,t,o,i);console.log(s.toString()),console.log(""),console.log("Creating id = identity(): ");const l=r.identity();console.log(l.toString()),console.log(""),console.log("Creating trans = translate(1, 1, 1): ");const a=r.translate(1,1,1);console.log(a.toString()),console.log(""),console.log("Creating sc = scale(2): ");const c=r.scale(2);console.log(c.toString()),console.log(""),console.log("Creating scXYZ = scale(3, 3, 3): ");const u=r.scaleXYZ(3,3,3);console.log(u.toString()),console.log(""),console.log("Creating rotX = rotateX(90): ");const g=r.rotateZ(90);console.log(g.toString()),console.log(""),console.log("Creating rotY = rotateY(90): ");const f=r.rotateY(90);console.log(f.toString()),console.log(""),console.log("Creating rotZ = rotateZ(90): ");const m=r.rotateZ(90);console.log(m.toString()),console.log(""),console.log("Creating rot = rotate(90, 1, 1, 1): ");const w=r.rotate(90,1,1,1);console.log(w.toString()),console.log(""),console.log("Creating timesSC = m1.timesScalar(5): ");const x=n.timesScalar(5);console.log(x.toString()),console.log(""),console.log("Creating timesVert = m1.timesVertex(new Vertex(10, 10, 10)): ");const b=n.timesVertex(new h(10,10,10));console.log(b.toString()),console.log(""),console.log("Creating timesVect = m1.timesVect(v1): ");const v=n.timesVector(e);console.log(v.toString()),console.log(""),console.log("Outputing m1 and m2 to allow for checking of subsequent functions"),console.log(n.toString()),console.log(s.toString()),console.log(""),console.log("Creating timesMat = m1.timesMatrix(m2): ");const p=n.timesMatrix(s);console.log(p.toString()),console.log(""),console.log("m1.timesEqualsScalar(5): "),n.timesEqualsScalar(5),console.log(n.toString()),console.log(""),console.log("m1.mult(m2): "),n.mult(s),console.log(n.toString()),console.log(""),console.log("m2.multLeft(m1): "),s.multLeft(n),console.log(s.toString())}}class i{#o;#r;#i;#n;visible;#s;#l;constructor(e=new Array,t=new Array,o=new Array,n=r.identity(),s=new Array,l="",a=!0){if(0==Array.isArray(e))throw new Error("Vertex list must be array");if(0==Array.isArray(t))throw new Error("Primitive list must be array");if(0==Array.isArray(o))throw new Error("Color List must be array");if(0==Array.isArray(s))throw new Error("Nested Models must be an array");if(n instanceof r==0)throw new Error("Matrix must be a Matrix");if("string"!=typeof l)throw new Error("Name must be a string");if("boolean"!=typeof a)throw new Error("Visible is not a boolean");let d=0;this.#o=new Array;for(let t=0;t<e.length;t+=1){if(e[t]instanceof h==0)throw this.#o.length=d,new Error("Vertex List must contain Vertexes");this.#o.push(e[t]),d+=1}let u=0;this.#r=new Array;for(let e=0;e<t.length;e+=1){if(t[e]instanceof c==0)throw this.#r.length=u,new Error("Primitive List mut contain Primitives");this.#r.push(t[e]),u+=1}let g=0;this.#i=new Array;for(let e=0;e<o.length;e+=1){if(o[e]instanceof z==0)throw this.#i.length=g,new Error("Color List must only contain Colors");this.#i.push(o[e]),g+=1}let f=0;this.#l=new Array;for(let e=0;e<s.length;e+=1){if(s[e]instanceof i==0)throw this.#l.length=f,new Error("Nested Models must only contain Models");this.#l.push(s[e]),f+=1}this.#n=l,this.visible=a,this.#s=n}static buildName(e=""){return new i(new Array,new Array,new Array,void 0,void 0,e)}static buildNameMatrix(e="",t=r.identity()){return new i(new Array,new Array,new Array,t,new Array,e)}static buildRend9Model(e=new Array,t=new Array,o=new Array,n="",s=!0){return new i(e,t,o,r.identity(),new Array,n,s)}getVertexList(){return this.#o}get vertexList(){return this.#o}getPrimitiveList(){return this.#r}get primitiveList(){return this.#r}getColorList(){return this.#i}get colorList(){return this.#i}getName(){return this.#n}get name(){return this.#n}setName(e=""){if("string"!=typeof e)throw new Error("Name must be a string");this.#n=e}set name(e){if("string"!=typeof e)throw new Error("Name must be a string");this.#n=e}getNestedModels(){return this.#l}get nestedModels(){return this.#l}getMatrix(){return this.#s}get matrix(){return this.#s}set matrix(e){if(e instanceof r==0)throw new Error("M must be a matrix");this.#s=e}setMatrix(e){if(e instanceof r==0)throw new Error("M must be a Matrix");this.#s=e}getVertex(e=0){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#o[e]}addVertex(...e){for(let t of e){if(t instanceof h==0)throw new Error("Can only add Vertexes");this.#o.push(t)}}getPrimitive(e=0){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#r[e]}addPrimitive(...e){for(let t of e){if(t instanceof c==0)throw new Error("Can only add primitives");this.#r.push(t)}}getColor(e=0){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#i[e]}addColor(...e){for(let t of e){if(t instanceof z==0)throw new Error("Can only add Colors");this.#i.push(t)}}getNestedModel(e=0){if("number"!=typeof e)throw new Error("index must be a number");return this.nestedModels[e]}addNestedModel(...e){for(const t of e){if(t instanceof i==0)throw new Error("Can only add models to this models nested models list");this.#l.push(t)}}setNestedModel(e,t){if("number"!=typeof e)throw new Error("Index must be a number");if(t instanceof i==0)throw new Error("Model must be a Model");this.#l[e]=t}transform(e){return new i(this.#o,this.#r,this.#i,e,this.#l,this.#n,this.visible)}toString(){let e="";e+="Model: "+this.#n+"\n",e+="This Model's visibility is: "+this.visible+"\n",e+="Model has "+this.#o.length+" vertices.\n",e+="Model has "+this.#i.length+" colors.\n",e+="Model has "+this.#r.length+" primitives.\n",e+="Model has "+this.#l.length+" nested models.\n";let t=0;for(let o of this.#o)e+=t+": "+o.toString()+"\n",++t;t=0;for(let o of this.#i)e+=t+": "+o.toString()+"\n",++t;t=0;for(let o of this.#r)e+=t+": "+o.toString()+"\n",++t;e+=this.#s.toString()+"\n";for(const t of this.#l)e+=t.toString();return e}static main(){console.log("Creating m1 = new Model(): ");const e=new i;console.log(e.toString()),console.log(""),console.log("Creating m2 = buildName('Model 2'): ");const t=i.buildName("Model 2");console.log(t.toString()),console.log(""),console.log("m1.getVertexList(): "),console.log(e.getVertexList()),console.log(""),console.log("m1.vertexList(): "),console.log(e.vertexList),console.log(""),console.log("m1.getPrimitiveList(): "),console.log(e.getPrimitiveList()),console.log(""),console.log("m1.primitiveList(): "),console.log(e.primitiveList),console.log(""),console.log("m1.getColorList(): "),console.log(e.getColorList()),console.log(""),console.log("m1.colorList(): "),console.log(e.colorList),console.log(""),console.log("m1.getName(): "),console.log(e.getName()),console.log(""),console.log("m1.name(): "),console.log(e.name),console.log(""),console.log("m1.setName('Model 1')"),e.setName("Model 1"),console.log(e.toString()),console.log(""),console.log("m1.addVertex(new Vertex(0, 0, 0): "),e.addVertex(new h(0,0,0)),console.log(e.toString()),console.log(""),console.log("m1.addVertex(new Vertex(1, 0, 0), new Vertex(-1, 0, 0), new Vertex(0, 1, 0), new Vertex(0, -1, 0)): "),e.addVertex(new h(1,0,0),new h(-1,0,0),new h(0,1,0),new h(0,-1,0)),console.log(e.toString()),console.log(""),console.log("m1.getVertex(0).toString(): "),console.log(e.getVertex(0).toString()),console.log(""),console.log("m1.getVertex(3).toString(): "),console.log(e.getVertex(3).toString()),console.log(""),console.log("m1.addColor(new Color(0, 0, 0)): "),e.addColor(new z(0,0,0)),console.log(e.toString()),console.log(""),console.log("m1.addColor(Color.blue, Color.red, Color.green, Color.yellow): "),e.addColor(z.blue,z.red,z.green,z.yellow),console.log(e.toString()),console.log(""),console.log("m1.getColor(0): "),console.log(e.getColor(0).toString()),console.log(""),console.log("m1.getColor(3): "),console.log(e.getColor(3).toString()),console.log(""),console.log("m1.addPrimitive(new Point(0, 0)"),e.addPrimitive(new u(0,0)),console.log(e.toString()),console.log(""),console.log("m1.addPrimitive(new ls(1, 3, 1, 3), new ls(1, 4, 1, 4), new ls(2, 3, 2, 3), new ls(2, 4, 2, 4)): "),e.addPrimitive(g.buildVertexColors(1,3,1,3),g.buildVertexColors(1,4,1,4),g.buildVertexColors(2,3,2,3),g.buildVertexColors(2,4,2,4)),console.log(e.toString()),console.log(""),console.log("m1.getPrimitive(0): "),console.log(e.getPrimitive(0).toString()),console.log(""),console.log("m1.getPrimitive(3): "),console.log(e.getPrimitive(3).toString())}}function n(e,t,o,i){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i)throw new Error("L, B, R, T must be numerical");let n,s;return n=r.buildFromColumns(new d(1,0,0,0),new d(0,1,0,0),new d(0,0,1,0),new d(-(t+e)/2,-(i+o)/2,0,1)),s=r.buildFromColumns(new d(2/(t-e),0,0,0),new d(0,2/(i-o),0,0),new d(0,0,1,0),new d(0,0,0,1)),s.timesMatrix(n)}function s(e,t,o,i){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof i)throw new Error("L, R, B, T, and near must be numerical");let n,s;return n=r.buildFromColumns(new d(1,0,0,0),new d(0,1,0,0),new d((t+e)/2,(i+o)/2,1,0),new d(0,0,0,1)),s=r.buildFromColumns(new d(2/(t-e),0,0,0),new d(0,2/(i-o),0,0),new d(0,0,1,0),new d(0,0,0,1)),s.timesMatrix(n)}class l{#a;#s;#n;#d;visible;debug;constructor(e=new i,t=r.identity(),o="",n=new Array,s=!0,a=!1){if(e instanceof i==0)throw new Error("Model has to be a model");if(t instanceof r==0)throw new Error("Matrix has to be a Matrix");if("string"!=typeof o)throw new Error("Name has to be a string");if(!Array.isArray(n))throw new Error("Nested Positions has to be an array");if("boolean"!=typeof s||"boolean"!=typeof a)throw new Error("Visible and Debug must be booleans");let d=0;this.#d=new Array;for(let e=0;e<n.length;e+=1){if(n[e]instanceof l==0)throw this.#d.length=d,new Error("Nested Position must be a Position");this.#d.push(n[e]),d+=1}this.#a=e,this.#s=t,this.#n=o,this.visible=s,this.debug=a}static buildFromModel(e){return new l(e,r.identity(),e.getName())}static buildFromName(e){return new l(new i,r.identity(),e)}static buildFromModelName(e,t){return new l(e,r.identity(),t)}getName(){return this.#n}get name(){return this.#n}getModel(){return this.#a}get model(){return this.#a}setModel(e){if(e instanceof i==0)throw new Error("Model must be a Model");if(null==e)throw new Error("Model cannot be null or undefined");this.#a=e}set model(e){if(e instanceof i==0)throw new Error("Model must be a model");if(null==e)throw new Error("Model cannot be null or undefined");this.#a=e}getMatrix(){return this.#s}get matrix(){return this.#s}setMatrix(e){if(e instanceof r==0)throw new Error("Matrix must be a Matrix");if(null==e)throw new Error("Matrix cannot be null or undefined");return this.#s=e,this.#s}set matrix(e){if(e instanceof r==0)throw new Error("Matrix must be a matrix");if(null==e)throw new Error("Matrix cannot be undefined or null");this.#s=e}getNestedPositions(){return this.#d}get nestedPositions(){return this.#d}matrix2Identity(){return this.#s=r.identity(),this.#s}setNestedPosition(e,t){if("number"!=typeof e)throw new Error("Index must be numerical");if(t instanceof l==0)throw new Error("Position must be a Position");this.#d[e]=t}addNestedPosition(...e){let t=this.#d.length;for(let o of e){if(o instanceof l==0)throw this.#d.length=t,new Error("Can only add Positions");this.#d.push(o),t+=1}}translation(e,t,o){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o)throw new Error("dx, dy, and dz must be numerical");this.#s=r.translate(e,t,o)}changeModel(e){return new l(e,this.#s,this.#n,this.#d,this.visible,this.debug)}transform(e){return new l(this.#a,e,this.#n,this.#d,this.visible,this.debug)}toString(){let e="";e+="Position: "+this.#n+"\n",e+="This Position's visibility is: "+this.visible+"\n",e+="This Position's Matrix is\n",e+=this.#s.toString()+"\n",e+="This Position's Model is\n",e+=null==this.#a||null==this.#a?"null\n":this.#a.toString(),e+="This Position has "+this.#d.length+" nested Positions\n";for(let t of this.#d)e+=t.toString();return e}static main(){console.log("Creating p1 = new Position."),console.log("Creating p2 = Position.buildFromModel(new Model())"),console.log("Creating p3 = Position.buildFromName('p2')"),console.log("Creating p4 = Position.buildFromModelName(new Model(), 'p4')");const e=new l,t=l.buildFromModel(new i),o=l.buildFromName("p3"),n=l.buildFromModelName(new i,"p4");console.log(""),console.log("p1: "),console.log(e.toString()),console.log(""),console.log("p2: "),console.log(t.toString()),console.log(""),console.log("p3: "),console.log(o.toString()),console.log(""),console.log("p4: "),console.log(n.toString()),console.log(""),console.log("p1.getName(): "),console.log(e.getName()),console.log(""),console.log("p1.name"),console.log(e.name),console.log(""),console.log("p2.getName(): "),console.log(t.getName()),console.log(""),console.log("p2.name"),console.log(t.name),console.log(""),console.log("p3.getName(): "),console.log(o.getName()),console.log(""),console.log("p3.name"),console.log(o.name),console.log(""),console.log("p4.getName(): "),console.log(n.getName()),console.log(""),console.log("p4.name"),console.log(n.name),console.log(""),console.log("p1.getModel(): "),console.log(e.getModel().toString()),console.log(""),console.log("p1.model"),console.log(e.model.toString()),console.log(""),console.log("p2.getModel(): "),console.log(t.getModel().toString()),console.log(""),console.log("p2.model"),console.log(t.model.toString()),console.log(""),console.log("p3.getModel(): "),console.log(o.getModel().toString()),console.log(""),console.log("p3.model"),console.log(o.model.toString()),console.log(""),console.log("p4.getModel(): "),console.log(n.getModel().toString()),console.log(""),console.log("p4.model"),console.log(n.model.toString()),console.log(""),console.log("p1.model = (new Model()): "),e.model=new i,console.log(e.toString()),console.log(""),console.log("p3.model = (new Model()): "),o.model=new i,console.log(o.toString()),console.log(""),console.log("p1.getMatrix(): "),console.log(e.getMatrix()),console.log(""),console.log("p1.matrix"),console.log(e.matrix),console.log(""),console.log("p2.getMatrix(): "),console.log(t.getMatrix()),console.log(""),console.log("p3.getMatrix(): "),console.log(o.getMatrix()),console.log(""),console.log("p4.getMatrix(): "),console.log(n.getMatrix()),console.log(""),console.log("p1.matrix = (Matrix.translate(1, 1, 1)): "),e.matrix=r.translate(1,1,1),console.log(e.toString()),console.log(""),console.log("p1.matrix2Identity(): "),e.matrix2Identity(),console.log(e.toString()),console.log(""),console.log("p1.getNestedPositions(): "),console.log(e.getNestedPositions()),console.log(""),console.log("p1.addNestedPosition(p2): "),e.addNestedPosition(t),console.log(e.toString()),console.log(""),console.log("p1.addNestedPosition(p3, p4): "),e.addNestedPosition(o,n),console.log(e.toString()),console.log(""),console.log("p1.nestedPosition: "),console.log(e.nestedPositions),console.log(""),console.log("p1.setNestedPosition(0, p4)"),e.setNestedPosition(0,n),console.log(e.toString())}}class a{#h;#c;#n;debug=!1;constructor(e=new o,t=new Array,r="",i=!1){if(e instanceof o==0)throw new Error("Camera must be a camera");if(!Array.isArray(t))throw new Error("Position List must be an array and is type: "+typeof t);if("string"!=typeof r)throw new Error("Name must be a String");if("boolean"!=typeof i)throw new Error("Debug must be a boolean");let n=0;this.#h=new Array;for(let e=0;e<t.length;e+=1){if(t[e]instanceof l==0)throw this.#h.length=n,new Error("Position List can only contain Positions");this.#h.push(t[e]),n+=1}this.#c=e,this.#n=r,this.debug=i}static buildFromName(e){return new a(new o,new Array,e)}static buildFromCamera(e){return new a(e)}static buildFromCameraName(e,t){return new a(e,new Array,t)}getName(){return this.#n}get name(){return this.#n}getCamera(){return this.#c}get camera(){return this.#c}setCamera(e){if(e instanceof o==0)throw new Error("Camera must be a Camera");this.#c=e}set camera(e){if(e instanceof o==0)throw new Error("Camera must be a Camera");this.#c=e}changeCamera(e){return new a(e,this.#h,this.#n,this.debug)}getPositionList(){return this.#h}get positionList(){return this.#h}getPosition(e){if("number"!=typeof e)throw new Error("Index must be numerical");return this.#h[e]}setPosition(e,t){if("number"!=typeof e)throw new Error("Index must be numerical");if(t instanceof l==0)throw new Error("Position must be a Position");this.#h[e]=t}addPosition(...e){for(let t of e){if(t instanceof l==0)throw new Error("Can only add Positions");this.#h.push(t)}}getModelByName(e){if("string"!=typeof e)throw new Error("Name must be a String");for(let t of this.#h)if(e===t.getModel().getName())return t.getModel()}getPositionByModelName(e){if("string"!=typeof e)throw new Error("Name must be a String");for(let t of this.#h)if(e===t.getModel().getName())return t}getPositionByName(e){if("string"!=typeof e)throw new Error("name must be a string");for(let t of this.#h)if(e===t.name)return t}toString(){let e="";e+="Scene: "+this.#n+"\n",e+=this.#c.toString(),e+="This Scene has "+this.#h.length+" positions\n";let t=0;for(let o of this.#h)e+="Position "+t+++"\n",e+=null==o?"missing position \n":o.toString();return e+="\n",e}static main(){const e=new i;e.addColor(z.orange),e.addVertex(new h(-1,0,0),new h(1,0,0)),e.addPrimitive(g.buildVertexColor(0,1,0)),e.setName("Line Model");const t=l.buildFromModelName(e,"Pos 1"),r=new o;console.log("Creating scene1 = new Scene()");const n=new a;console.log("Creating scene2 = Scene.buildFromCamera(cam = new Camera)");const s=a.buildFromCamera(r);console.log("Creating scene3 = Scene.buildFromName('scene 3')");const d=a.buildFromName("Scene 3");console.log("Creating scene4 = Scene.buildFromCameraName(new Camera, 'Scene 4')");const c=a.buildFromCameraName(r,"Scene 4");console.log(""),console.log("Scene1: "),console.log(n.toString()),console.log(""),console.log("scene 2: "),console.log(s.toString()),console.log(""),console.log("Scene 3: "),console.log(d.toString()),console.log(""),console.log("Scene 4: "),console.log(c.toString()),console.log(""),console.log("Scene1.getName(): "),console.log(n.getName()),console.log(""),console.log("scene1.name"),console.log(n.name),console.log(""),console.log("scene2.getCamera()"),console.log(s.getCamera()),console.log(""),console.log("scene2.camera"),console.log(s.camera),console.log(""),console.log("scene3.getPositionList() "),console.log(d.getPositionList()),console.log(""),console.log("scene3.positionList"),console.log(d.positionList),console.log(""),console.log("scene1.camera = cam"),n.camera=r,console.log(n.toString()),console.log(""),console.log("scene2.setPosition(1, pos1)"),s.setPosition(1,t),console.log(s.toString()),console.log(""),console.log("scene3.addPosition(pos1)"),d.addPosition(t),console.log(d.toString()),console.log(""),console.log("scene3.getPosition(0) "),console.log(d.getPosition(0).toString()),console.log(""),console.log("scene4.addPosition(pos1, pos1, pos1)"),c.addPosition(t,t,t),console.log(c.toString()),console.log(""),console.log("scene4.getModelByName(Line Model)"),console.log(c.getModelByName("Line Model")?.toString()),console.log(""),console.log("scene4.getPositionByModelName(Pos 1)"),console.log(c.getPositionByModelName("Pos 1")?.toString()),console.log(""),console.log("scene4.getPositionByModelName(Line Model)"),console.log(c.getPositionByModelName("Line Model")?.toString())}}class d{x;y;z;w;constructor(e,t,o,r=0){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new Error("All parameters must be numerical.");this.x=e,this.y=t,this.z=o,this.w=r}static buildVertex(e){if(e instanceof h==0)throw new Error("V is not a Vertex");return new d(e.x,e.y,e.z,e.w)}dotProduct(e){if(e instanceof d==0)throw new Error("V is not a Vector");return this.x*e.x+this.y*e.y+this.z*e.z}crossProduct(e){if(e instanceof d==0)throw new Error("V is not a Vector");return new d(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}timesScalar(e){if("number"!=typeof e)throw new Error("S has to be numerical");return new d(this.x*e,this.y*e,this.z*e,this.w*e)}plusVector(e){if(e instanceof d==0)throw new Error("V is not a vector");return new d(this.x+e.x,this.y+e.y,this.z+e.z,this.w+e.w)}minusVector(e){if(e instanceof d==0)throw new Error("V is not a vector");return new d(this.x-e.x,this.y-e.y,this.z-e.z,this.w-e.w)}normalize(){const e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return new d(this.x/e,this.y/e,this.z/e)}plusVertex(e){if(e instanceof h==0)throw new Error("V is not a vertex");return new h(this.x+e.x,this.y+e.y,this.z+e.z)}timesEqualsScalar(e){if("number"!=typeof e)throw new Error("S is not a number");return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}timesEqualsMatrix(e){if(e instanceof r==0)throw new Error("M must be a Matrix");const t=e.v1,o=e.v2,i=e.v3,n=e.v4,s=t.x*this.x+o.x*this.y+i.x*this.z+n.x*this.w,l=t.y*this.x+o.y*this.y+i.y*this.z+n.y*this.w,a=t.z*this.x+o.z*this.y+i.z*this.z+n.z*this.w,d=t.w*this.x+o.w*this.y+i.w*this.z+n.w*this.w;return this.x=s,this.y=l,this.z=a,this.w=d,this}plusEqualsVector(e){if(e instanceof d==0)throw new Error("V is not a vector");return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}minusEqualsVector(e){if(e instanceof d==0)throw new Error("V is not a Vector");return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}normalizeEquals(){const e=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z);return this.x/=e,this.y/=e,this.z/=e,this}toString(){return M("[x, y, z, w] = [%3.5d, %3.5d, %3.5d, %3.5d]",this.x,this.y,this.z,this.w)}static main(){console.log("Creating new Vector v1 = new Vector(1, 1, 1)");const e=new d(1,1,1);console.log("Creating Vector v2 from buildVertex(vertex1 = new Vertex(2, 2, 2))");const t=new h(2,2,2),o=d.buildVertex(t);console.log(""),console.log("Creating dotProdV = v1.dotProduct(v2): ");const r=e.dotProduct(o);console.log(r),console.log(""),console.log("Creating crossProdV = v1.crossProduct(v2): ");const i=e.crossProduct(o);console.log(i.toString()),console.log(""),console.log("Creating timesNum = v1.timesScalar(5): ");const n=e.timesScalar(5);console.log(n.toString()),console.log(""),console.log("Creating plusVect = v1.plusVector(v2): ");const s=e.plusVector(o);console.log(s.toString()),console.log(""),console.log("Creating minusVect = v1.minusVector(v2): ");const l=e.minusVector(o);console.log(l.toString()),console.log(""),console.log("Creating v1Norm = v1.normalize(): ");const a=e.normalize();console.log(a.toString()),console.log(""),console.log("Creating plusVert = v1.plusVertex(vertex1): ");const c=e.plusVertex(t);console.log(c.toString()),console.log(""),console.log("v1.timesEqualsScalar(2): "),e.timesEqualsScalar(2),console.log(e.toString()),console.log(""),console.log("v1.plusEqualsVector(v2): "),e.plusEqualsVector(o),console.log(e.toString()),console.log(""),console.log("v1.minusEqualsVector(v2): "),e.minusEqualsVector(o),console.log(e.toString()),console.log(""),console.log("v1.normalizeEquals(): "),e.normalizeEquals(),console.log(e.toString())}}class h{#u;#g;#f;#m;constructor(e,t,o,r=1){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new Error("All parameters must be numerical");this.#u=e,this.#g=t,this.#f=o,this.#m=r}getX(){return this.#u}get x(){return this.#u}getY(){return this.#g}get y(){return this.#g}getZ(){return this.#f}get z(){return this.#f}getW(){return this.#m}get w(){return this.#m}toString(){return M("(x, y, z, w) = (%3.5d, %3.5d, %3.5d, %3.5d)",this.#u,this.#g,this.#f,this.#m)}static main(){console.log("Creating vertex v1 = 1, 1, 1, 1");const e=new h(1,1,1);console.log("Checking functions of v1"),console.log(""),console.log("v1.x: "),console.log(e.x),console.log("v1.getX(): "),console.log(e.getX()),console.log(""),console.log("v1.y: "),console.log(e.y),console.log("v1.getY(): "),console.log(e.getY()),console.log(""),console.log("v1.z: "),console.log(e.z),console.log("v1.getZ(): "),console.log(e.getZ()),console.log(""),console.log("v1.w: "),console.log(e.w),console.log("v1.getW(): "),console.log(e.getW()),console.log(""),console.log("v1: "),console.log(e),console.log("v1.toString(): "),console.log(e.toString())}}class c{#w;#x;constructor(e=new Array,t=new Array){if(!Array.isArray(e)||!Array.isArray(t))throw new Error("Vertex and Color index lists must be Array types");for(let t=0;t<e.length;t+=1)if("number"!=typeof e[t]&&null!=typeof e[t])throw new Error("All Vertex indexes must be numerical");for(let e=0;e<t.length;e+=1)if("number"!=typeof t[e]&&null!=typeof t[e])throw new Error("All Color indexes must be numerical");this.#w=e,this.#x=t}static buildIndices(...e){let t=new c;for(let o of e){if("number"!=typeof o)throw new Error("indice "+o+" must be numerical");t.addIndices(o,o)}return t}addIndex(...e){for(let t of e)this.addIndices(t,t)}addIndices(e=0,t=0){if("number"!=typeof e||"number"!=typeof t)throw new Error("Vertex and Color indexes must be numerical");this.#w[this.#w.length]=e,this.#x[this.#x.length]=t}setColorIndices(...e){if(this.#x.length!=e.length)throw new Error("Wront number of color indexes");const t=this.#x.length;for(let o=0;o<e.length;o+=1){if("number"!=typeof e[o])throw this.#x.length=t,new Error("Color index "+o+" is not numerical");this.#x.push(e[o])}this.#x.splice(t,this.#x.length)}setColorIndex(e=0){if("number"!=typeof e)throw new Error("Color index is not numerical");for(let t=0;t<this.#x.length;t+=1)this.#x[t]=e}getVertexIndexList(){return this.#w}get vIndexList(){return this.#w}getColorIndexList(){return this.#x}get cIndexList(){return this.#x}}class u extends c{radius=0;constructor(e=0,t=e){super([e],[t])}toString(){return"Point: (["+this.getVertexIndexList()[0]+"], ["+this.getColorIndexList()[0]+"]) radius = "+this.radius}}class g extends c{constructor(e=new Array(2),t=new Array(2)){if(0==Array.isArray(e)||0==Array.isArray(t))throw new Error("Vertex Index List and Color Index List must be an array. ");if(2!=e.length||2!=t.length)throw new Error("Need 2 points to make a line segment");super(e,t)}static buildVertex(e=0,t=1){return new g(new Array(e,t),new Array(e,t))}static buildVertexColor(e=0,t=1,o=0){return new g(new Array(e,t),new Array(o,o))}static buildVertexColors(e=0,t=1,o=0,r=1){return new g(new Array(e,t),new Array(o,r))}toString(){return"LineSegment: (["+this.getVertexIndexList()[0]+", "+this.getVertexIndexList()[1]+"], ["+this.getColorIndexList()[0]+", "+this.getColorIndexList()[1]+"])"}}function f(e){if(e instanceof i==0)throw new Error("Model is not a Model");let t=!1;0==e.getVertexList().length&&0!=e.getPrimitiveList().length&&(console.log("***WARNING: This model does not have any vertices."),t=!0),0!=e.getVertexList().length&&0==e.getPrimitiveList().length&&(console.log("***WARNING: This model does not have any primitives"),t=!0),0!=e.getVertexList().length&&0==e.getColorList().length&&(console.log("***WARNING: This model does not have any colors."),t=!0),t&&console.log(e.toString())}function m(e){if(e instanceof i==0)throw new Error("Model must be a Model");const t=e.getVertexList().length;let o=!0;for(let r of e.getPrimitiveList())for(let e=0;e<r.getVertexIndexList().length;++e)e>=t&&(console.log("This Primitve has invalid Vertex index: "+e),console.log(r),o=!1);const r=e.getColorList().length;for(let t of e.getPrimitiveList())for(let e=0;e<t.getColorIndexList().length;++e)e>=r&&(console.log("This Primitve has invalid Color index: "+e),console.log(t),o=!1);return o}function w(e,t){if(e instanceof i==0)throw new Error("Model must be a Model");if(t instanceof z==0)throw new Error("Color must be a Color");if(0==e.getColorList().length)for(let o=0;o<e.getVertexList().length;o+=1)e.addColor(t);else for(let o=0;o<e.getColorList().length;o+=1)e.getColorList()[o]=t;for(const o of e.nestedModels)w(o,t)}function x(e){w(e,V())}function b(e){if(e instanceof i==0)throw new Error("Model must be a Model");e.getColorList().length=0;for(let t=0;t<e.getVertexList().length;t+=1)e.addColor(V());for(let t of e.getPrimitiveList())for(let e=0;e<t.getVertexIndexList().length;e+=1)t.getColorIndexList()[e]=t.getVertexIndexList()[e];for(const t of e.nestedModels)b(t)}function v(e){if(e instanceof i==0)throw new Error("Model must be a model");e.getColorList().length=0;let t=0;for(let o of e.getPrimitiveList()){e.addColor(V());for(let e=0;e<o.getColorIndexList().length;e+=1)o.getColorIndexList()[e]=t;++t}for(const t of e.nestedModels)v(t)}function p(e){if(e instanceof i==0)throw new Error("Model must be a Model");e.getColorList().length=0;let t=0;for(let o of e.getPrimitiveList())for(let r=0;r<o.getColorIndexList().length;++r)e.addColor(V()),o.getColorIndexList()[r]=t,++t;for(const t of e.nestedModels)p(t)}function V(){let e=255*Math.random(),t=255*Math.random(),o=255*Math.random();return new z(e,t,o)}function y(e,t=0){if(e instanceof i==0)throw new Error("Model must be a model");if("number"!=typeof t)throw new Error("Point Size must be a number");let o=new Array;for(let t=0;t<e.getVertexList().length;t+=1)o[t]=e.vertexList[t];let r=new Array;for(let t=0;t<e.getColorList().length;t+=1)r[t]=e.colorList[t];let n=new i(o,new Array,r,void 0,void 0,"PointCloud: "+e.getName(),e.visible),s=new Array(e.getVertexList().length),l=new Array(e.getVertexList().length);for(let t of e.getPrimitiveList())for(let e=0;e<t.getVertexIndexList().length;e+=1)s[t.getVertexIndexList()[e]]=!0,l[t.getVertexIndexList()[e]]=t.getColorIndexList()[e];for(let e=0;e<s.length;e+=1)s[e]&&n.addPrimitive(new u(e,l[e]));for(let e of n.getPrimitiveList())e.radius=t;for(const o of e.nestedModels)n.addNestedModel(y(o,t));return n}function M(e,...t){if("string"!=typeof e)throw new Error("Str must be a string");let o="",r=0;for(let i=0;i<e.length;i+=1)if("%"!=e.charAt(i))o+=e.charAt(i);else{let n="";for(;"d"!=e.charAt(++i)&&"f"!=e.charAt(i)&&"s"!=e.charAt(i);)n+=e.charAt(i);n+=e.charAt(i),o+=P(n,t[r++])}return o}function P(e,t){let o="";for(let r=0;r<e.length;r+=1){const i=e.charAt(r);if("d"==i){if("number"!=typeof t)throw new Error("Value must be numerical but got type "+typeof t);return Math.trunc(t).toString()}if("f"==i){if("number"!=typeof t)throw new Error("Value must be numerical but got type "+typeof t);return t.toString()}if("s"==i){if("string"!=typeof t)throw new Error("Value must be string but got type "+typeof t);return t}{let i="0";for(;"."!=e.charAt(r)&&"d"!=e.charAt(r)&&"f"!=e.charAt(r);)i+=e.charAt(r++);if("."==e.charAt(r)){o+=C(i,t,!0);let n=r;for(r+=1;"d"!=e.charAt(r)&&"f"!=e.charAt(r);)n+=1,r+=1;o+=L(e.substring(r,n),t),r+=1}else o+=C(i,t,!1)}}if(t<0&&"-"!=o.charAt(0)){if(o.includes("-")){let e=o.indexOf("-"),t=o.substring(0,e),r=o.substring(e+1,o.length);o=t+"0"+r}o="-"+o.substring(1,o.length)}return o}function C(e,t,o){let r="";o&&(t=Math.trunc(t));let i=Number(e),n=t.toString();if(n.length<i){for(let e=0;e<i-n.length;e+=1)r+="0";r+=n}else n.length-1>=i?r=n.substring(0,i):r+=n;return r}function L(e,t){if(0==e.length)return".";let o=Number(e),r=t.toString(),i="";if(r.includes(".")){if(i=r.substring(r.indexOf(".")+1),i.length>o)i=i.substring(0,o);else if(i.length<o)for(;i.length<o;)i+="0"}else for(;o-- >0;)i+="0";return"."+i}class E{#b;#v;#p;#V;#y;constructor(e,t,o=z.Black){if("number"!=typeof e||"number"!=typeof t)throw new Error("Width and Height must be numerical");o instanceof z==0&&(o=z.Black),this.#b=Math.round(e),this.#v=Math.round(t),this.#p=o,this.#y=new Uint8ClampedArray(this.#b*this.#v*4),this.#V=S.buildParent(this)}static buildFB(e){if(e instanceof E==0)throw new Error("Source is not instance of FrameBuffer");const t=new E(e.getWidthFB(),e.getHeightFB(),e.getBackgroundColorFB());for(let o=0;o<e.getWidthFB();o+=1)for(let r=0;r<e.getHeightFB();r+=1)t.setPixelFB(o,r,e.getPixelFB(o,r));return t}static buildVP(e){if(e instanceof S==0)throw new Error("Source is not instance of Viewport");const t=new E(e.getWidthVP(),e.getHeightVP(),e.getBackgroundColorVP());for(let o=0;o<e.getWidthVP();o+=1)for(let r=0;r<e.getHeightVP();r+=1)t.setPixelFB(o,r,e.getPixelVP(o,r));return t}static async buildFile(e){if("string"!=typeof e)throw new Error("Filename must be a string");try{return document,await E.#M(e)}catch(e){}}static async#M(e){const t=await fetch(e,{method:"GET"}),o=await t.arrayBuffer();return E.interpretData(new Uint8Array(o))}static interpretData(e){let t=0;const o=e[t++],r=e[t++];if("P6"!=String.fromCharCode(o,r))throw new Error("Missing the magic P6");for(;e[t]<48||e[t]>57;)t+=1;let i="";for(;e[t]>=48&&e[t]<=57;)i+=String.fromCharCode(e[t++]);t++;let n="";for(;e[t]>=48&&e[t]<=57;)n+=String.fromCharCode(e[t++]);const s=new E(+i,+n);for(;e[t]<48||e[t]>57;)t+=1;let l="";for(;e[t]>=48&&e[t]<=57;)l+=String.fromCharCode(e[t++]);for(;e[t]<=32;)t+=1;let a=0;for(;t<e.length;t+=3){let o=e[t+0],r=e[t+1],i=e[t+2];const n=255;o<0&&(o+=256),r<0&&(r+=256),i<0&&(i+=256),s.pixelBuffer[a+0]=o,s.pixelBuffer[a+1]=r,s.pixelBuffer[a+2]=i,s.pixelBuffer[a+3]=n,a+=4}return s}getWidthFB(){return this.#b}get width(){return this.#b}getHeightFB(){return this.#v}get height(){return this.#v}getBackgroundColorFB(){return this.#p}get bgColorFB(){return this.#p}setBackgroundColorFB(e){if(e instanceof z==0)throw new Error("Color must be instance of Color");this.#p=e}set bgColorFB(e){if(e instanceof z==0)throw new Error("Color must be instance of Color");this.#p=e}getViewport(){return this.#V}get vp(){return this.#V}get pixelBuffer(){return this.#y}getPixelBuffer(){return this.#y}setViewportDefault(){this.setViewport(this.getWidthFB(),this.getHeightFB())}setViewport(e,t,o=0,r=0,i=this.#p){if("number"!=typeof o||"number"!=typeof r||"number"!=typeof e||"number"!=typeof t)throw new Error("All Parameters must be Numerical");this.#V.setViewport(e,t,o,r,i)}clearFBDefault(){this.clearFB(this.getBackgroundColorFB())}clearFB(e=this.#p){if(e instanceof z==0)throw new Error("Color must be a Color");const t=e.rgb;for(let e=0;e<this.#y.length;e+=4)this.#y[e+0]=t[0],this.#y[e+1]=t[1],this.#y[e+2]=t[2],this.#y[e+3]=t[3]}getPixelFB(e,t){if("number"!=typeof e||"number"!=typeof t)throw new Error("x and y must be numerical");if(e=Math.round(e),(t=Math.round(t))*this.getWidthFB()+e>=this.#y.length)throw new Error("FrameBuffer: Bad pixel coordinate ("+e+", "+t+") [w= "+this.getWidthFB()+", h= "+this.getHeightFB()+"]");const o=4*this.width*t+4*e,r=this.#y[o+0],i=this.#y[o+1],n=this.#y[o+2],s=this.#y[o+3];return new z(r,i,n,s)}setPixelFB(e,t,o=z.Black){if("number"!=typeof e||"number"!=typeof t)throw new Error("X and Y must be Numerical");if(o instanceof z==0)throw new Error("Color must be of type Color");e=Math.round(e),t=Math.round(t);const r=4*this.getWidthFB()*t+4*e;if(r>=this.#y.length)throw new Error("FrameBuffer: Bad pixel coordinate ("+e+", "+t+") [w= "+this.getWidthFB()+", h= "+this.getHeightFB()+"]");const i=o.rgb;this.#y[r+0]=i[0],this.#y[r+1]=i[1],this.#y[r+2]=i[2],this.#y[r+3]=i[3]}convertRed2FB(){const e=E.buildFB(this);for(let t=0;t<this.getWidthFB();t+=1)for(let o=0;o<this.getHeightFB();o+=1){const r=this.getPixelFB(t,o),i=new z(r.getRed(),0,0);e.setPixelFB(t,o,i)}return e}convertGreen2FB(){const e=E.buildFB(this);for(let t=0;t<this.getWidthFB();t+=1)for(let o=0;o<this.getHeightFB();o+=1){const r=this.getPixelFB(t,o),i=new z(0,r.getGreen(),0);e.setPixelFB(t,o,i)}return e}convertBlue2FB(){const e=E.buildFB(this);for(let t=0;t<this.getWidthFB();t+=1)for(let o=0;o<this.getHeightFB();o+=1){const r=this.getPixelFB(t,o),i=new z(0,0,r.getBlue());e.setPixelFB(t,o,i)}return e}toString(){let e="FrameBuffer [w="+this.width+", h="+this.height+"]\n";for(let t=0;t<this.width;++t)e+=" r   g   b |";e+="\n";for(let t=0;t<this.height;++t){for(let o=0;o<this.width;o+=1){const r=this.#y[t*this.width+o],i=this.#y[t*this.width+o],n=this.#y[t*this.width+o],s=this.#y[t*this.width+o],l=new z(r,i,n,s);e+=M("%3d ",l.getRed()),e+=M("%3d ",l.getGreen()),e+=M("%3d|",l.getBlue())}e+="\n"}return e}static main(){}}class S{#P;#C;#L;#E;#S;#z;constructor(e,t,o,r=0,i=0,n=z.Black){if("number"!=typeof r||"number"!=typeof i||"number"!=typeof e||"number"!=typeof t)throw new Error("upperLeftX, upperLeftY, width, height must be numerical");if(o instanceof E==0)throw new Error("Parent is required and must be a FrameBuffer");n instanceof z==0&&(n=z.Black),this.#S=n,this.#z=o,this.setViewport(e,t,r,i,this.#S)}static buildParent(e){if(e instanceof E==0)throw new Error("Parent is required and must be a FrameBuffer");return new S(e.getWidthFB(),e.getHeightFB(),e,0,0,e.getBackgroundColorFB())}static buildFB(e,t,o=0,r=0){if("number"!=typeof o||"number"!=typeof r)throw new Error("UpperLeftX and UpperleftY must be numerical.");if(e instanceof E==0)throw new Error("Source must be of type FrameBuffer");if(t instanceof E==0)throw new Error("Parent is required and must be a framebuffer");const i=new S(e.getWidthFB(),e.getHeightFB(),t,o,r,e.getBackgroundColorFB());for(let t=0;t<e.getWidthFB();t+=1)for(let o=0;o<e.getHeightFB();o+=1)i.setPixelVP(t,o,e.getPixelFB(t,o));return i}static buildVP(e,t,o=0,r=0){if("number"!=typeof o||"number"!=typeof r)throw new Error("UpperLeftX and UpperleftY must be numerical.");if(e instanceof S==0)throw new Error("Source must be of type FrameBuffer");if(t instanceof E==0)throw new Error("Parent is required and must be a framebuffer");const i=new S(e.getWidthVP(),e.getHeightVP(),t,o,r,e.getBackgroundColorVP());for(let t=0;t<e.getWidthVP();t+=1)for(let o=0;o<e.getHeightVP();o+=1)i.setPixelVP(t,o,e.getPixelVP(t,o));return i}setViewport(e,t,o=0,r=0,i){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new Error("All parameters must be numerical.");if(i instanceof z==0)throw new Error("Background Color must be a Color");o=Math.round(o),r=Math.round(r),e=Math.round(e),t=Math.round(t),this.#P=o,this.#C=r,this.#L=this.#P+e,this.#E=this.#C+t,this.#S=i,this.clearVP()}getFrameBuffer(){return this.#z}framebuffer=()=>this.#z;get parent(){return this.#z}getWidthVP(){return this.#L-this.#P}get width(){return this.#L-this.#P}getHeightVP(){return this.#E-this.#C}get height(){return this.#E-this.#C}getBackgroundColorVP(){return this.#S}get bgColorVP(){return this.#S}get vp_ul_x(){return this.#P}get vp_ul_y(){return this.#C}get vp_lr_x(){return this.#L}get vp_lr_y(){return this.#E}setBackgroundColorVP(e){if(e instanceof z==0)throw new Error("Color is not of type Color");this.#S=e}set bgColorVP(e){if(e instanceof z==0)throw new Error("Color must be an intance of Color");this.#S=e}clearVPDefault(){this.clearVP(this.getBackgroundColorVP())}clearVP(e=this.#S){if(e instanceof z==0)throw new Error("Color is not of type Color");const t=e.rgb;for(let e=0;e<this.height;e+=1){let o=this.#C*(4*this.parent.width)+e*this.parent.width*4;for(let e=4*this.#P;e<4*(this.width+this.#P);e+=4){const r=o+e;this.parent.pixelBuffer[r+0]=t[0],this.parent.pixelBuffer[r+1]=t[1],this.parent.pixelBuffer[r+2]=t[2],this.parent.pixelBuffer[r+3]=t[3]}}}getPixelVP(e,t){if("number"!=typeof e||"number"!=typeof t)throw new Error("X and Y must be numerical");return e=Math.round(e),t=Math.round(t),this.#z.getPixelFB(this.#P+e,this.#C+t)}setPixelVP(e,t,o=z.black){if("number"!=typeof e||"number"!=typeof t)throw new Error("X and Y must be numerical");if(o instanceof z==0)throw new Error("Color must be a Color");e=Math.round(e),t=Math.round(t),this.#z.setPixelFB(this.#P+e,this.#C+t,o)}convertVP2FB(){return E.buildVP(this)}dumpVP2File(e){if("string"!=typeof e)throw new Error("Filename must be a String");this.#z.dumpPixels2File(this.#P,this.#C,this.#L,this.#E,e)}toString(){let e="Viewport [w="+this.width+", h="+this.height+"]\n";for(let t=0;t<this.width;++t)e+=" r   g   b |";e+="\n";for(let t=0;t<this.height;++t){for(let o=0;o<this.width;++o){const r=this.getPixelVP(o,t),i=z.buildColor(r);e+=M("%3d ",i.getRed()),e+=M("%3d ",i.getGreen()),e+=M("%3d|",i.getBlue())}e+="\n"}return e}static main(){const e=new E(10,10);console.log("creating vp1 = new VP(3, 3, fb = new FrameBuffer(10, 10), 4, 4, color.orange)");const t=new S(3,3,e,4,4,z.orange);console.log("creating vp2 = VP.buildParent()");const o=S.buildParent(e);console.log("creating vp3 = vP.buildFB");const r=S.buildFB(new E(5,5),e,2,2);console.log("creating vp4 = vp.buildVP");const i=S.buildVP(t,e,0,0);console.log(""),console.log("vp1.getFramebuffer()"),console.log(t.getFrameBuffer().toString()),console.log(""),console.log("vp2.framebuffer()"),console.log(o.framebuffer().toString()),console.log(""),console.log("vp3.parent"),console.log(r.parent.toString()),console.log(""),console.log("vp1.getWidthVP()"),console.log(t.getWidthVP()),console.log(""),console.log("vp1.getHeightVP()"),console.log(t.getHeightVP()),console.log(""),console.log("vp4.width"),console.log(i.width),console.log(""),console.log("vp4.height"),console.log(i.height),console.log(""),console.log("vp2.getBackGroundColorVP()"),console.log(o.getBackgroundColorVP().toString()),console.log(""),console.log("vp3.bgColorVP"),console.log(r.bgColorVP.toString()),console.log(""),console.log("vp3.setBackGroundColorVP(Color.Green"),r.setBackgroundColorVP(z.Green),console.log(r.toString()),console.log(""),console.log("vp3.clearVPDefault()"),r.clearVPDefault(),console.log(r.toString()),console.log(""),console.log("vp2.setPixelVP(1, 1, Color.PINK)"),o.setPixelVP(1,1,z.Pink),console.log(o.toString()),console.log(""),console.log("vp2.getPixelVP(1, 1"),console.log(o.getPixelVP(1,1).toString()),console.log(""),console.log("vp1.dumpVP2File(VP1.ppm)"),t.dumpVP2File("VP1.ppm"),console.log(""),console.log("vp2.dumpVP2File(VP2.ppm)"),o.dumpVP2File("VP2.ppm"),console.log(""),console.log("vp3.dumpVP2File(VP3.ppm)"),r.dumpVP2File("VP3.ppm"),console.log(""),console.log("vp4.dumpVP2File(VP4.ppm)"),i.dumpVP2File("VP4.ppm"),console.log(""),console.log("vp1.convertVP2FB()"),console.log(t.convertVP2FB().toString())}}class z{#A=new Uint8ClampedArray(4);static GAMMA=1/2.2;static black=new z;static BLACK=new z;static Black=new z;static white=new z(255,255,255);static WHITE=new z(255,255,255);static White=new z(255,255,255);static red=new z(255,0,0);static RED=new z(255,0,0);static Red=new z(255,0,0);static green=new z(0,255,0);static GREEN=new z(0,255,0);static Green=new z(0,255,0);static blue=new z(0,0,255);static BLUE=new z(0,0,255);static Blue=new z(0,0,255);static orange=new z(255,127,0);static ORANGE=new z(255,127,0);static Orange=new z(255,127,0);static yellow=new z(255,255,0);static YELLOW=new z(255,255,0);static Yellow=new z(255,255,0);static pink=new z(255,192,203);static PINK=new z(255,192,203);static Pink=new z(255,192,203);static cyan=new z(0,255,255);static CYAN=new z(0,255,255);static Cyan=new z(0,255,255);static magenta=new z(255,0,255);static MAGENTA=new z(255,0,255);static Magenta=new z(255,0,255);static gray=new z(192,192,192);static GRAY=new z(192,192,192);static Gray=new z(192,192,192);constructor(e=0,t=0,o=0,r=255){if("number"!=typeof e||"number"!=typeof t||"number"!=typeof o||"number"!=typeof r)throw new Error("All parameters must be numeric");this.#A[0]=e,this.#A[1]=t,this.#A[2]=o,this.#A[3]=r}static buildColor(e){if(e instanceof z==0)throw new Error("color is not of type Color");return new z(e.#A[0],e.#A[1],e.#A[2],e.#A[3])}static buildRGBA(e){if(e instanceof Uint8ClampedArray==0)throw new Error("RGBA needs to be a uint8clamped array");return new z(e[0],e[1],e[2],e[3])}static buildAlpha(e,t){if(e instanceof z==0)throw new Error("Color is not of type Color");if("number"!=typeof t)throw new Error("Alpha is not numerical");return new z(e.#A[0],e.#A[1],e.#A[2],t)}static blendColor(e,t){return z.blendColorWeight(e,t,e.getAlpha()/(e.getAlpha()+t.getAlpha()))}static blendColorWeight(e,t,o=.5){if(e instanceof z==0||t instanceof z==0)throw new Error("C1 and C2 are not of type color");if("number"!=typeof o)throw new Error("c1Weight is not numerical");if(!(o>=0&&o<=1))throw new Error("c1Weight has to be in the range 0 to 1 inclusive");const r=o*e.getRed()+(1-o)*t.getRed(),i=o*e.getGreen()+(1-o)*t.getGreen(),n=o*e.getBlue()+(1-o)*t.getBlue();return new z(r,i,n,255)}darker(e=.1){return this.#B(1-e)}lighter(e=.1){return this.#B(1+e)}brighter(e=.1){return this.#B(1+e)}#B(e){return new z(this.#A[0]*e,this.#A[1]*e,this.#A[2]*e,this.#A[3])}getRed(){return this.#A[0]}getGreen(){return this.#A[1]}getBlue(){return this.#A[2]}getAlpha(){return this.#A[3]}setAlpha(e){if("number"!=typeof e)throw new Error("a is not numerical");if(e<0||e>255)throw new Error("a is supposed to be between 0 and 255 inclusive");this.#A[3]=Math.round(e)}getRGBComponents(){return this.#A}get rgb(){return this.#A}toString(){return M("(r, g, b): (%3d, %3d, %3d)",this.#A[0],this.#A[1],this.#A[2])}static main(){}static applyGamma(e){if(e instanceof z==0)throw new Error("Color is not of type Color");const t=255*Math.pow(e.getRed()/255,z.GAMMA),o=255*Math.pow(e.getGreen()/255,z.GAMMA),r=255*Math.pow(e.getBlue()/255,z.GAMMA);return new z(t,o,r)}static hexToRgba(e){return e.match(/^#[A-Fa-f0-9]{6}/)?new Array([parseInt(e.substring(1,3),16),parseInt(e.substring(3,5),16),parseInt(e.substring(5,7),16),255]):new Array([0,0,0,255])}static RgbToHex(e){if(e instanceof z==0)throw new Error("Color is not of type Color");return"#"+z.intToHex(e[0])+z.intToHex(e[1])+z.intToHex(e[2])}static intToHex(e){return e<10?"0"+e.toString(16):e.toString(16)}}class A extends i{constructor(e=-1,t=1,o=-1,r=1,i=5,n=5,s=z.white,l=z.white,a=0){super(void 0,void 0,void 0,void 0,void 0,M("Axes 2D(%.2f,%.2f,%.2f,%.2f)",e,t,o,r)),this.addColor(s,l),this.addVertex(new h(e,0,a),new h(t,0,a)),this.addPrimitive(g.buildVertexColor(0,1,0)),this.addVertex(new h(0,o,a),new h(0,r,a)),this.addPrimitive(g.buildVertexColor(2,3,1));let d=4,c=(t-e)/i,u=(r-o)/50;for(let o=e;o<=t;o+=c)this.addVertex(new h(o,u/2,a),new h(o,-u/2,a)),this.addPrimitive(g.buildVertexColor(d+0,d+1,0)),d+=2;u=(r-o)/n,c=(t-e)/50;for(let e=o;e<=r;e+=u)this.addVertex(new h(c/2,e,a),new h(-c/2,e,a)),this.addPrimitive(g.buildVertexColor(d+0,d+1,1)),d+=2}}class B extends i{constructor(e=-1,t=1,o=-1,r=1,i=-1,n=1,s=z.white,l=s,a=s){super(void 0,void 0,void 0,void 0,void 0,M("Axes 3D(%.2f,%.2f,%.2f,%.2f%.2f,%.2f)",e,t,o,r,i,n)),this.addVertex(new h(e,0,0),new h(t,0,0),new h(0,o,0),new h(0,r,0),new h(0,0,i),new h(0,0,n)),this.addPrimitive(g.buildVertexColor(0,1,0),g.buildVertexColor(2,3,1),g.buildVertexColor(4,5,2)),this.addColor(s,l,a)}}class F extends i{#F;#I;constructor(e,t=0){if(super(void 0,void 0,void 0,void 0,void 0,M("Barycentric Triangle(%.2f,%d)",t,e),!0),e<0)throw new Error("n must be greater than or equal to 0");this.#F=t,this.#I=e;let o=t*Math.PI/180,r=2*Math.PI/3;this.addVertex(new h(Math.cos(o),Math.sin(o),0),new h(Math.cos(o+r),Math.sin(o+r),0),new h(Math.cos(o+2*r),Math.sin(o+2*r),0)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0)),e>0&&this.barycentric(0,1,2,e)}barycentric(e,t,o,r){const i=this.vertexList[e],n=this.vertexList[t],s=this.vertexList[o],l=this.vertexList.length;if(r>0){this.addVertex(new h((i.x+n.x+s.x)/3,(i.y+n.y+s.y)/3,(i.z+n.z+s.z)/3)),this.addVertex(new h((i.x+n.x)/2,(i.y+n.y)/2,(i.z+n.z)/2)),this.addVertex(new h((n.x+s.x)/2,(n.y+s.y)/2,(n.z+s.z)/2)),this.addVertex(new h((s.x+i.x)/2,(s.y+i.y)/2,(s.z+i.z)/2));const a=l,d=l+1,c=l+2,u=l+3;this.addPrimitive(g.buildVertex(e,a),g.buildVertex(t,a),g.buildVertex(o,a),g.buildVertex(d,a),g.buildVertex(c,a),g.buildVertex(u,a)),this.barycentric(e,d,a,r-1),this.barycentric(e,u,a,r-1),this.barycentric(t,d,a,r-1),this.barycentric(t,c,a,r-1),this.barycentric(o,c,a,r-1),this.barycentric(o,u,a,r-1)}}getHorizCount(){return this.#I}getVertCount(){return Math.round(this.#F)}remake(e,t){return new F(e,t)}}class I extends i{constructor(e=1,t=1,o=1){super(void 0,void 0,void 0,void 0,void 0,M("Box(%.2f,%.2f,%.2f)",e,t,o)),this.addVertex(new h(0,0,0),new h(0+e,0,0),new h(0+e,0,0+o),new h(0,0,0+o),new h(0,0+t,0),new h(0+e,0+t,0),new h(0+e,0+t,0+o),new h(0,0+t,0+o)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0),g.buildVertex(4,5),g.buildVertex(5,6),g.buildVertex(6,7),g.buildVertex(7,4),g.buildVertex(0,4),g.buildVertex(1,5),g.buildVertex(2,6),g.buildVertex(3,7))}}class N extends i{#N;#_;#k;#I;constructor(e=1,t=0,o=Math.PI,r=8,i=M("CircleSector(%.2f,%.2f,%.2f,%d)",e,t,o,r)){if(super(void 0,void 0,void 0,void 0,void 0,i),r<4)throw new Error("n must be greater than 3");t%=2*Math.PI,o%=2*Math.PI,t<0&&(t=2*Math.PI+t),o<0&&(o=2*Math.PI+o),o<=t&&(o+=2*Math.PI),this.#N=e,this.#_=t,this.#k=o,this.#I=r;const n=(o-t)/(r-1);for(let o=0;o<r;++o){const r=Math.cos(t+o*n),i=Math.sin(t+o*n);this.addVertex(new h(e*r,e*i,0))}for(let e=0;e<r-1;++e)this.addPrimitive(g.buildVertex(e,e+1))}getHorizCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=e;return e==this.#I&&(o=t),new N(this.#N,this.#_,this.#k,o)}}class _ extends N{constructor(e=1,t=16){super(e,0,360,16,M("Circle(%f.2,%d)",e,t))}}class k extends i{#q;#R;#T;#I;#G;constructor(e=1,t=.5,o=.5,r=7,i=16){if(super(void 0,void 0,void 0,void 0,void 0,M("Cone Frustum(%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i)),r<2)throw new Error("n must be greater than 1");if(i<3)throw new Error("k must be greater than 2");this.#q=e,this.#R=o,this.#T=t,this.#I=r,this.#G=i;const n=t/(r-1),s=2*Math.PI/i,l=new Array(r);for(let e=0;e<l.length;e+=1)l[e]=new Array(i);let a=0;for(let d=0;d<i;++d){const i=Math.cos(d*s),c=Math.sin(d*s);for(let s=0;s<r;++s){const u=s/(r-1)*e+(1-s/(r-1))*o;this.addVertex(new h(u*i,t-s*n,u*c)),l[s][d]=a,++a}}this.addVertex(new h(0,t,0));const d=a;++a,this.addVertex(new h(0,0,0));const c=a;++a;for(let e=0;e<r;++e){for(let t=0;t<i-1;++t)this.addPrimitive(g.buildVertex(l[e][t],l[e][t+1]));this.addPrimitive(g.buildVertex(l[e][i-1],l[e][0]))}for(let e=0;e<i;++e)this.addPrimitive(g.buildVertex(d,l[0][e])),this.addPrimitive(g.buildVertex(l[0][e],l[r-1][e])),this.addPrimitive(g.buildVertex(l[r-1][e],c))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new k(this.#q,this.#T,this.#R,e,t)}}class q extends i{#N;#T;#H;#_;#k;#I;#G;constructor(e=1,t=1,o=1,r=Math.PI/2,i=3*Math.PI/2,n=16,s=8,l=M("Cone Sector(%.2f,%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i,n,s)){if(super(void 0,void 0,void 0,void 0,void 0,l),n<2)throw new Error("n must be greater than 1");if(s<4)throw new Error("k must be greater than 3");if(t<o)throw new Error("h must be greater than or equal to t");r%=2*Math.PI,i%=2*Math.PI,r<0&&(r=2*Math.PI+r),i<0&&(i=2*Math.PI+i),i<=r&&(i+=2*Math.PI),this.#N=e,this.#T=t,this.#H=o,this.#_=r,this.#k=i,this.#I=n,this.#G=s;const a=o/(n-1),d=(i-r)/(s-1),c=new Array(n);for(let e=0;e<c.length;e+=1)c[e]=new Array(s);let u=0;for(let o=0;o<s;++o){const i=Math.cos(r+o*d),s=Math.sin(r+o*d);for(let r=0;r<n;++r){const n=e*(1-r*a/t);this.addVertex(new h(n*i,r*a,n*s)),c[r][o]=u++}}this.addVertex(new h(0,0,0));const f=u;++u;for(let e=0;e<n;++e)for(let t=0;t<s-1;++t)this.addPrimitive(g.buildVertex(c[e][t],c[e][t+1]));for(let e=0;e<s;++e){this.addPrimitive(g.buildVertex(f,c[0][e]));for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(c[t][e],c[t+1][e]))}}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new q(this.#N,this.#T,this.#H,this.#_,this.#k,e,t)}}class R extends q{constructor(e=1,t=1,o=15,r=6){super(e,t,t,0,360,o,r,M("Cone(%.2f,%.2f,%d,%d)",e,t,o,r))}}class T extends i{constructor(e="Cube"){super(void 0,void 0,void 0,void 0,void 0,e),this.addVertex(new h(-1,-1,-1),new h(1,-1,-1),new h(1,-1,1),new h(-1,-1,1),new h(-1,1,-1),new h(1,1,-1),new h(1,1,1),new h(-1,1,1)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0),g.buildVertex(4,5),g.buildVertex(5,6),g.buildVertex(6,7),g.buildVertex(7,4),g.buildVertex(0,4),g.buildVertex(1,5),g.buildVertex(2,6),g.buildVertex(3,7))}}class G extends i{constructor(e=1,t=1,o=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Cube2(%d,%d,%d)",e,t,o)),e<0)throw new Error("xGrid must be greater than or equal to 0");if(t<0)throw new Error("yGrid must be greater than or equal to 0");if(o<0)throw new Error("zGrid must be greater than or equal to 0");const r=2/(1+e),i=2/(1+t),n=2/(1+o);let s=-1;for(let l=0;l<=e+1;++l){const e=this.vertexList.length;let l=1;for(let e=0;e<=t;++e)this.addVertex(new h(s,l,1)),l-=i;let a=1;for(let e=0;e<=o;++e)this.addVertex(new h(s,-1,a)),a-=n;l=-1;for(let e=0;e<=t;++e)this.addVertex(new h(s,l,-1)),l+=i;a=-1;for(let e=0;e<=o+1;++e)this.addVertex(new h(s,1,a)),a+=n;const d=this.vertexList.length;for(let t=e;t<d-1;++t)this.addPrimitive(g.buildVertex(t,t+1));s+=r}let l=-1;for(let s=0;s<=t+1;++s){const t=this.vertexList.length;let s=1;for(let t=0;t<=e;++t)this.addVertex(new h(s,l,1)),s-=r;let a=1;for(let e=0;e<=o;++e)this.addVertex(new h(-1,l,a)),a-=n;s=-1;for(let t=0;t<=e;++t)this.addVertex(new h(s,l,-1)),s+=r;a=-1;for(let e=0;e<=o+1;++e)this.addVertex(new h(1,l,a)),a+=n;const d=this.vertexList.length;for(let e=t;e<d-1;++e)this.addPrimitive(g.buildVertex(e,e+1));l+=i}let a=-1;for(let s=0;s<=o+1;++s){const o=this.vertexList.length;let s=1;for(let t=0;t<=e;++t)this.addVertex(new h(s,1,a)),s-=r;let l=1;for(let e=0;e<=t;++e)this.addVertex(new h(-1,l,a)),l-=i;s=-1;for(let t=0;t<=e;++t)this.addVertex(new h(s,-1,a)),s+=r;l=-1;for(let e=0;e<=t+1;++e)this.addVertex(new h(1,l,a)),l+=i;const d=this.vertexList.length;for(let e=o;e<d-1;++e)this.addPrimitive(g.buildVertex(e,e+1));a+=n}}}class H extends T{constructor(e=1,t=1,o=1){if(super(M("Cube3(%d,%d,%d)",e,t,o)),e<1)throw new Error("xCount must be greater than or equal to 1");if(t<1)throw new Error("yCount must be greater than or equal to 1");if(o<1)throw new Error("zCount must be greater than or equal to 1");let r=8;const i=2/e,n=2/t,s=2/o;this.addVertex(new h(0,0,1),new h(0,0,-1),new h(0,1,0),new h(0,-1,0),new h(1,0,0),new h(-1,0,0));const l=r,a=r+1,d=r+2,c=r+3,u=r+4,f=r+5;r+=6;let m=-1;for(let t=0;t<=e;++t)this.addVertex(new h(m,1,1),new h(m,-1,1),new h(m,1,-1),new h(m,-1,-1)),this.addPrimitive(g.buildVertex(r+0,l),g.buildVertex(r+1,l)),this.addPrimitive(g.buildVertex(r+2,a),g.buildVertex(r+3,a)),this.addPrimitive(g.buildVertex(r+0,d),g.buildVertex(r+2,d)),this.addPrimitive(g.buildVertex(r+1,c),g.buildVertex(r+3,c)),m+=i,r+=4;let w=-1;for(let e=0;e<=t;++e)this.addVertex(new h(1,w,1),new h(-1,w,1),new h(1,w,-1),new h(-1,w,-1)),this.addPrimitive(g.buildVertex(r+0,l),g.buildVertex(r+1,l)),this.addPrimitive(g.buildVertex(r+2,a),g.buildVertex(r+3,a)),this.addPrimitive(g.buildVertex(r+0,u),g.buildVertex(r+2,u)),this.addPrimitive(g.buildVertex(r+1,f),g.buildVertex(r+3,f)),w+=n,r+=4;let x=-1;for(let e=0;e<=o;++e)this.addVertex(new h(1,1,x),new h(-1,1,x),new h(1,-1,x),new h(-1,-1,x)),this.addPrimitive(g.buildVertex(r+0,d),g.buildVertex(r+1,d)),this.addPrimitive(g.buildVertex(r+2,c),g.buildVertex(r+3,c)),this.addPrimitive(g.buildVertex(r+0,u),g.buildVertex(r+2,u)),this.addPrimitive(g.buildVertex(r+1,f),g.buildVertex(r+3,f)),x+=s,r+=4}}class W extends i{constructor(e=2,t=1,o=2){if(super(void 0,void 0,void 0,void 0,void 0,M("Cube4(%d,%d,%d)",e,t,o)),e<1)throw new Error("xCount must be greater than or equal to 1");if(t<0)throw new Error("yGrid must be greater than or equal to 0");if(o<1)throw new Error("zCount must be greater than or equal to 1");const r=2/e,i=2/(1+t),n=2/o,s=new Array(2+t);for(let t=0;t<s.length;t+=1)s[t]=new Array(2*e+2*o);for(let l=0;l<2+t;++l){for(let t=0;t<e;++t)s[l][t]=new h(t*r-1,l*i-1,-1);for(let t=0;t<o;++t)s[l][e+t]=new h(1,l*i-1,t*n-1);for(let t=0;t<e;++t)s[l][e+o+t]=new h(1-t*r,l*i-1,1);for(let t=0;t<o;++t)s[l][2*e+o+t]=new h(-1,l*i-1,1-t*n)}for(let r=0;r<2+t;++r)for(let t=0;t<2*e+2*o;++t)this.addVertex(s[r][t]);this.addVertex(new h(0,-1,0),new h(0,1,0));const l=(2+t)*(2*e+2*o),a=l+1;for(let r=0;r<2*e+2*o;++r)this.addPrimitive(g.buildVertex(l,r),g.buildVertex(a,(t+1)*(2*e+2*o)+r));for(let r=0;r<2+t;++r){for(let t=0;t<2*e+2*o-1;++t)this.addPrimitive(g.buildVertex(r*(2*e+2*o)+t,r*(2*e+2*o)+t+1));this.addPrimitive(g.buildVertex((1+r)*(2*e+2*o)-1,r*(2*e+2*o)))}for(let r=0;r<2*e+2*o;++r)for(let i=0;i<2+t-1;++i)this.addPrimitive(g.buildVertex(i*(2*e+2*o)+r,(i+1)*(2*e+2*o)+r))}}class O extends i{#N;#T;#_;#k;#I;#G;constructor(e=1,t=1,o=Math.PI/2,r=3*Math.PI/2,i=15,n=8,s=M("Cylinder Sector(%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i,n)){if(super(void 0,void 0,void 0,void 0,void 0,s),i<2)throw new Error("n must be greater than 1");if(n<4)throw new Error("k must be greater than 3");o%=2*Math.PI,r%=2*Math.PI,o<0&&(o=2*Math.PI+o),r<0&&(r=2*Math.PI+r),r<=o&&(r+=2*Math.PI),this.#N=e,this.#T=t,this.#_=o,this.#k=r,this.#I=i,this.#G=n;const l=2*t/(i-1),a=(r-o)/(n-1),d=new Array(i);for(let e=0;e<d.length;e+=1)d[e]=new Array(n);for(let r=0;r<n;++r){const n=Math.cos(o+r*a),s=Math.sin(o+r*a);for(let o=0;o<i;++o)d[o][r]=new h(e*n,t-o*l,-e*s)}const c=new h(0,t,0),u=new h(0,-t,0);for(let e=0;e<i;++e)for(let t=0;t<n;++t)this.addVertex(d[e][t]);this.addVertex(c,u);const f=i*n,m=i*n+1;for(let e=0;e<i;++e)for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(e*n+t,e*n+(t+1)));for(let e=0;e<n;++e){this.addPrimitive(g.buildVertex(f,0*n+e));for(let t=0;t<i-1;++t)this.addPrimitive(g.buildVertex(t*n+e,(t+1)*n+e));this.addPrimitive(g.buildVertex((i-1)*n+e,m))}}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new O(this.#N,this.#T,this.#_,this.#k,e,t)}}class Y extends O{constructor(e=1,t=1,o=15,r=16){super(e,t,0,2*Math.PI,o,r,M("Cylinder(%.2f,%.2f,%d,%d)",e,t,o,r))}}class D extends i{#N;#_;#k;#I;#G;constructor(e=1,t=0,o=Math.PI,r=6,i=8,n=M("Disk Sector(%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i)){if(super(void 0,void 0,void 0,void 0,void 0,n),r<1)throw new Error("n must be greater than 0");if(i<4)throw new Error("k must be greater than 3");t%=2*Math.PI,o%=2*Math.PI,t<0&&(t=2*Math.PI+t),o<0&&(o=2*Math.PI+o),o<=t&&(o+=2*Math.PI),this.#N=e,this.#_=t,this.#k=o,this.#I=r,this.#G=i;const s=e/r,l=(o-t)/(i-1),a=new Array(r);for(let e=0;e<a.length;e+=1)a[e]=new Array(i);for(let e=0;e<i;++e){const o=Math.cos(t+e*l),i=Math.sin(t+e*l);for(let t=0;t<r;++t){const r=(t+1)*s;a[t][e]=new h(r*o,r*i,0)}}const d=new h(0,0,0);for(let e=0;e<r;++e)for(let t=0;t<i;++t)this.addVertex(a[e][t]);this.addVertex(d);const c=r*i;for(let e=0;e<i;++e){this.addPrimitive(g.buildVertex(c,0*i+e));for(let t=0;t<r-1;++t)this.addPrimitive(g.buildVertex(t*i+e,(t+1)*i+e))}for(let e=0;e<r;++e)for(let t=0;t<i-1;++t)this.addPrimitive(g.buildVertex(e*i+t,e*i+(t+1)))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new D(this.#N,this.#_,this.#k,e,t)}}class j extends D{constructor(e=1,t=6,o=12){super(e,0,2*Math.PI,t,o,M("Disk(%.2f,%d,%d)",e,t,o))}}class X extends i{constructor(){super(void 0,void 0,void 0,void 0,void 0,"Dodecahedron");const e=1/((1+Math.sqrt(5))/2),t=e*e;this.addVertex(new h(-e,-e,-e),new h(-e,-e,e),new h(-e,e,-e),new h(-e,e,e),new h(e,-e,-e),new h(e,-e,e),new h(e,e,-e),new h(e,e,e)),this.addVertex(new h(0,-t,-1),new h(0,-t,1),new h(0,t,-1),new h(0,t,1)),this.addVertex(new h(-t,-1,0),new h(-t,1,0),new h(t,-1,0),new h(t,1,0)),this.addVertex(new h(-1,0,-t),new h(1,0,-t),new h(-1,0,t),new h(1,0,t)),this.addPrimitive(g.buildVertex(3,11),g.buildVertex(11,7),g.buildVertex(7,15),g.buildVertex(15,13),g.buildVertex(13,3)),this.addPrimitive(g.buildVertex(7,19),g.buildVertex(19,17),g.buildVertex(17,6),g.buildVertex(6,15)),this.addPrimitive(g.buildVertex(17,4),g.buildVertex(4,8),g.buildVertex(8,10),g.buildVertex(10,6)),this.addPrimitive(g.buildVertex(8,0),g.buildVertex(0,16),g.buildVertex(16,2),g.buildVertex(2,10)),this.addPrimitive(g.buildVertex(0,12),g.buildVertex(12,1),g.buildVertex(1,18),g.buildVertex(18,16)),this.addPrimitive(g.buildVertex(2,13)),this.addPrimitive(g.buildVertex(18,3)),this.addPrimitive(g.buildVertex(1,9),g.buildVertex(9,11)),this.addPrimitive(g.buildVertex(4,14),g.buildVertex(14,12)),this.addPrimitive(g.buildVertex(9,5),g.buildVertex(5,19)),this.addPrimitive(g.buildVertex(5,14))}}class Z extends i{constructor(){super(void 0,void 0,void 0,void 0,void 0,"Icosahedron");const e=1/((1+Math.sqrt(5))/2);this.addVertex(new h(-e,1,0),new h(e,1,0),new h(-e,-1,0),new h(e,-1,0),new h(0,-e,1),new h(0,e,1),new h(0,-e,-1),new h(0,e,-1),new h(1,0,-e),new h(1,0,e),new h(-1,0,-e),new h(-1,0,e)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(0,5),g.buildVertex(0,7),g.buildVertex(0,11),g.buildVertex(0,10),g.buildVertex(1,5),g.buildVertex(1,7),g.buildVertex(1,9),g.buildVertex(1,8),g.buildVertex(5,11),g.buildVertex(5,9),g.buildVertex(5,4),g.buildVertex(7,10),g.buildVertex(7,8),g.buildVertex(7,6),g.buildVertex(11,10),g.buildVertex(11,4),g.buildVertex(11,2),g.buildVertex(9,8),g.buildVertex(9,4),g.buildVertex(9,3),g.buildVertex(10,6),g.buildVertex(10,2),g.buildVertex(8,6),g.buildVertex(8,3),g.buildVertex(4,2),g.buildVertex(4,3),g.buildVertex(6,2),g.buildVertex(6,3),g.buildVertex(2,3))}}class U extends i{constructor(){super(void 0,void 0,void 0,void 0,void 0,"Icosidodecahedron");const e=(1+Math.sqrt(5))/2-1;this.addVertex(new h(0,0,1.051462),new h(e,0,.8506508),new h(.2763932,.5527864,.8506508),new h(-e,0,.8506508),new h(-.2763932,-.5527864,.8506508),new h(1,0,.3249197),new h(.7236068,-.5527864,.5257311),new h(-.1708204,.8944272,.5257311),new h(.4472136,.8944272,.3249197),new h(-1,0,.3249197),new h(-.7236068,.5527864,.5257311),new h(.1708204,-.8944272,.5257311),new h(-.4472136,-.8944272,.3249197),new h(1,0,-.3249197),new h(.8944272,.5527864,0),new h(.5527864,-.8944272,0),new h(-.5527864,.8944272,0),new h(.4472136,.8944272,-.3249197),new h(-1,0,-.3249197),new h(-.8944272,-.5527864,0),new h(-.4472136,-.8944272,-.3249197),new h(e,0,-.8506508),new h(.7236068,-.5527864,-.5257311),new h(.1708204,-.8944272,-.5257311),new h(-.7236068,.5527864,-.5257311),new h(-.1708204,.8944272,-.5257311),new h(.2763932,.5527864,-.8506508),new h(-e,0,-.8506508),new h(-.2763932,-.5527864,-.8506508),new h(0,0,-1.051462)),this.addPrimitive(g.buildVertex(0,2),g.buildVertex(2,7),g.buildVertex(7,10),g.buildVertex(10,3),g.buildVertex(3,0),g.buildVertex(0,4),g.buildVertex(4,11),g.buildVertex(11,6),g.buildVertex(6,1),g.buildVertex(1,0),g.buildVertex(1,5),g.buildVertex(5,14),g.buildVertex(14,8),g.buildVertex(8,2),g.buildVertex(2,1),g.buildVertex(3,9),g.buildVertex(9,19),g.buildVertex(19,12),g.buildVertex(12,4),g.buildVertex(4,3),g.buildVertex(5,6),g.buildVertex(6,15),g.buildVertex(15,22),g.buildVertex(22,13),g.buildVertex(13,5),g.buildVertex(7,8),g.buildVertex(8,17),g.buildVertex(17,25),g.buildVertex(25,16),g.buildVertex(16,7),g.buildVertex(9,10),g.buildVertex(10,16),g.buildVertex(16,24),g.buildVertex(24,18),g.buildVertex(18,9),g.buildVertex(11,12),g.buildVertex(12,20),g.buildVertex(20,23),g.buildVertex(23,15),g.buildVertex(15,11),g.buildVertex(13,21),g.buildVertex(21,26),g.buildVertex(26,17),g.buildVertex(17,14),g.buildVertex(14,13),g.buildVertex(18,27),g.buildVertex(27,28),g.buildVertex(28,20),g.buildVertex(20,19),g.buildVertex(19,18),g.buildVertex(21,22),g.buildVertex(22,23),g.buildVertex(23,28),g.buildVertex(28,29),g.buildVertex(29,21),g.buildVertex(24,25),g.buildVertex(25,26),g.buildVertex(26,29),g.buildVertex(29,27),g.buildVertex(27,24))}}class K extends i{#W;#O;#Y;constructor(e,t=e,o=0,r=0,i=0,n=0){if(super(void 0,void 0,void 0,void 0,void 0,M("Octahedron(%d,%d,%d,%d,%d,%d)",e,t,o,r,i,n)),e<0)throw new Error("n1 must be greater than or equal to 0");if(t<0)throw new Error("n1 must be greater than or equal to 0");if(o<0)throw new Error("n2 must be greater than or equal to 0");if(r<0)throw new Error("n2 must be greater than or equal to 0");if(i<0)throw new Error("n3 must be greater than or equal to 0");if(n<0)throw new Error("n3 must be greater than or equal to 0");this.#W=e,this.#O=o,this.#Y=i;const s=new h(1,0,0),l=new h(0,0,-1),a=new h(-1,0,0),d=new h(0,0,1),c=new h(0,1,0),u=new h(0,-1,0);this.addVertex(s,l,a,d,c,u),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0)),this.addPrimitive(g.buildVertex(0,4),g.buildVertex(1,4),g.buildVertex(2,4),g.buildVertex(3,4)),this.addPrimitive(g.buildVertex(0,5),g.buildVertex(1,5),g.buildVertex(2,5),g.buildVertex(3,5)),this.#D(e,4,s,l,a,d),this.#D(t,5,s,l,a,d),this.#D(o,0,d,c,l,u),this.#D(i,1,s,c,a,u),this.#D(r,2,l,c,d,u),this.#D(n,3,a,c,s,u)}#D(e,t,o,r,i,n){for(let i=0;i<e;++i){const n=(i+1)/(e+1),s=(1-n)*o.x+n*r.x,l=(1-n)*o.y+n*r.y,a=(1-n)*o.z+n*r.z,d=new h(s,l,a),c=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,c))}for(let o=0;o<e;++o){const n=(o+1)/(e+1),s=(1-n)*r.x+n*i.x,l=(1-n)*r.y+n*i.y,a=(1-n)*r.z+n*i.z,d=new h(s,l,a),c=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,c))}for(let o=0;o<e;++o){const r=(o+1)/(e+1),s=(1-r)*i.x+r*n.x,l=(1-r)*i.y+r*n.y,a=(1-r)*i.z+r*n.z,d=new h(s,l,a),c=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,c))}for(let r=0;r<e;++r){const i=(r+1)/(e+1),s=(1-i)*n.x+i*o.x,l=(1-i)*n.y+i*o.y,a=(1-i)*n.z+i*o.z,d=new h(s,l,a),c=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,c))}}getHorizCount(){return this.#W}getVertCount(){return this.#O}remake(e,t){return new K(e,e,t,t,this.#Y,this.#Y)}}class J extends i{#W;#O;#j;constructor(e=1,t=1,o=1,r=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Tetrahedron(%d,%d,%d,%d)",e,t,o,r)),e<0)throw new Error("m0 must be greater than or equal to 0");if(t<0)throw new Error("m1 must be greater than or equal to 0");if(o<0)throw new Error("m2 must be greater than or equal to 0");if(r<0)throw new Error("m3 must be greater than or equal to 0");this.#W=e,this.#O=t,this.#j=!1;const i=new h(1,1,1),n=new h(-1,1,-1),s=new h(1,-1,-1),l=new h(-1,-1,1);this.addVertex(i,n,s,l),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(2,3),g.buildVertex(0,2),g.buildVertex(0,3),g.buildVertex(1,2),g.buildVertex(1,3)),this.#X(e,0,n,s,l),this.#X(t,1,i,s,l),this.#X(o,2,i,n,l),this.#X(r,3,i,n,s)}#X(e,t,o,r,i){this.#D(e,t,o,r),this.#D(e,t,r,i),this.#D(e,t,i,o)}#D(e,t,o,r){for(let i=0;i<e;++i){const n=(i+1)/(e+1),s=(1-n)*o.x+n*r.x,l=(1-n)*o.y+n*r.y,a=(1-n)*o.z+n*r.z,d=new h(s,l,a),c=this.vertexList.length;this.addVertex(d),this.addPrimitive(g.buildVertex(t,c))}}getHorizCount(){return this.#W}getVertCount(){return this.#O}remake(e,t){return new J(e,t,t,e)}}class Q extends i{#I;constructor(e=5){if(super(void 0,void 0,void 0,void 0,void 0,void 0,void 0,M("Sierpinski_Sponge(%d)",e)),e<0)throw new Error("N must be greater than 0");this.#I=e,0==e?(this.addVertex(new h(1,1,1),new h(-1,1,-1),new h(1,-1,-1),new h(-1,-1,1)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(2,3),g.buildVertex(0,2),g.buildVertex(0,3),g.buildVertex(1,2),g.buildVertex(1,3))):this.addNestedModel(this.#Z(e-1,1,1,1),this.#Z(e-1,-1,1,-1),this.#Z(e-1,1,-1,-1),this.#Z(e-1,-1,-1,1))}#Z(e,t,o,n){const s=i.buildNameMatrix("Sierpinski Sponge: level "+e+"("+t+", "+o+", "+n+",",r.translate(.5*t,.5*o,.5*n).timesMatrix(r.scale(.5)));return 0==e?(s.addVertex(new h(1,1,1),new h(-1,1,-1),new h(1,-1,-1),new h(-1,-1,1)),s.addPrimitive(g.buildVertex(0,1),g.buildVertex(2,3),g.buildVertex(0,2),g.buildVertex(0,3),g.buildVertex(1,2),g.buildVertex(1,3))):s.addNestedModel(this.#Z(e-1,1,1,1),this.#Z(e-1,-1,1,-1),this.#Z(e-1,1,-1,-1),this.#Z(e-1,-1,-1,1)),s}getHorzCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=t;return e!=this.#I&&(o=e),new Q(o)}}class $ extends i{#I;constructor(e=7){if(super(void 0,void 0,void 0,void 0,void 0,void 0,void 0,M("Sierpinski_Triangle(%d)",e)),e<0)throw new Error("N must be greater than 0");this.#I=e,0==e?(this.addVertex(new h(1,0,0),new h(-.5,.866,0),new h(-.5,-.866,0)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0))):this.addNestedModel(this.#U(e-1,.5,0),this.#U(e-1,-.25,.433),this.#U(e-1,-.25,-.433))}#U(e,t,o){const n=i.buildNameMatrix("Sierpinski Triangle: level "+e+"("+t+", "+o+")",r.translate(t,o,0).timesMatrix(r.scale(.5)));return 0==e?(n.addVertex(new h(1,0,0),new h(-.5,.866,0),new h(-.5,-.866,0)),n.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0))):n.addNestedModel(this.#U(e-1,.5,0),this.#U(e-1,-.25,.433),this.#U(e-1,-.25,-.433)),n}getHorzCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=t;return e!=this.#I&&(o=e),new $(o)}}class ee extends i{constructor(e=-1,t=1,o=-1,r=1,i=0){super(void 0,void 0,void 0,void 0,void 0,"PanelXY");const n=new Array(t-e+1);for(let e=0;e<n.length;e+=1)n[e]=new Array(r-o+1);let s=0;for(let l=e;l<=t;++l)for(let t=o;t<=r;++t)this.addVertex(new h(l,t,i)),n[l-e][t-o]=s,++s;for(let i=0;i<=t-e;++i)for(let e=0;e<r-o;++e)this.addPrimitive(g.buildVertex(n[i][e],n[i][e+1]));for(let i=0;i<=r-o;++i)for(let o=0;o<t-e;++o)this.addPrimitive(g.buildVertex(n[o][i],n[o+1][i]))}}class te extends i{constructor(e=-1,t=1,o=-1,r=1,i=0){super(void 0,void 0,void 0,void 0,void 0,"PanelXZ");const n=new Array(t-e+1);for(let e=0;e<n.length;e+=1)n[e]=new Array(r-o+1);let s=0;for(let l=e;l<=t;++l)for(let t=o;t<=r;++t)this.addVertex(new h(l,i,t)),n[l-e][t-o]=s,++s;for(let i=0;i<=t-e;++i)for(let e=0;e<r-o;++e)this.addPrimitive(g.buildVertex(n[i][e],n[i][e+1]));for(let i=0;i<=r-o;++i)for(let o=0;o<t-e;++o)this.addPrimitive(g.buildVertex(n[o][i],n[o+1][i]))}}class oe extends i{constructor(e=-1,t=1,o=-1,r=1,i=0){super(void 0,void 0,void 0,void 0,void 0,"PanelYZ");const n=new Array(t-e+1);for(let e=0;e<n.length;e+=1)n[e]=new Array(r-o+1);let s=0;for(let l=e;l<=t;++l)for(let t=o;t<=r;++t)this.addVertex(new h(i,l,t)),n[l-e][t-o]=s,++s;for(let i=0;i<=t-e;++i)for(let e=0;e<r-o;++e)this.addPrimitive(g.buildVertex(n[i][e],n[i][e+1]));for(let i=0;i<=r-o;++i)for(let o=0;o<t-e;++o)this.addPrimitive(g.buildVertex(n[o][i],n[o+1][i]))}}class re extends i{static x(e){return.5*Math.sin(e)+Math.sin(2*e)}static y(e){return.5*Math.cos(e)+Math.cos(2*e)}static z(e){return-.5*Math.sin(3*e)}#K;#J;#I;#Q;#$;#ee;constructor(e=re.x,t=re.y,o=re.z,r=0,i=2*Math.PI,n=60){if("number"!=typeof r||"number"!=typeof i||"number"!=typeof n)throw new Error("T1, T2, and N must be numerical");if("function"!=typeof e||"function"!=typeof t||"function"!=typeof o)throw new Error("Xfunc, yFunc, and zFunc must be functions and take 1 parameter");super(void 0,void 0,void 0,void 0,void 0,M("Parametric Curve(%d)",n)),this.#K=r,this.#J=i,this.#I=n,this.#Q=e,this.#$=t,this.#ee=o;const s=(i-r)/n;for(let i=0;i<=n;i+=1)this.addVertex(new h(e(r+i*s),t(r+i*s),o(r+i*s)));for(let e=0;e<n;e+=1)this.addPrimitive(g.buildVertex(e,e+1))}getHorizCount(){return this.#I}getVertCount(){return this.#I}remake(e,t){let o=t;return this.#I!=e&&(o=e),new re(this.#Q,this.#$,this.#ee,this.#K,this.#J,o)}}class ie extends i{static x(e,t){return Math.sin(Math.PI*e)*Math.sin(Math.PI*t)}static y(e,t){return Math.sin(Math.PI*e)*Math.sin(Math.PI*t)}static z(e,t){return Math.sin(Math.PI*e)*Math.sin(Math.PI*t)}#te;#oe;#K;#J;#I;#G;#Q;#$;#ee;constructor(e=ie.x,t=ie.y,o=ie.z,r=-1,i=1,n=-1,s=1,l=49,a=49){if("function"!=typeof e||"function"!=typeof t||"function"!=typeof o)throw new Error("xfunc, yfunc, zfunc are supposed to be functions");if("number"!=typeof r||"number"!=typeof i||"number"!=typeof n||"number"!=typeof s||"number"!=typeof l||"number"!=typeof a)throw new Error("S1, S2, T1, T2, N and K must be numerical");if(super(void 0,void 0,void 0,void 0,void 0,M("Parametric Surface(%d,%d)",l,a)),l<2)throw new Error("n must be greater than 1");if(a<2)throw new Error("k must be greater than 1");this.#Q=e,this.#$=t,this.#ee=o,this.#te=r,this.#oe=i,this.#K=n,this.#J=s,this.#I=l,this.#G=a;const d=(i-r)/(l-1),c=(s-n)/(a-1),u=new Array(l);for(let e=0;e<u.length;e+=1)u[e]=new Array(a);for(let i=0;i<l;++i)for(let s=0;s<a;++s)u[i][s]=new h(e(r+i*d,n+s*c),t(r+i*d,n+s*c),o(r+i*d,n+s*c));for(let e=0;e<l;++e)for(let t=0;t<a;++t)this.addVertex(u[e][t]);for(let e=0;e<l;++e)for(let t=0;t<a-1;++t)this.addPrimitive(g.buildVertex(e*a+t,e*a+(t+1)));for(let e=0;e<a;++e)for(let t=0;t<l-1;++t)this.addPrimitive(g.buildVertex(t*a+e,(t+1)*a+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new ie(this.#Q,this.#$,this.#ee,this.#te,this.#oe,this.#K,this.#J,e,t)}}class ne extends ie{static x(e,t){return.5*(1+Math.cos(Math.PI*e))*Math.cos(t)}static y(e,t){return.5*(1+Math.cos(Math.PI*e))*Math.sin(t)}static z(e,t){return.5*(1+Math.cos(Math.PI*e))}constructor(e=ne.x,t=ne.y,o=ne.z,r=-1,i=1,n=0,s=2*Math.PI,l=49,a=49){super(e,t,o,r,i,n,s,l,a),this.name=M("SurfaceOfRevolution(%d,%d)",l,a)}}class se extends i{#re;#T;#I;#G;constructor(e=2,t=1,o=15,r=4,i=!1){if(super(void 0,void 0,void 0,void 0,void 0,M("Pyramid(%.2f,%.2f,%d,%d)",e,t,o,r)),o<1)throw new Error("n must be greater than 0");if(r<1)throw new Error("k must be greater than 0");this.#re=e,this.#T=t,this.#I=o,this.#G=r,this.addVertex(new h(0,t,0));let n=1;const s=2*(e/=2)/r;for(let t=0;t<r+1;++t){const o=t*s;i?this.addVertex(new h(-e+o,0,-e),new h(-e+o,0,e)):this.addVertex(new h(-e+o,0,-e),new h(e-o,0,e)),this.addPrimitive(g.buildVertex(0,n+0),g.buildVertex(n+0,n+1),g.buildVertex(n+1,0)),n+=2}for(let t=1;t<r;++t){const o=t*s;i?this.addVertex(new h(e,0,-e+o),new h(-e,0,-e+o)):this.addVertex(new h(e,0,-e+o),new h(-e,0,e-o)),this.addPrimitive(g.buildVertex(0,n+0),g.buildVertex(n+0,n+1),g.buildVertex(n+1,0)),n+=2}const l=t/o,a=e/o;for(let r=0;r<o;++r)t=r*l,this.addVertex(new h(e,t,e),new h(e,t,-e),new h(-e,t,-e),new h(-e,t,e)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),e-=a,n+=4}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new se(this.#re,this.#T,e,t)}}class le extends i{#te;#oe;#T;#I;#G;constructor(e=2,t=1,o=.5,r=7,i=4){if(super(void 0,void 0,void 0,void 0,void 0,M("Pyramid Frustum(%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i)),r<0)throw new Error("n must be greater than or equal to 0");if(i<1)throw new Error("k must be greater than 0");this.#te=e,this.#oe=t,this.#T=o,this.#I=r,this.#G=i;let n=0;const s=2*(e/=2)/i,l=2*(t/=2)/i;for(let r=0;r<=i;++r){const i=r*s,a=r*l;this.addVertex(new h(-t+a,o,-t),new h(-e+i,0,-e),new h(-e+i,0,e),new h(-t+a,o,t)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),n+=4}for(let r=0;r<=i;++r){const i=r*s,a=r*l;this.addVertex(new h(t,o,-t+a),new h(e,0,-e+i),new h(-e,0,-e+i),new h(-t,o,-t+a)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),n+=4}const a=o/(r+1),d=(e-t)/(r+1);let c=e;for(let e=0;e<=r;++e)o=e*a,this.addVertex(new h(c,o,c),new h(c,o,-c),new h(-c,o,-c),new h(-c,o,c)),this.addPrimitive(g.buildVertex(n+0,n+1),g.buildVertex(n+1,n+2),g.buildVertex(n+2,n+3),g.buildVertex(n+3,n+0)),c-=d,n+=4}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new le(this.#te,this.#oe,this.#T,e,t)}}class ae extends i{#q;#R;#_;#k;#I;#G;constructor(e=1,t=.33,o=0,r=Math.PI,i=5,n=7){if(super(void 0,void 0,void 0,void 0,void 0,M("Ring Sector(%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i,n)),i<2)throw new Error("n must be greater than 1");if(n<4)throw new Error("k must be greater than 3");o%=2*Math.PI,r%=2*Math.PI,o<0&&(o=2*Math.PI+o),r<0&&(r=2*Math.PI+r),r<=o&&(r+=2*Math.PI),this.#q=e,this.#R=t,this.#_=o,this.#k=r,this.#I=i,this.#G=n;const s=(e-t)/(i-1),l=(r-o)/(n-1),a=new Array(i);for(let e=0;e<a.length;e+=1)a[e]=new Array(n);for(let e=0;e<n;++e){const r=Math.cos(o+e*l),n=Math.sin(o+e*l);for(let o=0;o<i;++o){const i=t+o*s;a[o][e]=new h(i*r,i*n,0)}}for(let e=0;e<i;++e)for(let t=0;t<n;++t)this.addVertex(a[e][t]);for(let e=0;e<i;++e)for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(e*n+t,e*n+(t+1)));for(let e=0;e<n;++e)for(let t=0;t<i-1;++t)this.addPrimitive(g.buildVertex(t*n+e,(t+1)*n+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new ae(this.#q,this.#R,this.#_,this.#k,e,t)}}class de extends ae{constructor(e=1,t=.33,o=4,r=12){super(e,t,0,2*Math.PI,o,r),this.name=M("Ring(%.2f,%.2f,%d,%d)",e,t,o,r)}}class he extends i{constructor(e=4,t=!1,o=!1){if(super(void 0,void 0,void 0,void 0,void 0,M("Sphere Subdivided(%d)",e)),e<0)throw new Error("n must be greater than or equal to 0");const r=1/Math.sqrt(3),i=new h(r,r,r),n=new h(-r,r,-r),s=new h(r,-r,-r),l=new h(-r,-r,r);this.#ie(e,i,n,s,o),this.#ie(e,n,l,s,o),this.#ie(e,s,l,i,o),t||this.#ie(e,l,n,i,o)}#ie(e,t,o,r,i){if(!(e>=0))throw new Error;if(0==e){const e=this.vertexList.length;this.addVertex(t,o,r),this.addPrimitive(g.buildVertex(e+0,e+1),g.buildVertex(e+1,e+2),g.buildVertex(e+2,e+0))}else{const n=new h(.5*(t.x+o.x),.5*(t.y+o.y),.5*(t.z+o.z)),s=new h(.5*(o.x+r.x),.5*(o.y+r.y),.5*(o.z+r.z)),l=new h(.5*(r.x+t.x),.5*(r.y+t.y),.5*(r.z+t.z)),a=Math.sqrt(n.x*n.x+n.y*n.y+n.z*n.z),d=Math.sqrt(s.x*s.x+s.y*s.y+s.z*s.z),c=Math.sqrt(l.x*l.x+l.y*l.y+l.z*l.z),u=new h(n.x/a,n.y/a,n.z/a),g=new h(s.x/d,s.y/d,s.z/d),f=new h(l.x/c,l.y/c,l.z/c);this.#ie(e-1,t,u,f,i),this.#ie(e-1,f,g,r,i),this.#ie(e-1,u,o,g,i),i||this.#ie(e-1,u,g,f,i)}}}class ce extends i{#N;#_;#k;#ne;#se;#I;#G;constructor(e=1,t=Math.PI/2,o=3*Math.PI/2,r=0,i=Math.PI,n=17,s=8){if(super(void 0,void 0,void 0,void 0,void 0,M("Sphere Sector(%.2f,%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i,n,s)),n<3)throw new Error("n must be greater than 2");if(s<4)throw new Error("k must be greater than 3");t%=2*Math.PI,o%=2*Math.PI,t<0&&(t=2*Math.PI+t),o<0&&(o=2*Math.PI+o),o<=t&&(o+=2*Math.PI),this.#N=e,this.#_=t,this.#k=o,this.#ne=r,this.#se=i,this.#I=n,this.#G=s;const l=(i-r)/(n-1),a=(o-t)/(s-1),d=new Array(n);for(let e=0;e<d.length;e+=1)d[e]=new Array(s);for(let o=0;o<s;++o){const i=Math.cos(t+o*a),s=Math.sin(t+o*a);for(let t=0;t<n;++t){const n=Math.cos(r+t*l),a=Math.sin(r+t*l);d[t][o]=new h(e*a*i,e*n,-e*a*s)}}for(let e=0;e<n;++e)for(let t=0;t<s;++t)this.addVertex(d[e][t]);for(let e=0;e<n;++e)for(let t=0;t<s-1;++t)this.addPrimitive(g.buildVertex(e*s+t,e*s+(t+1)));for(let e=0;e<s;++e)for(let t=0;t<n-1;++t)this.addPrimitive(g.buildVertex(t*s+e,(t+1)*s+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new ce(this.#N,this.#_,this.#k,this.#ne,this.#se,e,t)}}class ue extends ce{constructor(e=1,t=15,o=16){super(e,0,2*Math.PI,0,2*Math.PI,t,o),this.name=M("Sphere(%.2f,%d,%d)",e,t,o)}}class ge extends i{constructor(e=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Square(%.2f)",e)),e<=0)throw new Error("r must be greater than 0");this.addVertex(new h(-e,-e,0),new h(-e,e,0),new h(e,e,0),new h(e,-e,0)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0))}}class fe extends i{#N;#I;#G;constructor(e=1,t=1,o=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Square Grid(%.2f,%d,%d)",e,t,o)),t<0)throw new Error("n must be greater than or equal to 0");if(o<0)throw new Error("k must be greater than or equal to 0");if(e<=0)throw new Error("r must be greater than 0");this.#N=e,this.#I=t,this.#G=o;const r=2*e/(1+o),i=2*e/(1+t),n=new Array(t+2);for(let e=0;e<n.length;e+=1)n[e]=new Array(o+2);for(let s=0;s<=t+1;++s)for(let t=0;t<=o+1;++t)n[s][t]=new h(e-t*r,s*i-e,0);for(let e=0;e<t+2;++e)for(let t=0;t<o+2;++t)this.addVertex(n[e][t]);for(let e=0;e<t+2;++e)for(let t=0;t<o+1;++t)this.addPrimitive(g.buildVertex(e*(o+2)+t,e*(o+2)+(t+1)));for(let e=0;e<o+2;++e)for(let r=0;r<t+1;++r)this.addPrimitive(g.buildVertex(r*(o+2)+e,(r+1)*(o+2)+e))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new fe(this.#N,e,t)}}class me extends i{#q;#R;#_;#k;#ne;#se;#I;#G;constructor(e=.75,t=.25,o=Math.PI/2,r=3*Math.PI/2,i=Math.PI,n=2*Math.PI,s=6,l=8){if(super(void 0,void 0,void 0,void 0,void 0,M("Torus Sector(%.2f,%.2f,%.2f,%.2f,%.2f,%.2f,%d,%d)",e,t,o,r,i,n,s,l)),s<4)throw new Error("n must be greater than 3");if(l<4)throw new Error("k must be greater than 3");this.#q=e,this.#R=t,this.#_=o,this.#k=r,this.#ne=i,this.#se=n,this.#I=s,this.#G=l;const a=(n-i)/(s-1),d=(r-o)/(l-1),c=new Array(s);for(let e=0;e<c.length;e+=1)c[e]=new Array(l);for(let r=0;r<l;++r){const n=Math.cos(o+r*d),l=Math.sin(o+r*d);for(let o=0;o<s;++o){const s=Math.cos(i+o*a),d=Math.sin(i+o*a);c[o][r]=new h((e+t*d)*n,t*s,-(e+t*d)*l)}}for(let e=0;e<s;++e)for(let t=0;t<l;++t)this.addVertex(c[e][t]);for(let e=0;e<l;++e)for(let t=0;t<s-1;++t)this.addPrimitive(g.buildVertex(t*l+e,(t+1)*l+e));for(let e=0;e<s;++e)for(let t=0;t<l-1;++t)this.addPrimitive(g.buildVertex(e*l+t,e*l+(t+1)))}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new me(this.#q,this.#R,this.#_,this.#k,this.#ne,this.#se,e,t)}}class we extends me{constructor(e=.75,t=.25,o=12,r=16){super(e,t,0,2*Math.PI,0,2*Math.PI,o,r),this.name=M("Torus(%.2f,%.2f,%d,%d)",e,t,o,r)}}class xe extends i{constructor(e=.5,t=.6,o=e*Math.tan(Math.atan(Math.sqrt(2))),r=3,i=!0){if(super(void 0,void 0,void 0,void 0,void 0,M("Triangular Prism(%.2f,%.2f,%.2f,%d)",e,t,t,r)),r<0)throw new Error("n must be greater than or equal to 0");const n=Math.sqrt(3);let s,l,a,d,c,u,f,m;s=new h(e,t,0),l=new h(-e/2,t,.5*e*n),a=new h(-e/2,t,.5*-e*n),i?(d=new h(e,-t,0),c=new h(-e/2,-t,.5*e*n),u=new h(-e/2,-t,.5*-e*n)):(d=new h(e,0,0),c=new h(-e/2,0,.5*e*n),u=new h(-e/2,0,.5*-e*n)),f=new h(0,t+o,0),m=new h(0,i?-t-o:0,0),this.addVertex(s,l,a,d,c,u,f,m);let w=8;if(this.addPrimitive(g.buildVertex(6,0),g.buildVertex(6,1),g.buildVertex(6,2)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,0)),this.addPrimitive(g.buildVertex(0,3),g.buildVertex(1,4),g.buildVertex(2,5)),this.addPrimitive(g.buildVertex(3,4),g.buildVertex(4,5),g.buildVertex(5,3)),this.addPrimitive(g.buildVertex(7,3),g.buildVertex(7,4),g.buildVertex(7,5)),r>0){let o=2*t/(r+1);i||(o=t/(r+1));for(let s=0;s<r;++s){let r=(s+1)*o-t;i||(r=(s+1)*o),this.addVertex(new h(e,r,0),new h(-e/2,r,.5*e*n),new h(-e/2,r,.5*-e*n)),this.addPrimitive(g.buildVertex(w+0,w+1),g.buildVertex(w+1,w+2),g.buildVertex(w+2,w+0)),w+=3}}}}class be extends i{#N;#T;#I;#G;constructor(e=Math.sqrt(3)/Math.sqrt(2)/Math.sqrt(3),t=Math.sqrt(3)/Math.sqrt(2)*(Math.sqrt(2)/Math.sqrt(3)),o=1,r=1){if(super(void 0,void 0,void 0,void 0,void 0,M("Triangular_Pyramid(%.2f,%.2f,%d,%d)",e,t,o,r)),o<1)throw new Error("n must be greater than 0");if(r<1)throw new Error("k must be greater than 0");this.#N=e,this.#T=t,this.#I=o,this.#G=r;const i=new h(0,t,0),n=new h(0,0,0);this.addVertex(i,n);let s=2;const l=Math.sqrt(3),a=new h(e,0,0),d=new h(-e/2,0,.5*e*l),c=new h(-e/2,0,.5*-e*l);for(let e=0;e<r;++e){const t=e*(1/r);this.addVertex(new h((1-t)*a.x+t*d.x,(1-t)*a.y+t*d.y,(1-t)*a.z+t*d.z)),this.addVertex(new h((1-t)*d.x+t*c.x,(1-t)*d.y+t*c.y,(1-t)*d.z+t*c.z)),this.addVertex(new h((1-t)*c.x+t*a.x,(1-t)*c.y+t*a.y,(1-t)*c.z+t*a.z)),this.addPrimitive(g.buildVertex(0,s+0),g.buildVertex(s+0,1)),this.addPrimitive(g.buildVertex(0,s+1),g.buildVertex(s+1,1)),this.addPrimitive(g.buildVertex(0,s+2),g.buildVertex(s+2,1)),s+=3}for(let e=0;e<o;++e){const t=e*(1/o);this.addVertex(new h((1-t)*a.x+t*i.x,(1-t)*a.y+t*i.y,(1-t)*a.z+t*i.z)),this.addVertex(new h((1-t)*d.x+t*i.x,(1-t)*d.y+t*i.y,(1-t)*d.z+t*i.z)),this.addVertex(new h((1-t)*c.x+t*i.x,(1-t)*c.y+t*i.y,(1-t)*c.z+t*i.z)),this.addPrimitive(g.buildVertex(s+0,s+1),g.buildVertex(s+1,s+2),g.buildVertex(s+2,s+0)),s+=3}}getHorizCount(){return this.#I}getVertCount(){return this.#G}remake(e,t){return new be(this.#N,this.#T,e,t)}}class ve extends i{constructor(e=-.25,t=.25,o=-.25,r=.25,i=.25,n=1){super(void 0,void 0,void 0,void 0,void 0,"View Frustum Model"),this.addVertex(new h(e,r,-i),new h(t,r,-i),new h(t,o,-i),new h(e,o,-i),new h(e/i*n,r/i*n,-n),new h(t/i*n,r/i*n,-n),new h(t/i*n,o/i*n,-n),new h(e/i*n,o/i*n,-n)),this.addPrimitive(g.buildVertex(0,1),g.buildVertex(1,2),g.buildVertex(2,3),g.buildVertex(3,0)),this.addPrimitive(g.buildVertex(4,5),g.buildVertex(5,6),g.buildVertex(6,7),g.buildVertex(7,4)),this.addPrimitive(g.buildVertex(0,4),g.buildVertex(1,5),g.buildVertex(2,6),g.buildVertex(3,7))}static BuildViewFrustumModel(e,t,o,r){return new ve(-o*Math.tan(Math.PI/180*e/2)*t,o*Math.tan(Math.PI/180*e/2)*t,-o*Math.tan(Math.PI/180*e/2),o*Math.tan(Math.PI/180*e/2),o,r)}}async function pe(e){if("string"!=typeof e)throw new Error("Filename must be a string and include the path");const t=new i(void 0,void 0,void 0,void 0,void 0,"GRS Model: "+e.substring(e.lastIndexOf("/")+1,e.length));let o,r=new XMLHttpRequest;if(r.onreadystatechange=function(){4==this.readyState&&200==this.status&&(o=r.responseText)},r.open("GET",e,!1),r.send(),null==o)throw new Error("Unable to access file");{let e=o.split("\n"),r=0;for(;!e[r].startsWith("*");)r++;r++;let i=e[r].split(/ +/);parseFloat(i[0]),parseFloat(i[1]),parseFloat(i[2]),parseFloat(i[3]),r++;const n=parseInt(e[r]);r++;let s=-1;for(let o=0;o<n;o++){let o=parseInt(e[r]);r++;let i=e[r].split(/ +/),n=parseFloat(i[1]),l=parseFloat(i[2]);t.addVertex(new h(n,l,0)),s++,r++;for(let a=1;a<o;a++)i=e[r].split(/ +/),n=parseFloat(i[1]),l=parseFloat(i[2]),t.addVertex(new h(n,l,0)),s++,t.addPrimitive(g.buildVertex(s-1,s)),r++}}return t}async function Ve(e){if("string"!=typeof e)throw new Error("Filename must be a string including the path");const t=new i(void 0,void 0,void 0,void 0,void 0,"OBJ Model: "+e.substring(e.lastIndexOf("/")+1,e.length));let o,r=new XMLHttpRequest;if(r.onreadystatechange=function(){4==this.readyState&&200==this.status&&(o=r.responseText)},r.open("GET",e,!1),r.send(),null==o)throw new Error("Unable to read the file");{let e=o.split("\n");for(let o of e)if(!(o.startsWith("#")||o.startsWith("vt")||o.startsWith("vn")||o.startsWith("s")||o.startsWith("g")||o.startsWith("o")||o.startsWith("usemtl")||o.startsWith("mtllib")))if(o.startsWith("v")){let e=o.split(/ +/g);t.addVertex(new h(parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])))}else if(o.startsWith("f")){let e=o.split(/ +/);e.shift();let r=[];for(let t=0;t<3;t++){let o=e.shift().split("/");r[t]=parseInt(o[0])-1}for(t.addPrimitive(g.buildVertex(r[0],r[1]),g.buildVertex(r[1],r[2]));0!=e.length;){r[1]=r[2];let o=e.shift().split("/");r[2]=parseInt(o[0])-1,t.addPrimitive(g.buildVertex(r[1],r[2]))}t.addPrimitive(g.buildVertex(r[2],r[0]))}}return t}function ye(e,t){const o=t.vIndexList[0],r=t.vIndexList[1],i=e.vertexList[o],n=e.vertexList[r],s=i.x,l=i.y,a=n.x,d=n.y;return Math.abs(s)>1||Math.abs(l)>1||Math.abs(a)>1||Math.abs(d)>1?s>1&&a>1||s<-1&&a<-1||l>1&&d>1||l<-1&&d<-1?void(Pe&&We("-- Trivial delete.")):ye(e,function(e,t){const o=t.vIndexList[0],r=t.vIndexList[1],i=e.vertexList[o],n=e.vertexList[r],s=i.x,l=i.y,a=n.x,d=n.y;let c,u,f,m,w,x,b,v,p,V="";s>1?(V="x = +1",c=0,u=s,f=l,m=a,w=d,x=(1-u)/(m-u),b=1,v=(1-x)*f+x*w):a>1?(V="x = +1",c=1,u=a,f=d,m=s,w=l,x=(1-u)/(m-u),b=1,v=(1-x)*f+x*w):s<-1?(V="x = -1",c=0,u=s,f=l,m=a,w=d,x=(-1-u)/(m-u),b=-1,v=(1-x)*f+x*w):a<-1?(V="x = -1",c=1,m=s,w=l,u=a,f=d,x=(-1-u)/(m-u),b=-1,v=(1-x)*f+x*w):l>1?(V="y = +1",c=0,u=s,f=l,m=a,w=d,x=(1-f)/(w-f),b=(1-x)*u+x*m,v=1):d>1?(V="y = +1",c=1,m=s,w=l,u=a,f=d,x=(1-f)/(w-f),b=(1-x)*u+x*m,v=1):l<-1?(V="y = -1",c=0,u=s,f=l,m=a,w=d,x=(-1-f)/(w-f),b=(1-x)*u+x*m,v=-1):(V="y = -1",c=1,m=s,w=l,u=a,f=d,x=(-1-f)/(w-f),b=(1-x)*u+x*m,v=-1);let y=new h(b,v,0);p=e.vertexList.length,e.addVertex(y);let P,C=t.cIndexList[1-c],L=t.cIndexList[c],E=e.colorList[C].getRGBComponents(),S=e.colorList[L].getRGBComponents();P=x>1?1/x:x;let A,B=(1-P)*S[0]+P*E[0],F=(1-P)*S[1]+P*E[1],I=(1-P)*S[2]+P*E[2],N=new z(B,F,I),_=e.colorList.length;if(e.addColor(N),Pe){let e="";e=0==c?"v0":"v1",We(M("-- Clip off %s at %s",e,V)),We(M("-- t = %.25f",x)),We(M("-- <x_i, y_i> = <%.24f, %.24f>",m,w)),We(M("-- <x_o, y_o> = <%.24f, %.24f>",u,f)),We(M("-- <x_c, y_c> = <%.24f, %.24f>",b,v)),We(M("-- <r_i, g_i, b_i> = <%.15f,  %.15f,  %.15f>",E[0],E[1],E[2])),We(M("-- <r_o, g_o, b_o> = <%.15f,  %.15f,  %.15f>",S[0],S[1],S[2])),We(M("-- <r_c, g_c, b_c> = <%.15f,  %.15f,  %.15f>",B,F,I))}return A=1==c?g.buildVertexColors(o,p,C,_):g.buildVertexColors(p,r,_,C),A}(e,t)):(Pe&&We("-- Trivial accept."),t)}function Me(e,t){let o;const r=t.vIndexList[0],i=e.vertexList[r],n=i.x,s=i.y;return Math.abs(n)>1||Math.abs(s)>1||(o=t),o}var Pe=!1;function Ce(e){const t=Array.from(e.colorList),o=new i(e.vertexList,e.primitiveList,t,e.matrix,e.nestedModels,e.name,e.visible),r=new Array;for(const e of o.primitiveList){let t;je("5. Clipping",o,e),t=e instanceof g?ye(o,e):Me(o,e),null!=t?(r.push(t),je("5. Clipped (accept)",o,t)):je("5. Clipped (reject)",o,e)}return new i(o.vertexList,r,o.colorList,o.matrix,o.nestedModels,o.name,o.visible)}function Le(e){We("==== 6. Render position: "+e.name+" ====");const t=l.buildFromModelName(e.model,e.name);e.model.visible?t.model=Ee(e.model):We("====== 6. Hidden model: "+e.model.name+" ======");for(const o of e.nestedPositions)t.addNestedPosition(Le(o));return We("==== 6. End position: "+e.name+" ===="),t}function Ee(e){We("==== 6. Clip Model: "+e.name+" ====");const t=Ce(e);Oe("6. clipped  ",t),Ye("6. Clipped  ",t),De("6. Clipped  ",t);const o=new Array;for(const t of e.nestedModels)o.push(Ee(t));return We("==== 6. End Model: "+t.name+" ===="),new i(t.vertexList,t.primitiveList,t.colorList,t.matrix,o,t.name,t.visible)}function Se(e){Pe=e}function ze(e,t){const o=e.model,r=o.vertexList.map((e=>t.timesVertex(e)));return new i(r,o.primitiveList,o.colorList,o.matrix,o.nestedModels,e.name+"::"+o.name,o.visible)}function Ae(){}let Be,Fe,Ie,Ne,_e,ke,qe=z.white;function Re(e,t){if(t instanceof E==0)throw new Error("FB must be a framebuffer");Te(e,t.vp)}function Te(e,t){Je(e.debug),We("\n= Begin Rendering of Scene (Pipeline 2): "+e.name+" ="),We("- Current Camera:\n"+e.camera),Be=a.buildFromCameraName(e.camera,e.name),We("== 1. Begin model-to-world transformation of Scene ====");for(const t of e.positionList)Qe(t.debug),t.visible?Be.addPosition(et(t,r.identity())):We("==== 1. Hidden Position: "+t.name+" ====");We("== 1. End model-to-world transformation of Scene ===="),Fe=a.buildFromCameraName(e.camera,e.name),We("== 2. Begin world-to-view transformation of Scene ====");for(const t of Be.positionList)Fe.addPosition(rt(t,e.camera));We("== 2. End world-to-view transformation of Scene ===="),Ie=a.buildFromCameraName(e.camera,e.name),We("== 3. Begin view-to-camera transformation of Scene ====");for(const t of Fe.positionList)Ie.addPosition(_t(t,e.camera));We("== 3. End view-to-camera transformation of SCene ===="),Ne=a.buildFromCameraName(e.camera,e.name),We("== 4. Begin newar-plane clipping of Scene ====");for(const t of Ie.positionList)Ne.addPosition(ht(t,e.camera));We("== 4. End near plane clipping of Scene ===="),_e=a.buildFromCameraName(e.camera,e.name),We("== 5. Begin projection transformation of Scene ====");for(const t of Ne.positionList)_e.addPosition(pt(t,e.camera));We("== 5. End projection transformation of Scene ===="),ke=a.buildFromCameraName(e.camera,e.name),We("== 6. Begin primitive clipping of Scene ====");for(const e of _e.positionList)ke.addPosition(Le(e));We("== 6. End primitive clipping of Scene ===="),We("== 7. Begin primitive rasterization of Scene ====");for(const e of ke.positionList)zt(e,t);We("== 7. End primitive rasterization of Scene ===="),We("= End Rendering of Scene (Pipeline 2) =")}let Ge=!1,He=!1;function We(e){(Ge||He)&&console.log(e)}function Oe(e,t){if(Ge||He){let o=0;for(const r of t.vertexList)console.log(e+": vIndex = "+o+", "+r.toString()+"\n"),o+=1}}function Ye(e,t){if(Ge||He){let o=0;for(const r of t.colorList)console.log(e+": cIndex = "+o+", "+r.toString()+"\n"),o+=1}}function De(e,t){if(Ge||He)if(0==t.primitiveList.length)console.log(e+": []\n");else for(const o of t.primitiveList)console.log(e+": "+o.toString()+"\n")}function je(e,t,o){if(Ge||He){console.log(e+": "+o.toString()+"/n");for(const e of o.vIndexList){const o=t.vertexList[e];console.log("   vIndex = "+e+", "+o.toString()+"\n")}for(const e of o.cIndexList){const o=t.colorList[e];console.log("   cIndex = "+e+", "+o.toString()+"\n")}}}function Xe(e,t,o,r,i,n,s,l,a){if(Ge||He){let d=a.width,h=a.height,c=a.vp_ul_x,u=a.vp_ul_y,g=a.getFrameBuffer(),f=g.width,m=g.height;console.log(M("fb_[w=%d,h=%d] vp_[x=%4d, y=%4d, w=%d,h=%d]  (x_pp=%9.4f, y_pp=%9.4f)  (x_vp=%4d, y_vp=%4d)  r=%.4f g=%.4f b=%.4f",f,m,c,u,d,h,t,o,r,i,n,s,l)),console.log(e)}}function Ze(e,t,o,r,i,n,s,l){Xe("",e,t,o,r,i,n,s,l)}function Ue(e,t,o,r,i,n,s,l,a,d,h,c){if(Ge||He){const u=c.width,g=c.height,f=c.vp_ul_x,m=c.vp_ul_y,w=c.getFrameBuffer(),x=w.width,b=w.height;console.log(M("fb_[w=%d,h=%d] vp_[x=%4d, y=%4d, w=%d,h=%d]  (x_pp=%4d, y_pp=%9.4f)  x_vp=%4d {y_low=%4d r=%.4f g=%.4f b=%.4f} {y_hi =%4d r=%.4f g=%.4f b=%.4f}\n",x,b,f,m,u,g,e,t,o,r,n,s,l,i,a,d,h))}}function Ke(e,t,o,r,i,n,s,l,a,d,h,c){if(Ge||He){const u=c.width,g=c.height,f=c.vp_ul_x,m=c.vp_ul_y,w=c.getFrameBuffer(),x=w.width,b=w.height;console.log(M("fb_[w=%d,h=%d] vp_[x=%4d, y=%4d, w=%d,h=%d]  (x_pp=%9.4f, y_pp=%4d)  y_vp=%4d {x_low=%4d r=%.4f g=%.4f b=%.4f} {x_hi =%4d r=%.4f g=%.4f b=%.4f}\n",x,b,f,m,u,g,e,t,i,o,n,s,l,r,a,d,h))}}function Je(e){Ge=e}function Qe(e){He=e}function $e(e,t){const o=new Array;for(const r of e.vertexList)o.push(t.timesVertex(r));return new i(o,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function et(e,t){We("==== 1. Render position: "+e.name+" ===="),We("---- Transformation matrix: \n"+e.matrix.toString());const o=t.timesMatrix(e.matrix);let r=l.buildFromModelName(e.model,e.name);e.model.visible?r.model=tt(e.model,o):(We("====== 1. Hidden model: "+e.model.name+" ======"),r=l.buildFromModelName(e.model,e.name));for(const t of e.nestedPositions)if(t.visible){const e=et(t,o);r.addNestedPosition(e)}else We("==== 1. Hidden position: "+t.name+" ====");return We("==== 1. End position: "+e.name+" ===="),r}function tt(e,t){if(We("====== 1. Modeltoworld transformation of: "+e.name+" ======"),f(e),0==e.colorList.length&&0!=e.vertexList.length){for(let t=0;t<e.vertexList.length;++t)e.addColor(qe);console.log("***WARNING: Added default color to model: "+e.name+".")}Oe("0. Model    ",e);const o=t.timesMatrix(e.matrix),n=$e(e,o);Oe("1. World    ",n);const s=new Array;for(const t of e.nestedModels)t.visible?s.push(tt(t,o)):We("====== 1. Hidden model: "+t.name+" ======");return We("====== 1. End Model: "+n.name+" ======"),new i(n.vertexList,n.primitiveList,n.colorList,r.identity(),s,n.name,n.visible)}function ot(e,t){const o=t.getViewMatrix(),r=new Array;for(const t of e.vertexList)r.push(o.timesVertex(t));return new i(r,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function rt(e,t){We("==== 2. Render position: "+e.name+" ====");const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=it(e.model,t):We("====== 2. Hidden model: "+e.model.name+" ======");for(const r of e.nestedPositions)o.addNestedPosition(rt(r,t));return We("==== 2. End position: "+e.name+" ===="),o}function it(e,t){We("==== 2. World-to-View transformation of: "+e.name+" ====");const o=ot(e,t);Oe("2. View    ",o);const r=new Array;for(const o of e.nestedModels)r.push(it(o,t));return We("==== 2. End Model: "+o.name+" ===="),new i(o.vertexList,o.primitiveList,o.colorList,o.matrix,r,o.name,o.visible)}function nt(e,t,o){const r=o.n,i=t.vIndexList[0],n=t.vIndexList[1],s=e.vertexList[i],l=e.vertexList[n],a=s.z,d=l.z;return a<=r&&d<=r?(at&&We("-- Near_Clip: Trivial accept."),t):a>r&&d>r?void(at&&We("-- Near_Clip: Trivial delete")):function(e,t,o){const r=t.vIndexList[0],i=e.vertexList[r],n=i.x,s=i.y,l=i.z,a=t.cIndexList[0],d=e.colorList[a].getRGBComponents(),c=t.vIndexList[1],u=e.vertexList[c],f=u.x,m=u.y,w=u.z,x=t.cIndexList[1],b=e.colorList[x].getRGBComponents(),v=(o-w)/(l-w),p=(1-v)*f+v*n,V=(1-v)*m+v*s,y=o;let P;P=v>1?1/v:v;const C=(1-P)*b[0]+P*d[0],L=(1-P)*b[1]+P*d[1],E=(1-P)*b[2]+P*d[2],S=new h(p,V,y),A=e.vertexList.length;e.vertexList.push(S);const B=new z(C,L,E),F=e.colorList.length;let I,N;return e.colorList.push(B),I=l>o?0:1,at&&(We(M("-- Clip off %s at z=%.3f",0==I?"v0":"v1",o)),We(M("-- t = %.25f",v)),We(M("-- <x0, y0, z0> = <%.8f, %.8f, %.8f",n,s,l)),We(M("-- <x1, y1, z1> = <%.8f, %.8f, %.8f",f,m,w)),We(M("-- <x,  y,  z>  = <%.8f, %.8f, %.8f",p,V,y)),We(M("-- <r0, g0, b0> = <%.8f, %.8f, %.8f>",d[0],d[1],d[2])),We(M("-- <r1, g1, b1> = <%.8f, %.8f, %.8f>",b[0],b[1],b[2])),We(M("-- <r,  g,  b>  = <%.8f, %.8f, %.8f>",C,L,E))),N=0==I?g.buildVertexColors(A,c,F,x):g.buildVertexColors(r,A,a,F),N}(e,t,r)}function st(e,t,o){let r;const i=t.vIndexList[0];return e.vertexList[i].z<=o.n&&(r=t),r}var lt=!0,at=!1;function dt(e,t){if(!lt)return e;const o=Array.from(e.colorList),r=new i(e.vertexList,e.primitiveList,o,e.matrix,e.nestedModels,e.name,e.visible),n=new Array;for(const e of r.primitiveList){let o;je("3. Near_Clipping",r,e),o=e instanceof g?nt(r,e,t):st(r,e,t),null!=o?(n.push(o),je("3. Near_Clipped (accept)",r,o)):je("3. Near_Clipped (reject)",r,e)}return new i(r.vertexList,n,r.colorList,r.matrix,r.nestedModels,r.name,r.visible)}function ht(e,t){We("==== 4. Render position: "+e.name+" ====");const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=ct(e.model,t):We("====== 4. Hidden Model: "+e.model.name+" ======");for(const r of e.nestedPositions)o.addNestedPosition(ht(r,t));return We("==== 4. End position: "+e.name+" ===="),o}function ct(e,t){We("==== 4. Near Clip model: "+e.name+" ====");const o=dt(e,t);Oe("4. Near Clipped  ",o),Ye("4. Near Clipped  ",o),De("4. Near Clipped  ",o);const r=new Array;for(const o of e.nestedModels)r.push(ct(o,t));return We("==== 4. End Model: "+o.name+" ===="),new i(o.vertexList,o.primitiveList,o.colorList,o.matrix,r,o.name,o.visible)}function ut(e){lt=e}function gt(e){at=e}var ft=z.white;function mt(e,t){if(t instanceof E==0)throw new Error("FB must be a framebuffer");wt(e,t.vp)}function wt(e,t){if(e instanceof a==0)throw new Error("Scene must be a scene data type");if(t instanceof S==0)throw new Error("VP must be a Viewport data type");Je(e.debug),We("/n== Begin Renderering of Scene (Pipeline1): "+e.name+" ==");for(const o of e.positionList)Qe(o.debug),o.visible?xt(e,o,r.identity(),t):We("==== Hidden Position: "+o.name);We("== End Rendering of Scene (Pipeline 1) == ")}function xt(e,t,o,r){null!=t.getModel()&&null!=t.getModel()?We("==== Render Position: "+t.getName()+" ===="):We("==== Render Position (no model) ===="),We("---- Transformation matrix:\n"+t.getMatrix());const i=o.timesMatrix(t.getMatrix());null!=t.getModel()&&null!=t.getModel()&&t.getModel().visible?bt(e,t.getModel(),i,r):null!=t.getModel()&&null!=t.getModel()?We("===== Hidden model: "+t.getModel().getName()+"======"):We("====== Missing model ======");for(const o of t.nestedPositions)o.visible?xt(e,o,i,r):We("====== Hidden Position"+t.getName()+" =====");We("==== End position: "+t.name+" ====")}function bt(e,t,o,r){if(We("====== Render Model: "+t.name+" ======"),f(t),0==t.colorList.length&&0!=t.vertexList.length){for(let e=0;e<t.vertexList.length;++e)t.addColor(ft);console.log("***WARNING: Added default color to model: "+t.name+".")}Oe("0. Model        ",t);const i=o.timesMatrix(t.matrix),n=$e(t,i);Oe("1. World        ",n);const s=ot(n,e.camera);Oe("2. View         ",s);const l=Nt(s,e.camera);Oe("3. Camera       ",l),Ye("3. Camera       ",l),De("3. Camera       ",l);const a=dt(l,e.camera);Oe("4. Near_Clipped",a),Ye("4. Near_Clipped",a),De("4. Near_Clipped",a);const d=vt(a,e.camera);Oe("5. Projected   ",d);const h=Ce(d);Oe("6. Clipped     ",h),Ye("6. Clipped     ",h),De("6. Clipped     ",h),St(h,r);for(const o of t.nestedModels)o.visible?bt(e,o,i,r):We("====== Hidden model: "+o.name+" ======");We("====== End Model: "+t.name+" ======")}function vt(e,t){const o=new Array;for(let r=0;r<e.vertexList.length;r+=1){const i=e.vertexList[r];t.perspective?o[r]=new h(i.x/-i.z,i.y/-i.z,-1):o[r]=new h(i.x,i.y,0)}return new i(o,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function pt(e,t){We("==== 5. Render position: "+e.name+" ====");const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=Vt(e.model,t):We("====== 5. Hidden model: "+e.model.name+" ======");for(const r of e.nestedPositions)o.addNestedPosition(pt(r,t));return We("==== 5. End position: "+e.name+" ===="),o}function Vt(e,t){We("==== 5. Project model: "+e.name+" ====");const o=vt(e,t);Oe("5. Projected",o);const r=new Array;for(const o of e.nestedModels)r.push(Vt(o,t));return We("==== 5. End Model: "+o.name+" ===="),new i(o.vertexList,o.primitiveList,o.colorList,o.matrix,r,o.name,o.visible)}function yt(e,t,o){const r=o.bgColorVP,i=o.width,n=o.height,s=t.vIndexList[0],l=t.vIndexList[1],a=e.vertexList[s],d=e.vertexList[l],h=t.cIndexList[0],c=t.cIndexList[1],u=e.colorList[h].getRGBComponents(),g=e.colorList[c].getRGBComponents();let f=u[0]/255,m=u[1]/255,w=u[2]/255,x=g[0]/255,b=g[1]/255,v=g[2]/255,p=.5+i/2.001*(a.x+1),V=.5+i/2.001*(d.x+1),y=.5+n/2.001*(a.y+1),P=.5+n/2.001*(d.y+1);if(Pt&&(We(M("(x0_pp, y0_pp) = (%9.4f, %9.4f)",p,y)),We(M("(x1_pp, y1_pp) = (%9.4f, %9.4f)",V,P))),p=Math.round(p),V=Math.round(V),y=Math.round(y),P=Math.round(P),p==V&&y==P){const e=Math.trunc(Math.trunc(p)-1),t=Math.trunc(n-Math.trunc(y));return Pt&&Ze(p,y,e,t,f,m,w,o),void o.setPixelVP(e,t,new z(255*f,255*m,255*w,255))}let C=!1;if(Math.abs(P-y)>Math.abs(V-p)){let e=p;p=y,y=e;let t=V;V=P,P=t,C=!0}if(V<p){let e=p;p=V,V=e;let t=y;y=P,P=t;let o=f,r=m,i=w;f=x,m=b,w=v,x=o,b=r,v=i}const L=V-p,E=(P-y)/L,S=(x-f)/L,A=(b-m)/L,B=(v-w)/L;Pt&&(We("Slope m    = "+E+(C?" (transposed, so 1/m = "+1/E+")":"")),We("Slope mRed = "+S),We("Slope mGrn = "+A),We("Slope mBlu = "+B),We(M("(x0_vp, y0_vp) = (%9.4f, %9.4f)",p-1,n-y)),We(M("(x1_vp, y1_vp) = (%9.4f, %9.4f)",V-1,n-P)));let F=y;for(let e=Math.trunc(p);e<Math.trunc(V);e+=1,F+=E){let t=Math.abs(f+S*(e-p)),s=Math.abs(m+A*(e-p)),l=Math.abs(w+B*(e-p));if(Ct){let a=Math.trunc(F),d=Math.trunc(a+1);C||F!=n||(d=n),C&&F==i&&(d=i);const h=F-a;let c=(1-h)*t+h*r.getRed(),u=(1-h)*s+h*r.getGreen(),g=(1-h)*l+h*r.getBlue(),f=h*t+(1-h)*r.getRed(),m=h*s+(1-h)*r.getGreen(),w=h*l+(1-h)*r.getBlue();if(Lt&&(c=Math.pow(c,z.GAMMA),u=Math.pow(u,z.GAMMA),g=Math.pow(g,z.GAMMA),f=Math.pow(f,z.GAMMA),m=Math.pow(m,z.GAMMA),w=Math.pow(w,z.GAMMA)),C){const t=Math.trunc(a-1),r=Math.trunc(d-1),i=Math.trunc(n-e);Pt&&Ke(F,e,t,r,i,c,u,g,f,m,w,o),o.setPixelVP(t,i,new z(255*c,255*u,255*g)),o.setPixelVP(r,i,new z(255*f,255*m,255*w))}else{const t=Math.trunc(e-1),r=Math.trunc(n-a),i=Math.trunc(n-d);Pt&&Ue(e,F,t,r,i,c,u,g,f,m,w,o),o.setPixelVP(t,r,new z(255*c,255*u,255*g)),o.setPixelVP(t,i,new z(255*f,255*m,255*w))}}else if(Lt&&(t=Math.pow(t,z.GAMMA),s=Math.pow(s,z.GAMMA),l=Math.pow(l,z.GAMMA)),C){const r=Math.trunc(Math.trunc(Math.round(F))-1),i=Math.trunc(n-e);Pt&&Ze(F,e,r,i,t,s,l,o),o.setPixelVP(r,i,new z(255*t,255*s,255*l))}else{const r=Math.trunc(e-1),i=Math.trunc(n-Math.trunc(Math.round(F)));Pt&&Ze(e,F,r,i,t,s,l,o),o.setPixelVP(r,i,new z(255*t,255*s,255*l))}}if(C){const e=Math.trunc(Math.trunc(P)-1),t=Math.trunc(n-Math.trunc(V));Pt&&Ze(P,V,e,t,x,b,v,o),o.setPixelVP(e,t,new z(255*x,255*b,255*v))}else{const e=Math.trunc(Math.trunc(V)-1),t=Math.trunc(n-Math.trunc(P));Pt&&Ze(V,P,e,t,x,b,v,o),o.setPixelVP(e,t,new z(255*x,255*b,255*v))}}function Mt(e,t,o){const r=o.width,i=o.height,n=t.vIndexList[0],s=e.vertexList[n],l=t.cIndexList[0],a=e.colorList[l].rgb;let d=a[0],h=a[1],c=a[2];if(Lt){let t=z.applyGamma(e.colorList[l]).getRGBComponents();d=t[0],h=t[1],c=t[2]}let u=.5+r/2.001*(s.x+1),g=.5+i/2.001*(s.y+1);Pt&&We(M("(x_pp, y_pp) = (%9.4f, %9.4f)",u,g)),u=Math.round(u),g=Math.round(g);const f=t.radius;for(let e=Math.trunc(g)-f;e<=Math.trunc(g)+f;++e)for(let t=Math.trunc(u)-f;t<=Math.trunc(u)+f;++t){if(Pt){let n;n=t>0&&t<=r&&e>0&&e<=i?"":" : Clipped",Xe(n,u,g,t-1,i-e,d,h,c,o)}t>0&&t<=r&&e>0&&e<=i&&o.setPixelVP(t-1,i-e,new z(d,h,c))}}var Pt=!1,Ct=!1,Lt=!0,Et=2.2;function St(e,t){for(const o of e.primitiveList)je("6. Rasterize",e,o),o instanceof g?yt(e,o,t):o instanceof u?Mt(e,o,t):console.log("Incorrect Primitive: "+o)}function zt(e,t){We("==== 7. Render Position: "+e.name+" ===="),e.model.visible?At(e.model,t):We("====== 7. Hidden model: "+e.model.name+" ======");for(const o of e.nestedPositions)zt(o,t);We("==== 7. End position: "+e.name+" ====")}function At(e,t){We("==== 7. Rasterize model: "+e.name+" ===="),St(e,t);for(const o of e.nestedModels)At(o,t);We("==== 7. End Model: "+e.name+" ====")}function Bt(e){Pt=e}function Ft(e){Ct=e}function It(e){Lt=e}function Nt(e,t){const o=t.getNormalizeMatrix(),r=new Array;for(const t of e.vertexList)r.push(o.timesVertex(t));return new i(r,e.primitiveList,e.colorList,e.matrix,e.nestedModels,e.name,e.visible)}function _t(e,t){We("==== 3. Render Position: "+e.name);const o=l.buildFromModelName(e.model,e.name);e.model.visible?o.model=kt(e.model,t):We("====== 3. Hidden model: "+e.model.name+" ======");for(const r of e.nestedPositions)o.addNestedPosition(_t(r,t));return We("==== 3. End position: "+e.name+" ===="),o}function kt(e,t){We("==== 3. View-to-Camera transformation of: "+e.name+" ====");const o=Nt(e,t);Oe("3. Camera    ",o),Ye("3. Camera    ",o),De("3. Camera    ",o);const r=new Array;for(const o of e.nestedModels)r.push(kt(o,t));return We("==== 3. End Model: "+o.name+" ===="),new i(o.vertexList,o.primitiveList,o.colorList,o.matrix,r,o.name,o.visible)}return t})()));